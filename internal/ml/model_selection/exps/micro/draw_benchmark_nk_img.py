from typing import List

import numpy as np
from matplotlib.ticker import FuncFormatter
from src.common.constant import Config
from src.tools.compute import sample_in_log_scale
import matplotlib.pyplot as plt

plt.rcParams['pdf.fonttype'] = 42
plt.rcParams['ps.fonttype'] = 42

import matplotlib

set_line_width = 5
set_tick_size = 25
# update tick size
matplotlib.rc('xtick', labelsize=set_tick_size)
matplotlib.rc('ytick', labelsize=set_tick_size)
plt.rcParams['axes.labelsize'] = set_tick_size
mark_list = ["o", "*", "<", "^", "s", "d", "D", ">", "h"]
line_shape_list = ['-.', '--', '-', ':']

shade_degree = 0.2

# used_dataset = Config.c10
used_dataset = Config.imgNet
used_space = Config.NB201
Fig_y_name = None

if used_dataset == Config.c10:
    y_lim = [92.75, 94.3]
    Fig_y_name = "C10"
    # this is the C10 + NB201
    budget_array = [1, 5, 10, 15, 20, 30, 50, 100, 500, 1000]
    k_div_n = [[152.0, 25.25], [761.0, 325.75, 206.33333333333334, 139.75, 101.7, 25.5, 14.428571428571429],
               [1480.5, 724.0, 471.0, 325.5, 252.9, 153.41666666666666, 122.28571428571429, 89.1875, 67.0, 56.1,
                46.31818181818182, 26.166666666666668, 19.615384615384617, 14.5],
               [2308.0, 1087.5, 698.0, 509.875, 403.2, 277.0833333333333, 228.5, 186.5, 153.5, 130.5,
                119.04545454545455, 88.625, 78.0, 68.71428571428571, 50.06666666666667, 45.4375, 40.088235294117645],
               [3060.5, 1501.25, 980.3333333333334, 712.25, 566.7, 401.0, 338.92857142857144, 283.5, 230.94444444444446,
                204.05, 182.9090909090909, 149.58333333333334, 135.46153846153845, 124.28571428571429, 103.7, 93.1875,
                84.94117647058823, 16.666666666666668, 13.236842105263158, 5.15],
               [4647.5, 2296.25, 1481.6666666666667, 1069.25, 870.0, 662.3333333333334, 564.5, 480.8125, 401.5, 361.75,
                327.27272727272725, 279.375, 249.30769230769232, 232.78571428571428, 204.43333333333334, 187.21875,
                170.73529411764707, 105.27777777777777, 94.07894736842105, 82.2, 69.0952380952381, 58.56818181818182,
                54.17391304347826, 39.354166666666664, 34.7, 27.01923076923077, 16.925925925925927, 14.410714285714286,
                12.327586206896552],
               [7725.5, 3639.25, 2528.6666666666665, 1887.75, 1528.8, 1176.25, 1012.8571428571429, 849.6875,
                740.5555555555555, 669.7, 611.4090909090909, 530.2083333333334, 494.6923076923077, 457.82142857142856,
                401.6666666666667, 375.6875, 355.44117647058823, 278.1111111111111, 262.9736842105263, 231.75,
                215.07142857142858, 197.9090909090909, 184.19565217391303, 167.0625, 156.52, 144.46153846153845,
                132.40740740740742, 123.03571428571429, 119.17241379310344, 103.73333333333333, 97.03225806451613,
                91.421875, 77.04545454545455, 74.3970588235294, 72.02857142857142, 60.22222222222222, 57.66216216216216,
                53.03947368421053, 46.46153846153846, 39.0, 37.08536585365854, 31.333333333333332, 29.046511627906977,
                23.420454545454547, 17.3, 15.565217391304348, 14.170212765957446, 9.541666666666666, 8.448979591836734,
                2.02],
               [15130.0, 7751.25, 5114.666666666667, 3756.75, 3067.2, 2426.9166666666665, 2091.214285714286, 1859.5625,
                1591.7222222222222, 1425.6, 1286.3636363636363, 1157.3333333333333, 1079.5384615384614,
                1016.2857142857143, 914.9333333333333, 863.15625, 827.0882352941177, 717.5555555555555,
                664.3947368421053, 642.05, 593.5714285714286, 547.6818181818181, 532.2173913043479, 489.4791666666667,
                467.44, 445.6923076923077, 406.8703703703704, 409.42857142857144, 390.01724137931035, 348.75,
                353.2903225806452, 325.4375, 313.8181818181818, 293.04411764705884, 294.9714285714286,
                270.77777777777777, 267.81081081081084, 254.72368421052633, 243.12820512820514, 229.05,
                224.09756097560975, 208.88095238095238, 206.2906976744186, 200.625, 189.55555555555554,
                182.58695652173913, 175.37234042553192, 169.79166666666666, 162.71428571428572, 155.31,
                150.33333333333334, 146.90384615384616, 140.30188679245282, 79.60185185185185, 77.69090909090909,
                73.83928571428571, 66.9298245614035, 64.88793103448276, 63.440677966101696, 50.80833333333333,
                50.032786885245905, 45.645161290322584, 40.44444444444444, 37.0078125, 34.815384615384616,
                30.416666666666668, 29.425373134328357, 25.595588235294116, 22.963768115942027, 15.428571428571429,
                14.73943661971831, 8.61111111111111, 7.623287671232877, 5.45945945945946, 2.6866666666666665],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035]]
    per_on_budget = [[0.8996999999999999, 0.92815],
                     [0.8996999999999999, 0.931, 0.93365, 0.9339, 0.9334, 0.9342, 0.9353],
                     [0.8996999999999999, 0.93125, 0.9328, 0.93355, 0.9338, 0.9347, 0.935, 0.93545, 0.9361, 0.93605,
                      0.9361, 0.9373, 0.9373, 0.93745],
                     [0.8996999999999999, 0.929, 0.9321999999999999, 0.933, 0.9333, 0.93465, 0.9347, 0.9351, 0.935,
                      0.93545, 0.936, 0.9384, 0.9381, 0.9384, 0.93735, 0.9384, 0.93845],
                     [0.8996999999999999, 0.929, 0.9320999999999999, 0.9331, 0.9332, 0.9346, 0.9347, 0.93485, 0.93475,
                      0.9349, 0.93475, 0.9354, 0.93605, 0.9386, 0.9402999999999999, 0.9401999999999999,
                      0.9409000000000001, 0.9379, 0.9382, 0.93715],
                     [0.8996999999999999, 0.92815, 0.9331, 0.9331, 0.9332, 0.9347, 0.9347, 0.9356, 0.9348, 0.9349,
                      0.9347, 0.9349, 0.9349, 0.9349, 0.9351, 0.93525, 0.9361, 0.9412, 0.9412, 0.9412, 0.9412, 0.9412,
                      0.9412, 0.9405, 0.9405, 0.9403, 0.93895, 0.9386, 0.93835],
                     [0.8996999999999999, 0.929, 0.9318, 0.93435, 0.9347, 0.9356, 0.9361, 0.9363, 0.93475, 0.9356,
                      0.9349, 0.9347, 0.9347, 0.9349, 0.9347, 0.9347, 0.9349, 0.9349, 0.9351, 0.9363, 0.9372, 0.9412,
                      0.9412, 0.9421, 0.9421, 0.9421, 0.9421, 0.94155, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9416500000000001, 0.9421, 0.9412, 0.9412, 0.9412, 0.9412, 0.9412, 0.9393,
                      0.9394, 0.9392, 0.939, 0.939, 0.93865, 0.9366],
                     [0.8996999999999999, 0.92485, 0.93125, 0.9347, 0.9347, 0.9363, 0.9363, 0.9363, 0.9363, 0.9363,
                      0.9363, 0.9356, 0.9347, 0.9351499999999999, 0.9347, 0.9347, 0.9347, 0.9347, 0.9347, 0.9363,
                      0.9361, 0.9361, 0.9361, 0.9361, 0.9361, 0.9346, 0.9349, 0.9349, 0.9358, 0.9369, 0.9369, 0.9369,
                      0.9365, 0.93865, 0.9375, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9425, 0.9429, 0.9421, 0.9415, 0.9412, 0.9412, 0.9412, 0.9412, 0.94055,
                      0.9403, 0.9397500000000001, 0.9392, 0.9391, 0.939, 0.9378, 0.9371],
                     [0.8996999999999999, 0.92405, 0.9325, 0.9347, 0.9347, 0.9363, 0.9363, 0.9363, 0.9363, 0.9363,
                      0.9363, 0.9351499999999999, 0.9351499999999999, 0.9356, 0.9347, 0.9347, 0.9347, 0.9347, 0.9347,
                      0.9365, 0.9365, 0.9363, 0.9363, 0.9361, 0.9361, 0.9345, 0.9347, 0.9349, 0.9349, 0.9362, 0.9362,
                      0.9363, 0.9361, 0.9363, 0.9361, 0.9349, 0.9349, 0.9361, 0.9361, 0.9367, 0.9369, 0.9369, 0.9395,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9425, 0.9429, 0.9429, 0.9429, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9429, 0.9429,
                      0.9429, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9436, 0.9436, 0.9436, 0.9436, 0.9429, 0.9429, 0.9429, 0.9429,
                      0.9421, 0.9412, 0.9412, 0.9412, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.943, 0.94295,
                      0.94295, 0.9429, 0.9429, 0.9412, 0.9412, 0.9412, 0.9412, 0.9412, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9429, 0.9429, 0.9429, 0.9429, 0.9429, 0.9429,
                      0.9412, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421],
                     [0.8996999999999999, 0.92405, 0.9325, 0.9347, 0.9347, 0.9363, 0.9363, 0.9363, 0.9363, 0.9363,
                      0.9363, 0.9351499999999999, 0.9351499999999999, 0.9356, 0.9347, 0.9347, 0.9347, 0.9347, 0.9347,
                      0.9365, 0.9365, 0.9363, 0.9363, 0.9361, 0.9361, 0.9345, 0.9347, 0.9349, 0.9349, 0.9362, 0.9362,
                      0.9363, 0.9361, 0.9363, 0.9361, 0.9349, 0.9349, 0.9361, 0.9361, 0.9367, 0.9369, 0.9369, 0.9395,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9425, 0.9429, 0.9429, 0.9429, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9429, 0.9429,
                      0.9429, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9436, 0.9436, 0.9436, 0.9436, 0.9429, 0.9429, 0.9429, 0.9429,
                      0.9421, 0.9412, 0.9412, 0.9412, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.943, 0.94295,
                      0.94295, 0.9429, 0.9429, 0.9412, 0.9412, 0.9412, 0.9412, 0.9412, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421,
                      0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9429, 0.9429, 0.9429, 0.9429, 0.9429, 0.9429,
                      0.9412, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421, 0.9421]]
elif used_dataset == Config.c100:
    Fig_y_name = "CIFAR100"
    # this is the ImgNet + NB201
    budget_array = [1, 5, 10, 15, 20, 30, 50, 100, 500, 1000]
    k_div_n = [[155.0, 25.0], [754.5, 324.75, 204.83333333333334, 141.0, 104.3, 25.916666666666668, 14.285714285714286],
               [1503.5, 725.0, 455.6666666666667, 333.625, 254.3, 152.66666666666666, 122.71428571428571, 88.75,
                69.05555555555556, 55.95, 44.31818181818182, 25.666666666666668, 19.423076923076923,
                14.642857142857142],
               [2339.0, 1108.5, 701.3333333333334, 538.0, 400.3, 283.25, 233.85714285714286, 179.5, 151.22222222222223,
                131.7, 112.9090909090909, 91.04166666666667, 78.84615384615384, 69.46428571428571, 50.766666666666666,
                45.125, 39.76470588235294],
               [2999.5, 1477.5, 962.0, 697.375, 564.9, 413.6666666666667, 343.92857142857144, 273.4375,
                228.66666666666666, 211.1, 188.5, 151.33333333333334, 140.84615384615384, 122.35714285714286,
                102.86666666666666, 94.46875, 84.73529411764706, 16.86111111111111, 13.368421052631579, 5.1],
               [4596.5, 2218.25, 1485.0, 1065.875, 881.8, 659.75, 571.2857142857143, 478.3125, 406.27777777777777,
                363.7, 326.77272727272725, 283.9583333333333, 259.38461538461536, 234.53571428571428,
                204.53333333333333, 186.8125, 170.94117647058823, 103.33333333333333, 95.92105263157895, 81.075,
                66.92857142857143, 56.90909090909091, 53.15217391304348, 39.104166666666664, 35.22, 27.48076923076923,
                16.88888888888889, 14.339285714285714, 12.568965517241379],
               [7519.0, 3862.0, 2493.3333333333335, 1872.125, 1487.4, 1197.1666666666667, 1019.1428571428571, 867.9375,
                753.2222222222222, 656.45, 604.4545454545455, 544.5, 486.4230769230769, 446.7142857142857, 424.0,
                378.09375, 359.3235294117647, 273.25, 253.44736842105263, 234.925, 215.66666666666666,
                199.95454545454547, 181.08695652173913, 168.20833333333334, 152.12, 144.67307692307693,
                128.11111111111111, 124.21428571428571, 118.72413793103448, 102.45, 95.61290322580645, 93.734375, 79.0,
                77.80882352941177, 70.0, 60.666666666666664, 56.91891891891892, 52.56578947368421, 47.35897435897436,
                40.025, 37.5609756097561, 32.523809523809526, 29.72093023255814, 23.09090909090909, 17.244444444444444,
                15.554347826086957, 13.936170212765957, 9.489583333333334, 8.479591836734693, 2.1],
               [15180.0, 7754.0, 4948.0, 3820.75, 2997.1, 2495.0833333333335, 2054.0714285714284, 1801.9375,
                1609.888888888889, 1425.45, 1309.6818181818182, 1164.5416666666667, 1096.576923076923,
                1001.0714285714286, 931.0666666666667, 874.6875, 794.1764705882352, 705.8888888888889,
                669.1315789473684, 614.975, 582.6666666666666, 545.3636363636364, 519.7173913043479, 492.7708333333333,
                461.58, 444.4230769230769, 405.68518518518516, 402.75, 377.7931034482759, 356.9, 350.03225806451616,
                341.15625, 306.0151515151515, 304.05882352941177, 293.85714285714283, 268.84722222222223,
                268.35135135135135, 255.75, 245.34615384615384, 234.775, 222.5, 210.16666666666666, 209.52325581395348,
                201.625, 190.5222222222222, 178.0326086956522, 178.11702127659575, 171.29166666666666,
                162.3469387755102, 152.51, 145.4313725490196, 142.98076923076923, 143.35849056603774, 79.07407407407408,
                78.12727272727273, 73.92857142857143, 68.15789473684211, 64.58620689655173, 61.94915254237288, 53.175,
                49.09016393442623, 45.95967741935484, 40.357142857142854, 36.7578125, 35.36153846153846,
                30.454545454545453, 29.119402985074625, 26.639705882352942, 22.985507246376812, 15.528571428571428,
                14.54225352112676, 8.520833333333334, 7.616438356164384, 5.344594594594595, 2.7533333333333334],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035]]
    per_on_budget = [[93.22999999999999, 93.19749999999999],
                     [93.39, 93.495, 93.6949, 93.8175, 93.79750000000001, 93.7525, 93.69245000000001],
                     [93.46, 93.475, 93.565, 93.67495, 93.755, 93.85499999999999, 93.89, 93.9, 93.9, 93.875, 93.9,
                      93.85, 93.8258, 93.81745000000001],
                     [93.46, 93.475, 93.495, 93.745, 93.8175, 93.83, 93.9, 93.9575, 93.925, 93.99, 93.9883,
                      93.96000000000001, 93.96000000000001, 93.94, 93.9, 93.86330000000001, 93.905],
                     [93.475, 93.48750000000001, 93.495, 93.705, 93.805, 93.83, 93.99, 94.01495, 93.99, 93.99, 93.99,
                      93.99, 93.99, 93.99, 93.99, 93.99, 93.99, 93.9208, 93.8966, 93.705],
                     [93.76, 93.705, 93.705, 94.2199, 94.2199, 94.2199, 94.2199, 94.16239999999999, 94.02, 94.02,
                      94.005, 93.99, 93.99, 93.99, 93.99, 93.99, 93.99, 94.0099, 93.99, 94.0099, 93.99, 94.0099,
                      93.98165, 93.98, 93.94749999999999, 93.9358, 93.9675, 93.925, 93.925],
                     [93.76, 93.705, 94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.29159999999999,
                      94.2199, 94.2199, 94.2199, 94.2199, 94.02, 94.02, 94.02, 94.1049, 94.2199, 94.0099, 93.99,
                      94.0099, 93.99995, 93.99, 93.99, 94.02, 93.99, 93.99, 94.0099, 94.0099, 94.0099, 94.0099, 94.125,
                      94.125, 94.125, 93.99, 93.99, 93.99, 93.99, 94.0099, 94.0099, 93.99, 93.99, 93.94, 93.9799, 93.97,
                      93.97, 93.925, 93.925, 93.7116],
                     [93.76, 93.76, 93.705, 94.29159999999999, 94.3633, 94.3633, 94.3633, 94.29159999999999, 94.3633,
                      94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.2199, 94.2199, 94.3633,
                      94.3633, 94.2199, 94.2199, 94.29159999999999, 94.2199, 94.3633, 94.2199, 94.2199, 94.2199,
                      94.3633, 94.3633, 94.3633, 94.2966, 94.25825, 94.2966, 94.2199, 94.2199, 94.25825, 94.2199, 94.02,
                      94.0099, 94.0099, 94.02, 94.2966, 94.1049, 93.99, 93.99, 93.99, 93.99, 94.0099, 94.0099, 94.0099,
                      94.0099, 94.2966, 94.2966, 93.98, 93.98, 94.29495, 94.2966, 94.195, 94.21, 94.09, 94.09, 94.0633,
                      94.0633, 94.045, 94.01245, 94.02, 94.0099, 93.99, 93.97, 93.95994999999999, 93.94, 93.925,
                      93.83245],
                     [93.76, 93.76, 93.705, 94.2199, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633,
                      94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.2199, 94.2199, 94.3633, 94.3633, 94.2199,
                      94.2199, 94.3633, 94.3633, 94.3633, 94.2199, 94.2199, 94.2199, 94.3633, 94.3633, 94.3633, 94.2199,
                      94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.06245, 94.3633, 94.3633, 94.3633, 94.3633,
                      94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.3633, 94.3633, 94.3633, 94.3633, 94.2199,
                      94.1049, 94.2966, 94.2966, 94.2966, 94.2966, 94.0099, 94.0099, 94.3633, 94.2966, 94.2199, 94.2199,
                      94.2966, 94.2966, 94.2966, 94.2966, 94.02, 94.02, 94.2966, 94.2966, 94.2966, 94.2966, 93.925,
                      93.925, 93.9575, 93.925, 94.3633, 93.99995, 93.99, 93.99, 94.2199, 94.2199, 94.2199, 94.2966,
                      94.2966, 94.2966, 93.99, 93.99, 93.99, 94.2966, 94.2966, 94.2966, 94.2199, 94.2199, 94.2199,
                      94.2966, 94.2966, 94.2966, 93.925, 93.925, 93.925, 93.99, 93.99, 93.99, 94.06245, 94.1049,
                      94.1049, 94.1049, 93.99, 93.99, 93.99, 93.99, 94.2966, 94.2966, 94.2966, 94.2966, 93.99, 93.99,
                      93.99, 93.99, 94.2983, 94.3, 94.2983, 94.3, 94.2966, 94.2966, 94.2966, 94.2983, 94.2966, 94.2966,
                      94.2966, 94.3, 94.3, 94.3, 94.3, 94.3, 94.0099, 94.0099, 94.0099, 94.0099, 94.2199, 94.2966,
                      94.2966, 94.2966, 94.2966, 94.2966, 93.9575, 93.9575, 93.9575, 93.9575, 93.9575, 94.3, 94.3, 94.3,
                      94.3, 94.3, 94.3633, 94.3633, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.29495, 94.29495, 94.2966,
                      94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 93.99995,
                      93.99995, 93.99, 93.99, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3,
                      93.99, 93.99, 93.98, 93.98],
                     [93.76, 93.76, 93.705, 94.2199, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633,
                      94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.3633, 94.2199, 94.2199, 94.3633, 94.3633, 94.2199,
                      94.2199, 94.3633, 94.3633, 94.3633, 94.2199, 94.2199, 94.2199, 94.3633, 94.3633, 94.3633, 94.2199,
                      94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.06245, 94.3633, 94.3633, 94.3633, 94.3633,
                      94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.2199, 94.3633, 94.3633, 94.3633, 94.3633, 94.2199,
                      94.1049, 94.2966, 94.2966, 94.2966, 94.2966, 94.0099, 94.0099, 94.3633, 94.2966, 94.2199, 94.2199,
                      94.2966, 94.2966, 94.2966, 94.2966, 94.02, 94.02, 94.2966, 94.2966, 94.2966, 94.2966, 93.925,
                      93.925, 93.9575, 93.925, 94.3633, 93.99995, 93.99, 93.99, 94.2199, 94.2199, 94.2199, 94.2966,
                      94.2966, 94.2966, 93.99, 93.99, 93.99, 94.2966, 94.2966, 94.2966, 94.2199, 94.2199, 94.2199,
                      94.2966, 94.2966, 94.2966, 93.925, 93.925, 93.925, 93.99, 93.99, 93.99, 94.06245, 94.1049,
                      94.1049, 94.1049, 93.99, 93.99, 93.99, 93.99, 94.2966, 94.2966, 94.2966, 94.2966, 93.99, 93.99,
                      93.99, 93.99, 94.2983, 94.3, 94.2983, 94.3, 94.2966, 94.2966, 94.2966, 94.2983, 94.2966, 94.2966,
                      94.2966, 94.3, 94.3, 94.3, 94.3, 94.3, 94.0099, 94.0099, 94.0099, 94.0099, 94.2199, 94.2966,
                      94.2966, 94.2966, 94.2966, 94.2966, 93.9575, 93.9575, 93.9575, 93.9575, 93.9575, 94.3, 94.3, 94.3,
                      94.3, 94.3, 94.3633, 94.3633, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.29495, 94.29495, 94.2966,
                      94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 94.2966, 93.99995,
                      93.99995, 93.99, 93.99, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3, 94.3,
                      93.99, 93.99, 93.98, 93.98]]
else:
    y_lim = [43.5, 46.5]
    Fig_y_name = "IN16"
    # this is C10 + NB201
    budget_array = [1, 5, 10, 15, 20, 30, 50, 100, 500, 1000]
    k_div_n = [[149.5, 25.5], [782.5, 338.75, 207.66666666666666, 141.0, 100.4, 25.666666666666668, 14.285714285714286],
               [1515.0, 693.5, 464.1666666666667, 341.5, 256.6, 156.91666666666666, 124.07142857142857, 89.625,
                67.94444444444444, 55.85, 45.77272727272727, 24.833333333333332, 19.653846153846153,
                14.392857142857142],
               [2321.5, 1094.75, 716.3333333333334, 535.25, 410.8, 279.4166666666667, 234.92857142857142, 187.8125,
                155.22222222222223, 133.8, 114.9090909090909, 92.08333333333333, 80.07692307692308, 69.96428571428571,
                51.1, 44.78125, 39.029411764705884],
               [3101.5, 1447.5, 955.8333333333334, 712.875, 561.1, 407.4166666666667, 338.64285714285717, 284.625,
                237.11111111111111, 203.35, 189.1818181818182, 151.875, 133.76923076923077, 125.60714285714286,
                103.33333333333333, 93.0625, 84.67647058823529, 17.333333333333332, 13.263157894736842, 5.125],
               [4569.0, 2283.0, 1504.3333333333333, 1094.25, 852.9, 667.25, 583.3571428571429, 478.75,
                411.1111111111111, 369.2, 320.45454545454544, 280.25, 255.53846153846155, 231.71428571428572, 202.4,
                186.28125, 178.61764705882354, 101.16666666666667, 96.63157894736842, 81.675, 67.88095238095238, 57.5,
                52.43478260869565, 39.041666666666664, 34.92, 27.26923076923077, 17.25925925925926, 14.678571428571429,
                12.068965517241379],
               [7495.0, 3705.75, 2475.3333333333335, 1855.0, 1477.3, 1192.4166666666667, 1006.4285714285714, 859.25,
                748.8333333333334, 656.6, 609.4545454545455, 544.4583333333334, 488.5769230769231, 453.60714285714283,
                401.7, 388.90625, 350.61764705882354, 277.9166666666667, 256.7631578947368, 233.3, 216.26190476190476,
                196.4090909090909, 187.52173913043478, 170.4375, 157.96, 146.15384615384616, 130.24074074074073,
                124.44642857142857, 117.82758620689656, 102.58333333333333, 97.35483870967742, 90.5625,
                81.45454545454545, 74.76470588235294, 71.45714285714286, 59.375, 56.62162162162162, 53.78947368421053,
                46.6025641025641, 39.7, 36.73170731707317, 31.761904761904763, 29.53488372093023, 23.136363636363637,
                17.211111111111112, 15.793478260869565, 14.01063829787234, 9.729166666666666, 8.36734693877551, 2.05],
               [15622.0, 7812.0, 4952.333333333333, 3827.625, 2984.6, 2501.25, 2102.214285714286, 1834.5625,
                1593.3333333333333, 1420.95, 1279.7272727272727, 1188.5833333333333, 1088.2692307692307, 1004.0, 920.1,
                861.25, 804.2647058823529, 715.6944444444445, 663.0526315789474, 614.05, 593.952380952381,
                543.7954545454545, 522.7391304347826, 496.9166666666667, 457.58, 433.13461538461536, 409.7037037037037,
                407.07142857142856, 385.7931034482759, 342.8666666666667, 343.2258064516129, 325.84375,
                313.0151515151515, 305.05882352941177, 295.85714285714283, 278.4166666666667, 269.27027027027026,
                254.5921052631579, 240.4102564102564, 232.725, 225.26829268292684, 221.0952380952381,
                205.95348837209303, 203.25, 186.42222222222222, 183.84782608695653, 177.74468085106383, 169.28125,
                163.0, 154.23, 149.33333333333334, 143.90384615384616, 141.31132075471697, 80.12037037037037, 78.0,
                70.01785714285714, 69.15789473684211, 64.70689655172414, 64.55932203389831, 52.38333333333333,
                50.84426229508197, 45.57258064516129, 39.142857142857146, 37.265625, 35.38461538461539,
                30.666666666666668, 28.753731343283583, 26.676470588235293, 22.905797101449274, 15.114285714285714,
                14.556338028169014, 8.45138888888889, 7.6506849315068495, 5.594594594594595, 2.6933333333333334],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035],
               [15624.0, 7812.0, 5208.0, 3906.0, 3124.8, 2604.0, 2232.0, 1953.0, 1736.0, 1562.4, 1420.3636363636363,
                1302.0, 1201.8461538461538, 1116.0, 1041.6, 976.5, 919.0588235294117, 868.0, 822.3157894736842, 781.2,
                744.0, 710.1818181818181, 679.304347826087, 651.0, 624.96, 600.9230769230769, 578.6666666666666, 558.0,
                538.7586206896551, 520.8, 504.0, 488.25, 473.45454545454544, 459.52941176470586, 446.4, 434.0,
                422.27027027027026, 411.1578947368421, 400.61538461538464, 390.6, 381.0731707317073, 372.0,
                363.3488372093023, 355.09090909090907, 347.2, 339.6521739130435, 332.4255319148936, 325.5,
                318.85714285714283, 312.48, 306.3529411764706, 300.46153846153845, 294.79245283018867,
                289.3333333333333, 284.07272727272726, 279.0, 274.10526315789474, 269.37931034482756, 264.8135593220339,
                260.4, 256.1311475409836, 252.0, 248.0, 244.125, 240.36923076923077, 236.72727272727272,
                233.19402985074626, 229.76470588235293, 226.43478260869566, 223.2, 220.05633802816902, 217.0,
                214.02739726027397, 211.13513513513513, 208.32, 205.57894736842104, 202.9090909090909,
                200.30769230769232, 197.77215189873417, 195.3, 192.88888888888889, 190.53658536585365,
                188.24096385542168, 186.0, 183.81176470588235, 181.67441860465115, 179.58620689655172,
                177.54545454545453, 175.5505617977528, 173.6, 171.69230769230768, 169.82608695652175, 168.0,
                166.2127659574468, 164.46315789473684, 162.75, 161.0721649484536, 159.42857142857142, 157.8181818181818,
                156.24, 154.69306930693068, 153.1764705882353, 151.6893203883495, 150.23076923076923, 148.8,
                147.39622641509433, 146.01869158878506, 144.66666666666666, 143.3394495412844, 142.03636363636363,
                140.75675675675674, 139.5, 138.26548672566372, 137.05263157894737, 135.8608695652174,
                134.68965517241378, 133.53846153846155, 132.40677966101694, 131.2941176470588, 130.2,
                129.12396694214877, 128.0655737704918, 127.02439024390245, 126.0, 124.992, 124.0, 123.02362204724409,
                122.0625, 121.11627906976744, 120.18461538461538, 119.26717557251908, 118.36363636363636,
                117.47368421052632, 116.59701492537313, 115.73333333333333, 114.88235294117646, 114.04379562043796,
                113.21739130434783, 112.40287769784173, 111.6, 110.80851063829788, 110.02816901408451,
                109.25874125874125, 108.5, 107.75172413793103, 107.01369863013699, 106.28571428571429,
                105.56756756756756, 104.85906040268456, 104.16, 103.47019867549669, 102.78947368421052,
                102.11764705882354, 101.45454545454545, 100.8, 100.15384615384616, 99.51592356687898, 98.88607594936708,
                98.26415094339623, 97.65, 97.04347826086956, 96.44444444444444, 95.85276073619632, 95.26829268292683,
                94.69090909090909, 94.12048192771084, 93.55688622754491, 93.0, 92.44970414201184, 91.90588235294118,
                91.36842105263158, 90.83720930232558, 90.3121387283237, 89.79310344827586, 89.28, 88.77272727272727,
                88.27118644067797, 87.7752808988764, 87.28491620111731, 86.8, 86.32044198895028, 85.84615384615384,
                85.37704918032787, 84.91304347826087, 84.45405405405405, 84.0, 83.55080213903743, 83.1063829787234,
                82.66666666666667, 82.23157894736842, 81.80104712041884, 81.375, 80.95336787564767, 80.5360824742268,
                80.12307692307692, 79.71428571428571, 79.30964467005076, 78.9090909090909, 78.51256281407035]]
    per_on_budget = [[42.19715, 43.7555],
                     [42.19715, 44.0624, 45.1999, 45.274950000000004, 45.299949999999995, 45.0166, 44.50135],
                     [42.3416, 42.4333, 45.1999, 45.20825, 45.2166, 45.4249, 45.5444, 45.53465, 45.2916, 45.2916,
                      45.366600000000005, 45.4249, 45.2666, 45.0916],
                     [42.3416, 42.4333, 44.9777, 45.4083, 45.4249, 45.3999, 45.5444, 45.9666, 45.5444, 45.74995,
                      45.5777, 45.8305, 45.5638, 45.5444, 45.4902, 45.440200000000004, 45.5444],
                     [42.3666, 42.4333, 45.3041, 45.1999, 45.4083, 45.4249, 45.5166, 45.9555, 45.5444, 45.5444,
                      45.96105, 46.0541, 45.5444, 46.049949999999995, 46.1416, 45.9666, 46.061049999999994, 45.5444,
                      45.315250000000006, 44.2916],
                     [42.4333, 43.7666, 45.9555, 46.315200000000004, 45.9555, 45.9555, 45.9555, 45.9555, 45.45685,
                      45.5444, 45.5444, 45.5444, 45.5444, 46.0541, 46.1416, 46.1416, 46.1416, 46.1333, 46.1333, 45.9888,
                      45.72495, 46.1333, 46.1333, 45.58325, 45.5444, 45.5444, 45.46525, 45.3666, 45.46665],
                     [41.1111, 42.4333, 45.6819, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      45.96105, 45.9555, 45.9555, 45.5444, 45.5444, 45.5444, 46.1416, 46.3069, 46.1416, 46.1416,
                      46.2583, 46.1416, 46.13745, 46.13745, 46.19995, 46.1833, 46.1416, 46.1416, 46.1333, 45.9888,
                      46.1333, 46.2583, 46.2583, 46.3555, 46.1333, 45.9888, 45.9888, 45.9888, 45.6333, 45.6333, 45.6333,
                      45.6333, 45.61935, 45.606849999999994, 45.5888, 45.5444, 45.38745, 45.3111, 44.293000000000006],
                     [41.1111, 42.4333, 42.4333, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 45.9555, 45.9555, 45.9555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.2583, 46.2583, 46.2583, 46.2583, 46.3555,
                      46.225, 46.225, 46.225, 46.225, 46.225, 46.24165, 46.2583, 46.1833, 46.1416, 45.9888,
                      46.061049999999994, 46.1333, 46.1333, 46.225, 46.225, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888,
                      45.9888, 45.9888, 45.9888, 45.9888, 45.9152, 45.5444, 45.5444, 45.55275, 45.5097, 45.41245,
                      44.5333],
                     [41.1111, 42.4333, 42.4333, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 45.9555,
                      45.9555, 45.9555, 46.16105, 46.1555, 45.9555, 45.74995, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3069, 45.9555, 45.9666, 46.3555, 46.16105, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.16105, 45.9666, 46.3555, 46.3555, 46.3555, 46.3555, 45.5444, 45.5444, 46.3555, 46.3555,
                      46.0958, 46.29025, 46.3722, 46.3722, 46.3722, 46.3722, 46.2583, 46.2583, 46.3555, 46.3555,
                      46.36385, 46.36385, 45.96105, 45.96105, 46.225, 46.225, 46.3555, 46.225, 46.225, 46.225, 46.3555,
                      46.3555, 46.3555, 46.3722, 46.3722, 46.3722, 46.225, 46.225, 46.225, 46.3555, 46.3555, 46.3555,
                      46.225, 46.225, 46.29025, 46.3722, 46.3722, 46.3722, 46.225, 46.225, 46.225, 46.225, 46.225,
                      46.225, 45.9666, 46.225, 46.225, 46.225, 46.225, 46.225, 46.225, 46.225, 46.3722, 46.3722,
                      46.3722, 46.3722, 46.225, 46.225, 46.225, 46.225, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888,
                      46.225, 46.225, 46.225, 46.225, 46.225, 46.3722, 46.3722, 46.3722, 46.3722, 46.3722, 46.225,
                      46.225, 46.225, 46.225, 46.225, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 46.1333, 46.1333,
                      45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 46.225, 46.225, 46.225, 46.225, 46.225,
                      46.225, 46.3722, 46.3722, 46.3722, 46.3722, 46.36385, 46.36385, 45.9888, 45.9888, 45.9888,
                      45.9888, 46.225, 46.225, 46.1333, 46.1333, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888,
                      45.9888, 45.9888, 46.225, 46.225, 46.17915, 46.225],
                     [41.1111, 42.4333, 42.4333, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 45.9555,
                      45.9555, 45.9555, 46.16105, 46.1555, 45.9555, 45.74995, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3069, 45.9555, 45.9666, 46.3555, 46.16105, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.16105, 45.9666, 46.3555, 46.3555, 46.3555, 46.3555, 45.5444, 45.5444, 46.3555, 46.3555,
                      46.0958, 46.29025, 46.3722, 46.3722, 46.3722, 46.3722, 46.2583, 46.2583, 46.3555, 46.3555,
                      46.36385, 46.36385, 45.96105, 45.96105, 46.225, 46.225, 46.3555, 46.225, 46.225, 46.225, 46.3555,
                      46.3555, 46.3555, 46.3722, 46.3722, 46.3722, 46.225, 46.225, 46.225, 46.3555, 46.3555, 46.3555,
                      46.225, 46.225, 46.29025, 46.3722, 46.3722, 46.3722, 46.225, 46.225, 46.225, 46.225, 46.225,
                      46.225, 45.9666, 46.225, 46.225, 46.225, 46.225, 46.225, 46.225, 46.225, 46.3722, 46.3722,
                      46.3722, 46.3722, 46.225, 46.225, 46.225, 46.225, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555,
                      46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 46.3555, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888,
                      46.225, 46.225, 46.225, 46.225, 46.225, 46.3722, 46.3722, 46.3722, 46.3722, 46.3722, 46.225,
                      46.225, 46.225, 46.225, 46.225, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 46.1333, 46.1333,
                      45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 46.225, 46.225, 46.225, 46.225, 46.225,
                      46.225, 46.3722, 46.3722, 46.3722, 46.3722, 46.36385, 46.36385, 45.9888, 45.9888, 45.9888,
                      45.9888, 46.225, 46.225, 46.1333, 46.1333, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888, 45.9888,
                      45.9888, 45.9888, 46.225, 46.225, 46.17915, 46.225]]

fig2, ax = plt.subplots(figsize=(6.8, 4.8))

N_K_ratio = 0
factor = 10
num_points = 6
cor_index = 0
# this is to plot trade off between N and K
for i in [1, 2, 3, 5]:
    x = k_div_n[i]
    if used_dataset == Config.c10:
        y = np.array(per_on_budget[i]) * 100
        y = y.tolist()
    else:
        y = per_on_budget[i]

    # sample in log scale way, use 10 points at the most
    if len(x) > num_points:
        indices = sample_in_log_scale(x, num_points)
        #
        # Sample the list using the calculated indices
        x = [x[i] for i in indices]
        y = [y[i] for i in indices]

    plt.plot(x, y,
             mark_list[i % len(mark_list)] + line_shape_list[cor_index],
             label=r"$T$=" + str(budget_array[i]) + " min",
             linewidth=8,
             markersize=5
             )
    cor_index += 1

    N_K_ratio += x[y.index(max(y))]

N_K_ratio = N_K_ratio / len(k_div_n)
print("N/K ratio = ", N_K_ratio)


def thousands_formatter(x, pos):
    return '{:.2f}'.format(x)


formatter = FuncFormatter(thousands_formatter)
ax.yaxis.set_major_formatter(formatter)

plt.xscale("log")
plt.grid()
plt.xlabel("N/K")
plt.ylabel(f"Test Acc on {Fig_y_name}")
plt.ylim(y_lim[0], y_lim[1])

# plt.legend(ncol=3, prop={'size': 12})
# plt.show()
print(f"./trade_off_nk_{used_dataset}.pdf")
fig2.savefig(f"./internal/ml/model_selection/exp_result/trade_off_nk_{used_dataset}.pdf", bbox_inches='tight')
