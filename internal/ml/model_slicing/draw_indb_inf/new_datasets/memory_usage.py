import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter

# Sample data, replace this with your actual data
# memory_log = {
#     "with all opt": [[0.012600245, 18748], [1.043574622, 181904], [2.880909715, 439356], [4.746978433, 450032],
#                      [6.580087388, 454812], [8.395959081, 461368], [10.229162885, 466332], [12.037321584, 470420],
#                      [13.867830914, 479540], [15.682375319, 481492], [17.114590375, 489424], [18.88665319, 487128],
#                      [20.715824796, 493432], [22.523327161, 498308], [24.340567323, 510192], [26.164078111, 509144],
#                      [27.992991493, 510196], [29.810057809, 516004], [31.624005968, 529172], [33.433013773, 531936],
#                      [35.25928479, 532344], [37.092092925, 538364], [38.102963907, 548744],
#                      [39.924327023000004, 545516], [41.729301603, 550884], [43.540291392, 557808],
#                      [45.347360579, 561724], [47.169496446, 556168], [49.011585526, 581232], [50.823214165, 574888],
#                      [52.64347461, 573316], [54.447590065, 571784], [56.276114357, 578064], [57.283435147, 570924],
#                      [59.12331606, 576356], [60.942781559, 577336], [62.764237568, 581372], [64.595277978, 575348],
#                      [66.403776621, 574876], [68.20959977, 578288], [70.019599508, 574892], [71.859492037, 567136],
#                      [73.663600443, 567480], [75.487515269, 576564], [77.133634976, 567664], [78.954270747, 578108],
#                      [80.79577953, 577728], [82.635105627, 575796], [84.447651732, 571864], [86.268515464, 578308],
#                      [88.083857798, 575500], [89.922615099, 567136], [91.729333261, 574744]],
#     "skip slice_model()": [[0.042694868, 18528], [1.054480046, 180976], [2.869932923, 303848], [4.683334884, 309164],
#                            [6.496423195, 317100], [8.303804408, 338020], [9.512667188, 339280], [11.334003168, 351248],
#                            [13.149602165, 359480], [14.967301195, 371392], [16.775008038, 375576],
#                            [18.609840614, 395792], [20.425202473, 403904], [22.232969018, 412080],
#                            [24.03805168, 416152], [25.84236809, 431664], [27.717021297, 428512], [29.498214122, 426732],
#                            [31.249602243, 438464], [33.063644976, 427312], [34.870353464, 428468],
#                            [36.673594206, 423136], [38.497763786, 429512], [40.30969706, 428276],
#                            [42.119186815, 422584], [43.96071582, 428696]],
#     "skip py_call()": [[0.037487731, 18596], [1.049279797, 183072], [2.874304285, 307504], [4.691098214, 310540],
#                        [6.506874205, 313776], [8.323560725, 317032], [10.141980121, 320264], [11.159410321, 322108],
#                        [12.975202068, 325320], [14.791966966, 328416], [16.605266190000002, 331584],
#                        [18.427664584, 334884], [20.245025925, 338292], [22.058351874, 341388], [23.890465751, 344692],
#                        [25.705545216, 347916], [27.522452603, 351332], [29.333310017, 354484], [30.352157345, 356332],
#                        [32.166749406, 360272], [33.982633515, 363588], [35.798760843, 366808], [37.614703567, 369848],
#                        [39.43130915, 373356], [41.247204044, 376604], [43.061635834, 379644], [44.878014548, 382916],
#                        [46.693206224, 385960], [48.511253715, 389324], [50.304198335, 392496], [52.118861656, 395536],
#                        [53.936806313, 398620], [55.75111513, 401740], [57.565047381, 405112], [59.38717689, 408284],
#                        [61.202498465, 411316], [63.022486377, 414684], [64.836342967, 417852], [66.646825683, 420692],
#                        [68.458628796, 423728], [70.271319163, 426908], [71.286288318, 428624], [73.101626735, 431592],
#                        [74.919554886, 434632], [76.740418829, 437672], [78.558534728, 438784], [80.373493686, 438784],
#                        [82.196832336, 438832], [84.009351503, 438832], [85.830947725, 438832], [87.646467389, 438832],
#                        [89.461031784, 438832], [90.479992122, 438832], [92.294620107, 438832], [94.111099799, 438832],
#                        [95.927230684, 438832], [97.746362444, 438832], [99.563158397, 438832], [101.383019042, 438832],
#                        [103.202695871, 438832], [105.017722804, 438832], [106.834484135, 438832],
#                        [108.647513243, 438832], [110.301242856, 438832], [112.118349192, 438832],
#                        [113.932724093, 438832], [115.74753262, 438832], [117.562538053, 438832],
#                        [119.379353309, 438832], [121.195222711, 438832], [123.010560053, 438832],
#                        [124.827020238, 438832], [126.642775797, 438832], [128.459480247, 438832],
#                        [130.281429911, 438832], [132.097044741, 438860], [133.912049601, 438864],
#                        [135.730862672, 438864], [137.54748466, 438864], [139.367069797, 438864],
#                        [141.180923526, 438864], [142.998003973, 438864], [144.813620774, 438864],
#                        [146.630798922, 438864], [148.451205105, 438864], [150.266960215, 438864],
#                        [151.284242509, 438868], [153.097853193, 438868]],
#     "del tensor input": [[0.054385368, 18624], [1.067849517, 185616], [2.901614011, 438320], [3.917688274, 436544],
#                          [5.736061766, 445896], [7.548737215, 378156], [9.366380075, 457636], [11.24744956, 463812],
#                          [13.052007021, 468808], [14.874246281, 385128], [16.732588026, 479272], [18.561360171, 485716],
#                          [20.398859579, 488532], [22.204423505, 404036], [23.793341643, 496076], [25.612309963, 446308],
#                          [27.444747921, 416448], [29.254008026, 513644], [31.088803812, 428000], [32.902038096, 521348],
#                          [34.717332123, 523908], [36.555603846, 470384], [38.365823787, 535356], [40.175110609, 538456],
#                          [42.027637158, 546492], [43.790587946, 551372], [45.556554618, 545584], [47.376132303, 559660],
#                          [49.202024759, 520548], [51.01185505, 568720], [52.823131681, 575540], [54.631675351, 566048],
#                          [56.442919021, 575484], [58.288686412, 572360], [60.100066386, 570704], [61.922948475, 567112],
#                          [63.734473112, 567968], [64.741727769, 566108], [66.578540643, 576664], [68.40184616, 574012],
#                          [70.227813142, 568888], [72.053873509, 566012], [73.872927372, 567696], [75.732145544, 565956],
#                          [77.55978126, 570304], [79.381456961, 563472], [81.195234408, 568084], [83.033166813, 563724],
#                          [84.041605986, 566292], [85.888401306, 565200], [87.735611201, 575888], [89.545348051, 572496],
#                          [91.380171848, 567764], [93.21085096, 567968], [95.031529793, 569912], [96.852397771, 564044]]
#
#     # "w/o state cache": [],
#     # "w/o memory sharing": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
#     # "w/o all opt": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
# }


memory_log = {
    "with all opt": [["before all batch", 0.110292659, 16172], ["load model done", 2.48819639, 301192],
                     ["batch 1 done", 2.640308216, 317980], ["batch 2 done", 2.801250954, 319020],
                     ["batch 3 done", 2.904485477, 319736], ["batch 4 done", 3.044160929, 320020],
                     ["batch 5 done", 3.159827177, 320424], ["batch 6 done", 3.251949047, 320456],
                     ["batch 7 done", 3.40565687, 320936], ["batch 8 done", 3.532039829, 319564],
                     ["batch 9 done", 3.636490058, 320272], ["batch 10 done", 3.759369356, 320696],
                     ["batch 11 done", 3.914114192, 322524], ["batch 12 done", 4.12223747, 322812],
                     ["batch 13 done", 4.281745503, 322900], ["batch 14 done", 4.493841455, 322740],
                     ["batch 15 done", 4.662064537, 322956], ["batch 16 done", 4.8411136710000005, 323136],
                     ["batch 17 done", 5.068255157, 323136], ["batch 18 done", 5.301910686, 323288],
                     ["batch 19 done", 5.496400683, 324040], ["batch 20 done", 5.673503694, 323892],
                     ["batch 21 done", 5.8408613339999995, 323900], ["batch 22 done", 6.069277483, 324152],
                     ["batch 23 done", 6.306856412, 324864], ["batch 24 done", 6.501587797, 325112],
                     ["batch 25 done", 6.695659033, 325228], ["batch 26 done", 6.866128655, 325128],
                     ["batch 27 done", 7.125104432, 325376], ["batch 28 done", 7.346655485, 325628],
                     ["batch 29 done", 7.511957259, 325628], ["batch 30 done", 7.748187481, 325628],
                     ["batch 31 done", 7.978905062, 325852], ["batch 32 done", 8.251889362, 326228],
                     ["batch 33 done", 8.529652908, 326964], ["batch 34 done", 8.802782191, 327100],
                     ["batch 35 done", 9.190398152, 327100], ["batch 36 done", 9.458099257, 327092],
                     ["batch 37 done", 9.657825003, 327100], ["batch 38 done", 9.784049641, 327120],
                     ["batch 39 done", 9.92774343, 327120], ["batch 40 done", 10.070694618, 327120],
                     ["batch 41 done", 10.194090758, 327120], ["batch 42 done", 10.342422002, 327368],
                     ["batch 43 done", 10.486349455, 327368], ["batch 44 done", 10.620266028, 327368],
                     ["batch 45 done", 10.754499629, 327368], ["batch 46 done", 10.894128155, 327368],
                     ["batch 47 done", 11.050047666, 327368], ["batch 48 done", 11.181840398, 329360],
                     ["batch 49 done", 11.359895178, 327368], ["batch 50 done", 11.50002825, 327368],
                     ["batch 51 done", 11.624862066, 327368], ["batch 52 done", 11.750610964, 329836],
                     ["batch 53 done", 11.908910992, 326344], ["batch 54 done", 12.079154402, 326720],
                     ["batch 55 done", 12.214504941, 326744], ["batch 56 done", 12.380399539, 326744],
                     ["batch 57 done", 12.54564832, 326744], ["batch 58 done", 12.714077277, 326768],
                     ["batch 59 done", 12.869823243999999, 326772], ["batch 60 done", 13.016223763, 326764],
                     ["batch 61 done", 13.154276724, 326764], ["batch 62 done", 13.314127392, 326772],
                     ["batch 63 done", 13.456738542, 326800], ["batch 64 done", 13.597780785, 326792],
                     ["batch 65 done", 13.747116865, 327052], ["batch 66 done", 13.895156086, 331052],
                     ["batch 67 done", 14.036580462, 327052], ["batch 68 done", 14.152373543, 327080],
                     ["batch 69 done", 14.290825846, 327080], ["batch 70 done", 14.424953073, 327332],
                     ["batch 71 done", 14.564328513, 327400], ["batch 72 done", 14.713613253, 327624],
                     ["batch 73 done", 14.89235747, 328036], ["batch 74 done", 15.016832858, 328652],
                     ["batch 75 done", 15.162461065, 329624], ["batch 76 done", 15.3683838, 329496],
                     ["batch 77 done", 15.512084209, 329572], ["batch 78 done", 15.644419775, 329584],
                     ["batch 79 done", 15.787674608, 329588], ["batch 80 done", 15.956598559, 329696],
                     ["batch 81 done", 16.111161857, 329948], ["batch 82 done", 16.25190978, 329988],
                     ["batch 83 done", 16.421759727, 329988], ["batch 84 done", 16.564149457, 329988],
                     ["batch 85 done", 16.70964764, 330016], ["batch 86 done", 16.818756214, 330016],
                     ["batch 87 done", 16.966702874, 330016], ["batch 88 done", 17.111162329, 330016],
                     ["batch 89 done", 17.236175203, 330020], ["batch 90 done", 17.378270294, 330020],
                     ["batch 91 done", 17.524931047, 330076], ["batch 92 done", 17.665598561, 330100],
                     ["batch 93 done", 17.7951296, 330468], ["batch 94 done", 17.953904114, 330836],
                     ["batch 95 done", 18.11675317, 331252], ["batch 96 done", 18.239024922, 331272],
                     ["batch 97 done", 18.370743718, 331340], ["batch 98 done", 18.516129689, 331340],
                     ["batch 99 done", 18.65417456, 331588], ["batch 100 done", 18.787020693, 331588],
                     ["batch 101 done", 18.922763741, 332132], ["batch 102 done", 19.076965764, 332460],
                     ["batch 103 done", 19.205717963, 332460], ["batch 104 done", 19.373212261, 332460],
                     ["batch 105 done", 19.504142742, 332460], ["batch 106 done", 19.633948353, 332452],
                     ["batch 107 done", 19.783543473, 330956], ["batch 108 done", 19.916638289, 330956],
                     ["batch 109 done", 20.079139201, 330956], ["batch 110 done", 20.227292496, 330956],
                     ["batch 111 done", 20.41027175, 330956], ["batch 112 done", 20.565472647, 330956],
                     ["batch 113 done", 20.725043459, 336628], ["batch 114 done", 20.859229411, 336752],
                     ["batch 115 done", 20.99583558, 336752], ["batch 116 done", 21.121076615, 337028],
                     ["batch 117 done", 21.242507946, 337532], ["batch 118 done", 21.397333216, 338152],
                     ["batch 119 done", 21.534166865, 338744], ["batch 120 done", 21.659189213, 338756],
                     ["batch 121 done", 21.794994942, 338760], ["batch 122 done", 21.937630999, 338884],
                     ["batch 123 done", 22.086067259, 338884], ["batch 124 done", 22.232335519, 338884],
                     ["batch 125 done", 22.398388228, 339028], ["batch 126 done", 22.539254861, 339036],
                     ["batch 127 done", 22.67277618, 339160], ["batch 128 done", 22.80400097, 339152],
                     ["batch 129 done", 22.939303619, 339168], ["batch 130 done", 23.084360664, 337420],
                     ["batch 131 done", 23.242269228, 337436], ["batch 132 done", 23.38695774, 337444],
                     ["batch 133 done", 23.533669912, 337444], ["batch 134 done", 23.665599794, 337696],
                     ["batch 135 done", 23.808225959, 337704], ["batch 136 done", 23.961670505, 337704],
                     ["batch 137 done", 24.100770385, 337864], ["batch 138 done", 24.248356849, 337992],
                     ["batch 139 done", 24.393323848, 338684], ["batch 140 done", 24.552163247, 338892],
                     ["batch 141 done", 24.695265087, 338644], ["batch 142 done", 24.840476939, 338892],
                     ["batch 143 done", 24.969243949, 339144], ["batch 144 done", 25.113942281, 339144],
                     ["batch 145 done", 25.239699791, 339384], ["batch 146 done", 25.383267322000002, 338648],
                     ["batch 147 done", 25.527373469, 339388], ["batch 148 done", 25.671934957, 339396],
                     ["batch 149 done", 25.789637221, 339396], ["batch 150 done", 25.921126178, 339864],
                     ["batch 151 done", 26.087323705, 339896], ["batch 152 done", 26.220345877, 340144],
                     ["batch 153 done", 26.351252346, 340144], ["batch 154 done", 26.504672102, 340144],
                     ["batch 155 done", 26.653874801, 340156], ["batch 156 done", 26.764692489, 340184],
                     ["batch 157 done", 26.883526028, 340204], ["batch 158 done", 27.042583416, 340780],
                     ["batch 159 done", 27.18865824, 341156], ["batch 160 done", 27.324785027, 341520],
                     ["batch 161 done", 27.472256033, 341616], ["batch 162 done", 27.60042126, 341616],
                     ["batch 163 done", 27.736682052, 341636], ["batch 164 done", 27.862010065, 341636],
                     ["batch 165 done", 27.985600175, 343636], ["batch 166 done", 28.110638535, 341888],
                     ["batch 167 done", 28.24707934, 341888], ["batch 168 done", 28.386991279, 341888],
                     ["batch 169 done", 28.542088071, 341900], ["batch 170 done", 28.718496899, 341892],
                     ["batch 171 done", 28.858994498, 341900], ["batch 172 done", 28.985292812, 340148],
                     ["batch 173 done", 29.12306041, 340148], ["batch 174 done", 29.260996275, 344036],
                     ["batch 175 done", 29.407141335, 344272], ["batch 176 done", 29.571920795, 344392],
                     ["batch 177 done", 29.723634819, 344420], ["batch 178 done", 29.861264454, 345040],
                     ["batch 179 done", 29.969034406, 345404], ["batch 180 done", 30.104511642, 345776],
                     ["batch 181 done", 30.233260528, 346288], ["batch 182 done", 30.366164159, 346288],
                     ["batch 183 done", 30.542775443, 346300], ["batch 184 done", 30.678695497, 346300],
                     ["batch 185 done", 30.811178192, 346300], ["batch 186 done", 30.945991129, 346424],
                     ["batch 187 done", 31.086127976, 346424], ["batch 188 done", 31.222740331, 346424],
                     ["batch 189 done", 31.379435757, 346424], ["batch 190 done", 31.514185742, 346456],
                     ["batch 191 done", 31.626249804, 346468], ["batch 192 done", 31.760594938, 346476],
                     ["batch 193 done", 31.889196123, 346600], ["batch 194 done", 32.029768586, 346600],
                     ["batch 195 done", 32.149264498, 344852], ["batch 196 done", 32.306304933, 344876],
                     ["batch 197 done", 32.461398049, 344876], ["batch 198 done", 32.632850199, 344876],
                     ["batch 199 done", 32.755304291, 344876], ["batch 200 done", 32.895441253, 345652],
                     ["batch 201 done", 33.049046785, 345444], ["batch 202 done", 33.1851851, 345832],
                     ["batch 203 done", 33.320323913, 346204], ["batch 204 done", 33.431783658, 346584],
                     ["batch 205 done", 33.584567071, 346820], ["batch 206 done", 33.73036497, 346820],
                     ["batch 207 done", 33.856130251, 347068], ["batch 208 done", 33.990695206, 347060],
                     ["batch 209 done", 34.129534587, 347320], ["batch 210 done", 34.257352338, 347320],
                     ["batch 211 done", 34.399700874, 347320], ["batch 212 done", 34.558151584, 347568],
                     ["batch 213 done", 34.733885904, 347320], ["batch 214 done", 34.881453076, 347576],
                     ["batch 215 done", 35.023097374, 347584], ["batch 216 done", 35.169520523, 347584],
                     ["batch 217 done", 35.329740521, 347576], ["batch 218 done", 35.482499064, 347584],
                     ["batch 219 done", 35.615845919, 347836], ["batch 220 done", 35.743300047, 347828],
                     ["batch 221 done", 35.861086195, 347836], ["batch 222 done", 36.003774931, 347836],
                     ["batch 223 done", 36.128269977, 348068], ["batch 224 done", 36.266949548, 348440],
                     ["batch 225 done", 36.436417261, 348812], ["batch 226 done", 36.57355501, 348952],
                     ["batch 227 done", 36.727303944, 347448], ["batch 228 done", 36.865331544, 347448],
                     ["batch 229 done", 37.033938367, 350948], ["batch 230 done", 37.175686107, 350960],
                     ["batch 231 done", 37.323814012, 351156], ["batch 232 done", 37.50062657, 351164],
                     ["batch 233 done", 37.667100555, 351156], ["batch 234 done", 37.809150183, 351212],
                     ["batch 235 done", 37.97156855, 351532], ["batch 236 done", 38.102577623, 351644],
                     ["batch 237 done", 38.220758657, 352072], ["batch 238 done", 38.401244451, 352104],
                     ["batch 239 done", 38.559510215, 352104], ["batch 240 done", 38.730323894, 352144],
                     ["batch 241 done", 38.864999517, 352144], ["batch 242 done", 39.048647705, 352296],
                     ["batch 243 done", 39.191231874, 352296], ["batch 244 done", 39.351743244, 352628],
                     ["batch 245 done", 39.545225865, 353024], ["batch 246 done", 39.704300667, 353384],
                     ["batch 247 done", 39.829706376, 353652], ["batch 248 done", 39.953430163, 353692],
                     ["batch 249 done", 40.091332062, 353948], ["batch 250 done", 40.221846987, 353948],
                     ["batch 251 done", 40.354376637, 353948], ["batch 252 done", 40.475531295, 353948],
                     ["batch 253 done", 40.610085952, 354028], ["batch 254 done", 40.732959168, 354324],
                     ["batch 255 done", 40.84370582, 354316], ["batch 256 done", 40.950547073, 354448],
                     ["batch 257 done", 41.133508966, 354472], ["batch 258 done", 41.384948219, 354472],
                     ["batch 259 done", 41.622683211, 354536], ["batch 260 done", 41.765969266, 354536],
                     ["batch 261 done", 41.897221928, 352792], ["batch 262 done", 42.018033687, 354540],
                     ["batch 263 done", 42.147864791, 352792], ["batch 264 done", 42.281215372, 352784],
                     ["batch 265 done", 42.407666139, 353408], ["batch 266 done", 42.559902032, 353780],
                     ["batch 267 done", 42.70277853, 354168], ["batch 268 done", 42.831615175, 354448],
                     ["batch 269 done", 42.981697204, 354444], ["batch 270 done", 43.104785654, 354468],
                     ["batch 271 done", 43.240956684, 354468], ["batch 272 done", 43.383723126, 354468],
                     ["batch 273 done", 43.530457605, 354468], ["batch 274 done", 43.648723584, 354488],
                     ["batch 275 done", 43.787440727, 354492], ["batch 276 done", 43.906086419, 354492],
                     ["batch 277 done", 44.058664357, 354948], ["batch 278 done", 44.19127956, 354984],
                     ["batch 279 done", 44.335731008, 354992], ["batch 280 done", 44.49064003, 355016],
                     ["batch 281 done", 44.636397375, 355016], ["batch 282 done", 44.77371081, 355264],
                     ["batch 283 done", 44.906624509, 355264], ["batch 284 done", 45.034825014, 355264],
                     ["batch 285 done", 45.19693568, 355360], ["batch 286 done", 45.326139789, 355736],
                     ["batch 287 done", 45.478394006, 356356], ["batch 288 done", 45.591875877, 356648],
                     ["batch 289 done", 45.741104002, 356648], ["batch 290 done", 45.894760083, 356648],
                     ["batch 291 done", 46.048173081, 358544], ["batch 292 done", 46.199928693, 358600],
                     ["batch 293 done", 46.337028338, 358804], ["batch 294 done", 46.469916117, 359052],
                     ["batch 295 done", 46.601554711, 359052], ["batch 296 done", 46.743302688, 359176],
                     ["batch 297 done", 46.869841277, 359176], ["batch 298 done", 47.02814431, 359176],
                     ["batch 299 done", 47.165704686, 359176], ["batch 300 done", 47.279569029, 359176],
                     ["batch 301 done", 47.419901442, 359168], ["batch 302 done", 47.558637481, 359348],
                     ["batch 303 done", 47.71726221, 359420], ["batch 304 done", 47.85446995, 359456],
                     ["batch 305 done", 47.99084943, 359460], ["batch 306 done", 48.127191612, 359528],
                     ["batch 307 done", 48.254029389, 359588], ["batch 308 done", 48.414898285, 359648],
                     ["batch 309 done", 48.533393438, 359712], ["batch 310 done", 48.694306363, 360044],
                     ["batch 311 done", 48.832654252, 360476], ["batch 312 done", 49.070977226, 360988],
                     ["batch 313 done", 49.342623052, 361048], ["batch 314 done", 49.502072827, 361112],
                     ["batch 315 done", 49.691870114, 361124], ["batch 316 done", 49.80390165, 361176],
                     ["batch 317 done", 49.93820384, 361308], ["batch 318 done", 50.106371084, 361432],
                     ["batch 319 done", 50.231245702, 361432], ["batch 320 done", 50.359936656, 361496],
                     ["batch 321 done", 50.488174617, 361496], ["batch 322 done", 50.617812714, 361556],
                     ["batch 323 done", 50.75420228, 361836], ["batch 324 done", 50.893401905, 361836],
                     ["batch 325 done", 51.039508708, 361836], ["batch 326 done", 51.167192632, 361836],
                     ["batch 327 done", 51.304846418, 361960], ["batch 328 done", 51.437687037, 361960],
                     ["batch 329 done", 51.583385182, 362172], ["batch 330 done", 51.728837484, 362252],
                     ["batch 331 done", 51.88243494, 362620], ["batch 332 done", 52.026672319, 363128],
                     ["batch 333 done", 52.157250551, 363524], ["batch 334 done", 52.272260286, 363600],
                     ["batch 335 done", 52.41148716, 363604], ["batch 336 done", 52.558294244, 363724],
                     ["batch 337 done", 52.680298376, 363740], ["batch 338 done", 52.801018539, 363804],
                     ["batch 339 done", 52.926665256, 363864], ["batch 340 done", 53.055876133, 363928],
                     ["batch 341 done", 53.216309686, 363992], ["batch 342 done", 53.434955984, 363996],
                     ["batch 343 done", 53.530217239, 364052], ["batch 344 done", 53.630679759, 364116],
                     ["batch 345 done", 53.778296296, 364152], ["batch 346 done", 53.941670964, 364204],
                     ["batch 347 done", 54.081103689, 364324], ["batch 348 done", 54.209027667, 364512],
                     ["batch 349 done", 54.361657636, 364628], ["batch 350 done", 54.475262352, 364644],
                     ["batch 351 done", 54.607049328, 364840], ["batch 352 done", 54.74003297, 365344],
                     ["batch 353 done", 54.858751583, 365732], ["batch 354 done", 54.99495432, 365888],
                     ["batch 355 done", 55.159411645, 365892], ["batch 356 done", 55.334616634, 366108],
                     ["batch 357 done", 55.468223377, 366224], ["batch 358 done", 55.611867356, 366292],
                     ["batch 359 done", 55.756478962, 366300], ["batch 360 done", 55.9050089, 366416],
                     ["batch 361 done", 56.039565213, 366416], ["batch 362 done", 56.166221363, 366484],
                     ["batch 363 done", 56.306927406, 366560], ["batch 364 done", 56.46923825, 366648],
                     ["batch 365 done", 56.610031408, 366712], ["batch 366 done", 56.746540635, 366712],
                     ["batch 367 done", 56.879401082, 366848], ["batch 368 done", 57.019368754, 366864],
                     ["batch 369 done", 57.154074896, 366928], ["batch 370 done", 57.27754803, 366988],
                     ["batch 371 done", 57.414439848, 367012], ["batch 372 done", 57.53151054, 367412],
                     ["batch 373 done", 57.649937751, 367844], ["batch 374 done", 57.803560669, 368292],
                     ["batch 375 done", 57.958488091, 368372], ["batch 376 done", 58.081720209, 368392],
                     ["batch 377 done", 58.207789321999996, 368520], ["batch 378 done", 58.378247167, 368600],
                     ["batch 379 done", 58.51419665, 368976], ["batch 380 done", 58.645087091, 368992],
                     ["batch 381 done", 58.788646858, 368984], ["batch 382 done", 58.944147606, 369036],
                     ["batch 383 done", 59.128214623, 369076], ["batch 384 done", 59.283531424, 369320],
                     ["batch 385 done", 59.422405979, 369320], ["batch 386 done", 59.572750562, 369320],
                     ["batch 387 done", 59.707398922, 369320], ["batch 388 done", 59.844251167, 369320],
                     ["batch 389 done", 60.116792767, 369340], ["batch 390 done", 60.355310599, 369576],
                     ["batch 391 done", 60.52022, 369576], ["batch 392 done", 60.647178172, 369576],
                     ["batch 393 done", 60.77584779, 369576], ["batch 394 done", 60.883365723, 369580],
                     ["batch 395 done", 61.040180884, 369704], ["batch 396 done", 61.16444314, 369992],
                     ["batch 397 done", 61.309917569, 370424], ["batch 398 done", 61.460279304, 370796],
                     ["batch 399 done", 61.584175809, 370948], ["batch 400 done", 61.744508936, 371008],
                     ["batch 401 done", 61.897175351, 371188], ["batch 402 done", 62.068144322, 371196],
                     ["batch 403 done", 62.205640756, 371324], ["batch 404 done", 62.332893958, 371620],
                     ["batch 405 done", 62.471899581, 371620], ["batch 406 done", 62.616120144, 371620],
                     ["batch 407 done", 62.75259538, 371640], ["batch 408 done", 62.878809151, 371704],
                     ["batch 409 done", 63.020183287, 371892], ["batch 410 done", 63.171383163, 371992],
                     ["batch 411 done", 63.311361864, 372008], ["batch 412 done", 63.480173519, 372044],
                     ["batch 413 done", 63.631524383, 372428], ["batch 414 done", 63.761928124, 372680],
                     ["batch 415 done", 63.893568395, 372680], ["batch 416 done", 64.048857441, 372680],
                     ["batch 417 done", 64.161779763, 373024], ["batch 418 done", 64.293801074, 373384],
                     ["batch 419 done", 64.428270132, 373756], ["batch 420 done", 64.581307229, 373820],
                     ["batch 421 done", 64.712769011, 373820], ["batch 422 done", 64.839537609, 373824],
                     ["batch 423 done", 64.981857097, 373824], ["batch 424 done", 65.119973219, 373852],
                     ["batch 425 done", 65.287706935, 373912], ["batch 426 done", 65.436089602, 374068],
                     ["batch 427 done", 65.572694522, 374148], ["batch 428 done", 65.778214906, 374212],
                     ["batch 429 done", 66.011485022, 374272], ["batch 430 done", 66.214786737, 374356],
                     ["batch 431 done", 66.503862335, 374356], ["batch 432 done", 66.699297333, 374420],
                     ["batch 433 done", 66.914189147, 374480], ["batch 434 done", 67.091832107, 374604],
                     ["batch 435 done", 67.244889462, 374608], ["batch 436 done", 67.389295477, 374664],
                     ["batch 437 done", 67.511581091, 374732], ["batch 438 done", 67.633265264, 375168],
                     ["batch 439 done", 67.771223361, 375596], ["batch 440 done", 67.905435368, 376196],
                     ["batch 441 done", 68.060266977, 376196], ["batch 442 done", 68.183888935, 376296],
                     ["batch 443 done", 68.358041078, 376424], ["batch 444 done", 68.52054444, 376424],
                     ["batch 445 done", 68.654384663, 376424], ["batch 446 done", 68.777141884, 376424],
                     ["batch 447 done", 68.93141163, 376548], ["batch 448 done", 69.08201016, 376548],
                     ["batch 449 done", 69.200713329, 376672], ["batch 450 done", 69.350591527, 376672],
                     ["batch 451 done", 69.508170851, 376880], ["batch 452 done", 69.63303249, 376904],
                     ["batch 453 done", 69.745058871, 376988], ["batch 454 done", 69.973640798, 376988],
                     ["batch 455 done", 70.145304459, 377052], ["batch 456 done", 70.402094491, 377116],
                     ["batch 457 done", 70.613206144, 377240], ["batch 458 done", 70.744112575, 377432],
                     ["batch 459 done", 70.900933512, 377824], ["batch 460 done", 71.054806811, 378324],
                     ["batch 461 done", 71.185879904, 378560], ["batch 462 done", 71.309077322, 378560],
                     ["batch 463 done", 71.445413252, 378688], ["batch 464 done", 71.596410209, 378692],
                     ["batch 465 done", 71.729477575, 378692], ["batch 466 done", 71.85684918, 378816],
                     ["batch 467 done", 72.00605995, 378816], ["batch 468 done", 72.162900454, 378876],
                     ["batch 469 done", 72.313084766, 378876], ["batch 470 done", 72.444851516, 378940],
                     ["batch 471 done", 72.598845379, 379004], ["batch 472 done", 72.730045359, 379252],
                     ["batch 473 done", 72.848602744, 379404], ["batch 474 done", 72.988425183, 379412],
                     ["batch 475 done", 73.142927524, 379540], ["batch 476 done", 73.279088809, 379548],
                     ["batch 477 done", 73.432186401, 379756], ["batch 478 done", 73.590959492, 379760],
                     ["batch 479 done", 73.714811919, 379808], ["batch 480 done", 73.838062693, 379936],
                     ["batch 481 done", 73.957314088, 379952], ["batch 482 done", 74.112109786, 380120],
                     ["batch 483 done", 74.236106117, 380488], ["batch 484 done", 74.372219373, 380884],
                     ["batch 485 done", 74.506643327, 381176], ["batch 486 done", 74.640605118, 381240],
                     ["batch 487 done", 74.778559772, 381304], ["batch 488 done", 74.923795497, 381420],
                     ["batch 489 done", 75.049135837, 381428], ["batch 490 done", 75.197980677, 381480],
                     ["batch 491 done", 75.366120609, 381540], ["batch 492 done", 75.498532186, 381604],
                     ["batch 493 done", 75.628650742, 381672], ["batch 494 done", 75.839326864, 381684],
                     ["batch 495 done", 75.991381071, 382060], ["batch 496 done", 76.195111806, 382064],
                     ["batch 497 done", 76.425422812, 382064], ["batch 498 done", 76.628601642, 382320],
                     ["batch 499 done", 76.856561315, 382328], ["batch 500 done", 76.997706133, 382520],
                     ["batch 501 done", 77.227587489, 382524], ["batch 502 done", 77.481223056, 382528],
                     ["batch 503 done", 77.661575458, 382860], ["batch 504 done", 77.850865153, 383244],
                     ["batch 505 done", 78.013941829, 383624], ["batch 506 done", 78.241681621, 383648],
                     ["batch 507 done", 78.451128058, 383688], ["batch 508 done", 78.565433695, 383688],
                     ["batch 509 done", 78.666448874, 383688], ["batch 510 done", 78.780495963, 383692],
                     ["batch 511 done", 78.906796615, 383748], ["batch 512 done", 79.0052985, 383872],
                     ["batch 513 done", 79.121738162, 383900], ["batch 514 done", 79.232535386, 383960],
                     ["batch 515 done", 79.360990957, 383968], ["batch 516 done", 79.481129085, 384024],
                     ["batch 517 done", 79.59100974, 384148], ["batch 518 done", 79.754271569, 384148],
                     ["batch 519 done", 79.94020355, 384208], ["batch 520 done", 80.138370974, 384228],
                     ["batch 521 done", 80.393581437, 384276], ["batch 522 done", 80.495868307, 384588],
                     ["batch 523 done", 80.733405312, 384808], ["batch 524 done", 80.933222166, 385308],
                     ["batch 525 done", 81.277377486, 385880], ["batch 526 done", 81.468840728, 386052],
                     ["batch 527 done", 81.658395724, 386052], ["batch 528 done", 81.811793568, 386052],
                     ["batch 529 done", 81.9143348, 386176], ["batch 530 done", 82.065458126, 386176],
                     ["batch 531 done", 82.207392399, 386236], ["batch 532 done", 82.332631191, 386260],
                     ["batch 533 done", 82.446175206, 386332], ["batch 534 done", 82.571446744, 386344],
                     ["batch 535 done", 82.676959888, 386404], ["batch 536 done", 82.791071141, 386528],
                     ["batch 537 done", 82.885420281, 386568], ["batch 538 done", 82.982416111, 386912],
                     ["batch 539 done", 83.120953743, 386916], ["batch 540 done", 83.237909412, 386936],
                     ["batch 541 done", 83.398371629, 386936], ["batch 542 done", 83.518348108, 387124],
                     ["batch 543 done", 83.645792452, 387144], ["batch 544 done", 83.751161672, 387504],
                     ["batch 545 done", 84.006836499, 387900], ["batch 546 done", 84.121158309, 388392],
                     ["batch 547 done", 84.239583348, 388640], ["batch 548 done", 84.388976146, 388644],
                     ["batch 549 done", 84.507803962, 388648], ["batch 550 done", 84.626495712, 388652],
                     ["batch 551 done", 84.741433976, 388656], ["batch 552 done", 84.860841479, 388648],
                     ["batch 553 done", 84.983489997, 388660], ["batch 554 done", 85.108653288, 388660],
                     ["batch 555 done", 85.228858422, 388704], ["batch 556 done", 85.3647307, 388704],
                     ["batch 557 done", 85.482920381, 388768], ["batch 558 done", 85.604028245, 388888],
                     ["batch 559 done", 85.739923227, 388888], ["batch 560 done", 85.85088436, 389008],
                     ["batch 561 done", 85.972881293, 389008], ["batch 562 done", 86.095820585, 389068],
                     ["batch 563 done", 86.198493539, 389128], ["batch 564 done", 86.36023234, 389128],
                     ["batch 565 done", 86.487131768, 389180], ["batch 566 done", 86.619932104, 389244],
                     ["batch 567 done", 86.726623644, 389600], ["batch 568 done", 86.852131427, 390076],
                     ["batch 569 done", 86.948184722, 390536], ["batch 570 done", 87.062513712, 390940],
                     ["batch 571 done", 87.164399172, 390992], ["batch 572 done", 87.291327147, 391056],
                     ["batch 573 done", 87.423459095, 391060], ["batch 574 done", 87.552143684, 391112],
                     ["batch 575 done", 87.677359804, 391168], ["batch 576 done", 87.785592936, 391240],
                     ["batch 577 done", 87.907984708, 391300], ["batch 578 done", 88.017210566, 391312],
                     ["batch 579 done", 88.148559146, 391436], ["batch 580 done", 88.264432454, 391440],
                     ["batch 581 done", 88.397451308, 391556], ["batch 582 done", 88.515093236, 391624],
                     ["batch 583 done", 88.615140659, 391684], ["batch 584 done", 88.732969332, 391684],
                     ["batch 585 done", 88.846789783, 391676], ["batch 586 done", 88.960083811, 391824],
                     ["batch 587 done", 89.099990888, 391884], ["batch 588 done", 89.194186121, 392220],
                     ["batch 589 done", 89.333616415, 392668], ["batch 590 done", 89.460001774, 393052],
                     ["batch 591 done", 89.592160062, 393236], ["batch 592 done", 89.694944233, 393236],
                     ["batch 593 done", 89.799857167, 393484], ["batch 594 done", 89.902299248, 393620],
                     ["batch 595 done", 90.007121895, 393636], ["batch 596 done", 90.135820426, 393644],
                     ["batch 597 done", 90.262139249, 393644], ["batch 598 done", 90.407773387, 393644],
                     ["batch 599 done", 90.516010336, 393644], ["batch 600 done", 90.631637346, 393708],
                     ["batch 601 done", 90.727480092, 393828], ["batch 602 done", 90.82935717, 393828],
                     ["batch 603 done", 90.931346793, 393952], ["batch 604 done", 91.03874548, 393956],
                     ["batch 605 done", 91.171386614, 394076], ["batch 606 done", 91.297516113, 394204],
                     ["batch 607 done", 91.42536501, 394204], ["batch 608 done", 91.535438768, 394556],
                     ["batch 609 done", 91.651104479, 394960], ["batch 610 done", 91.765724218, 395332],
                     ["batch 611 done", 91.881685535, 395592], ["batch 612 done", 92.00095513, 395844],
                     ["batch 613 done", 92.126838804, 395876], ["batch 614 done", 92.226190073, 395924],
                     ["batch 615 done", 92.367858212, 396048], ["batch 616 done", 92.474718208, 396060],
                     ["batch 617 done", 92.594607711, 396184], ["batch 618 done", 92.704553726, 396184],
                     ["batch 619 done", 92.825478652, 396184], ["batch 620 done", 92.917446916, 396308],
                     ["batch 621 done", 93.033864963, 396308], ["batch 622 done", 93.146108837, 396316],
                     ["batch 623 done", 93.310386871, 396424], ["batch 624 done", 93.464354752, 396416],
                     ["batch 625 done", 93.595337446, 396524], ["batch 626 done", 93.724592451, 396576],
                     ["batch 627 done", 93.85910566, 396588], ["batch 628 done", 93.973788089, 396716],
                     ["batch 629 done", 94.114125773, 397084], ["batch 630 done", 94.211354861, 397464],
                     ["batch 631 done", 94.365855932, 397900], ["batch 632 done", 94.487532074, 398020],
                     ["batch 633 done", 94.609984055, 398088], ["batch 634 done", 94.72537097, 398088],
                     ["batch 635 done", 94.849832214, 398204], ["batch 636 done", 94.973231562, 398212],
                     ["batch 637 done", 95.110401561, 398276], ["batch 638 done", 95.263467373, 398340],
                     ["batch 639 done", 95.394030566, 398400], ["batch 640 done", 95.52657651, 398404],
                     ["batch 641 done", 95.634958869, 398408], ["batch 642 done", 95.783843481, 398464],
                     ["batch 643 done", 95.913909293, 398504], ["batch 644 done", 96.063718984, 398552],
                     ["batch 645 done", 96.184123838, 398624], ["batch 646 done", 96.322021481, 398684],
                     ["batch 647 done", 96.43824789, 398752], ["batch 648 done", 96.562548961, 398828],
                     ["batch 649 done", 96.668186612, 398828], ["batch 650 done", 96.774084831, 398892],
                     ["batch 651 done", 96.922331167, 399016], ["batch 652 done", 97.031791373, 399056],
                     ["batch 653 done", 97.150176684, 399520], ["batch 654 done", 97.263607275, 399888],
                     ["batch 655 done", 97.394436862, 400312], ["batch 656 done", 97.513469855, 400788],
                     ["batch 657 done", 97.634779457, 400844], ["batch 658 done", 97.739212167, 400996],
                     ["batch 659 done", 97.869166628, 401004], ["batch 660 done", 97.994190603, 401068],
                     ["batch 661 done", 98.122153437, 401068], ["batch 662 done", 98.255395814, 401140],
                     ["batch 663 done", 98.414663812, 401264], ["batch 664 done", 98.519699397, 401264],
                     ["batch 665 done", 98.68811363, 401344], ["batch 666 done", 98.79427653, 401352],
                     ["batch 667 done", 98.92788806, 401400], ["batch 668 done", 99.043352419, 401464],
                     ["batch 669 done", 99.163356724, 401532], ["batch 670 done", 99.284479665, 401596],
                     ["batch 671 done", 99.423982416, 401656], ["batch 672 done", 99.555974827, 401656],
                     ["batch 673 done", 99.648627063, 401940], ["batch 674 done", 99.755978815, 402380],
                     ["batch 675 done", 99.861756698, 402812], ["batch 676 done", 99.991497418, 402992],
                     ["batch 677 done", 100.121245979, 403048], ["batch 678 done", 100.248044053, 403112],
                     ["batch 679 done", 100.391966049, 403176], ["batch 680 done", 100.512167753, 403240],
                     ["batch 681 done", 100.65547063, 403304], ["batch 682 done", 100.789736758, 403312],
                     ["batch 683 done", 101.036691841, 403436], ["batch 684 done", 101.181554177, 403436],
                     ["batch 685 done", 101.29952446, 403500], ["batch 686 done", 101.452654926, 403564],
                     ["batch 687 done", 101.572839831, 403624], ["batch 688 done", 101.692866526, 403688],
                     ["batch 689 done", 101.818451216, 403696], ["batch 690 done", 101.929114797, 403820],
                     ["batch 691 done", 102.041956756, 403884], ["batch 692 done", 102.177002699, 403944],
                     ["batch 693 done", 102.309953551, 403996], ["batch 694 done", 102.448930072, 404624],
                     ["batch 695 done", 102.686433341, 405056], ["batch 696 done", 102.808039766, 405448],
                     ["batch 697 done", 102.927234334, 405536], ["batch 698 done", 103.056176371, 405536],
                     ["batch 699 done", 103.167808619, 405660], ["batch 700 done", 103.286605441, 405720],
                     ["batch 701 done", 103.43030898, 405784], ["batch 702 done", 103.547592691, 405784],
                     ["batch 703 done", 103.679691847, 405796], ["batch 704 done", 103.786511628, 405876],
                     ["batch 705 done", 103.933242929, 405948], ["batch 706 done", 104.077082204, 406200],
                     ["batch 707 done", 104.189927859, 406332], ["batch 708 done", 104.341592552, 406380],
                     ["batch 709 done", 104.48927007, 406416], ["batch 710 done", 104.619108843, 406532],
                     ["batch 711 done", 104.732736524, 406540], ["batch 712 done", 104.833003401, 406540],
                     ["batch 713 done", 104.939039508, 406612], ["batch 714 done", 105.094794953, 406824],
                     ["batch 715 done", 105.21923426, 407196], ["batch 716 done", 105.355190408, 407572],
                     ["batch 717 done", 105.500120536, 407808], ["batch 718 done", 105.633238908, 407896],
                     ["batch 719 done", 105.757996259, 407956], ["batch 720 done", 105.887384905, 408008],
                     ["batch 721 done", 106.008184498, 408008], ["batch 722 done", 106.157855879, 408076],
                     ["batch 723 done", 106.332503071, 408300], ["batch 724 done", 106.472909946, 408356],
                     ["batch 725 done", 106.588293156, 408412], ["batch 726 done", 106.712756236, 408472],
                     ["batch 727 done", 106.831184306, 408568], ["batch 728 done", 106.964733144, 408624],
                     ["batch 729 done", 107.116861867, 408624], ["batch 730 done", 107.235893609, 408748],
                     ["batch 731 done", 107.377796693, 408808], ["batch 732 done", 107.517983766, 408904],
                     ["batch 733 done", 107.633271339, 408904], ["batch 734 done", 107.754653965, 408968],
                     ["batch 735 done", 107.890701729, 408968], ["batch 736 done", 108.024547921, 409028],
                     ["batch 737 done", 108.164563908, 409088], ["batch 738 done", 108.353097095, 409328],
                     ["batch 739 done", 108.489082172, 409784], ["batch 740 done", 108.613179066, 410216],
                     ["batch 741 done", 108.741569146, 410396], ["batch 742 done", 108.849506026, 410456],
                     ["batch 743 done", 108.993455077, 410524], ["batch 744 done", 109.128314846, 410588],
                     ["batch 745 done", 109.288697579, 410648], ["batch 746 done", 109.445625446, 410720],
                     ["batch 747 done", 109.587777348, 410720], ["batch 748 done", 109.705949451, 410776],
                     ["batch 749 done", 109.833482081, 410844], ["batch 750 done", 109.953276803, 410860],
                     ["batch 751 done", 110.075186352, 410916], ["batch 752 done", 110.210353142, 411044],
                     ["batch 753 done", 110.353592772, 411044], ["batch 754 done", 110.469324359, 411100],
                     ["batch 755 done", 110.585857651, 411124], ["batch 756 done", 110.715591261, 411344],
                     ["batch 757 done", 110.815658097, 411440], ["batch 758 done", 110.947370203, 411584],
                     ["batch 759 done", 111.068561956, 412056], ["batch 760 done", 111.192777196, 412416],
                     ["batch 761 done", 111.366292147, 412880], ["batch 762 done", 111.482453509, 413000],
                     ["batch 763 done", 111.609049167, 413044], ["batch 764 done", 111.737084823, 413064],
                     ["batch 765 done", 111.847267326, 413124], ["batch 766 done", 111.985871459, 413212],
                     ["batch 767 done", 112.143537432, 413328], ["batch 768 done", 112.326928672, 413400],
                     ["batch 769 done", 112.462241298, 413400], ["batch 770 done", 112.618906147, 413460],
                     ["batch 771 done", 112.761572319, 413460], ["batch 772 done", 112.891012703, 413520],
                     ["batch 773 done", 113.031270334, 413520], ["batch 774 done", 113.187391093, 413584],
                     ["batch 775 done", 113.349431127, 413704], ["batch 776 done", 113.446555155, 413784],
                     ["batch 777 done", 113.583906793, 413844], ["batch 778 done", 113.703243866, 413912],
                     ["batch 779 done", 113.830569, 414008], ["batch 780 done", 113.9447266, 414432],
                     ["batch 781 done", 114.067939703, 414848], ["batch 782 done", 114.19655625, 415132],
                     ["batch 783 done", 114.349637461, 415268], ["batch 784 done", 114.458590127, 415444],
                     ["batch 785 done", 114.603953373, 415528], ["batch 786 done", 114.721655983, 415532],
                     ["batch 787 done", 114.831239355, 415536], ["batch 788 done", 114.94360104, 415596],
                     ["batch 789 done", 115.054443872, 415668], ["batch 790 done", 115.168650371, 415732],
                     ["batch 791 done", 115.320366023, 415800], ["batch 792 done", 115.458228749, 415864],
                     ["batch 793 done", 115.578687196, 415864], ["batch 794 done", 115.676008872, 415992],
                     ["batch 795 done", 115.794931582, 415992], ["batch 796 done", 115.90328912, 416072],
                     ["batch 797 done", 116.011123365, 416140], ["batch 798 done", 116.137835373, 416332],
                     ["batch 799 done", 116.25293945, 416336], ["batch 800 done", 116.392495481, 416640],
                     ["batch 801 done", 116.512855298, 417004], ["batch 802 done", 116.644601852, 417448],
                     ["batch 803 done", 116.774461423, 417532], ["batch 804 done", 116.906304256, 417588],
                     ["batch 805 done", 117.036723001, 417660], ["batch 806 done", 117.187957623, 417676],
                     ["batch 807 done", 117.343747342, 417744], ["batch 808 done", 117.48778085, 417808],
                     ["batch 809 done", 117.617324001, 417936], ["batch 810 done", 117.748829981, 417996],
                     ["batch 811 done", 117.878145477, 418004], ["batch 812 done", 117.995344222, 418004],
                     ["batch 813 done", 118.112808593, 418052], ["batch 814 done", 118.249141481, 418128],
                     ["batch 815 done", 118.390556888, 418212], ["batch 816 done", 118.537623658, 418216],
                     ["batch 817 done", 118.699922469, 418276], ["batch 818 done", 118.817942925, 418340],
                     ["batch 819 done", 118.954008653, 418412], ["batch 820 done", 119.070322761, 418468],
                     ["batch 821 done", 119.205118891, 418468], ["batch 822 done", 119.35159629, 418516],
                     ["batch 823 done", 119.646218103, 418832], ["batch 824 done", 119.841931423, 419244],
                     ["batch 825 done", 119.956636673, 419728], ["batch 826 done", 120.070575175, 420100],
                     ["batch 827 done", 120.1980696, 420212], ["batch 828 done", 120.34672383, 420276],
                     ["batch 829 done", 120.474530257, 420320], ["batch 830 done", 120.600925703, 420400],
                     ["batch 831 done", 120.698667603, 420392], ["batch 832 done", 120.808122869, 420460],
                     ["batch 833 done", 120.926793547, 420532], ["batch 834 done", 121.049485171, 420596],
                     ["batch 835 done", 121.194892102, 420668], ["batch 836 done", 121.367037854, 420676],
                     ["batch 837 done", 121.50191795, 420752], ["batch 838 done", 121.633885233, 420812],
                     ["batch 839 done", 121.74384285, 420860], ["batch 840 done", 121.868006247, 420944],
                     ["batch 841 done", 122.005346968, 421008], ["batch 842 done", 122.104538513, 421068],
                     ["batch 843 done", 122.217758696, 421132], ["batch 844 done", 122.406418968, 421252],
                     ["batch 845 done", 122.553094745, 421616], ["batch 846 done", 122.68261288, 421996],
                     ["batch 847 done", 122.830206612, 422396], ["batch 848 done", 122.955145635, 422464],
                     ["batch 849 done", 123.106314098, 422596], ["batch 850 done", 123.233927782, 422596],
                     ["batch 851 done", 123.383815677, 422656], ["batch 852 done", 123.504909691, 422648],
                     ["batch 853 done", 123.626062793, 422720], ["batch 854 done", 123.752570865, 422784],
                     ["batch 855 done", 123.894787859, 422844], ["batch 856 done", 124.019220602, 422908],
                     ["batch 857 done", 124.15028661, 422904], ["batch 858 done", 124.280845017, 422968],
                     ["batch 859 done", 124.428508999, 423032], ["batch 860 done", 124.555272853, 423088],
                     ["batch 861 done", 124.687993926, 423152], ["batch 862 done", 124.81821304, 423220],
                     ["batch 863 done", 124.950336825, 423220], ["batch 864 done", 125.08579066, 423344],
                     ["batch 865 done", 125.212964214, 423476], ["batch 866 done", 125.35965259, 423904],
                     ["batch 867 done", 125.491397398, 424276], ["batch 868 done", 125.645222596, 424600],
                     ["batch 869 done", 125.76049067, 424852], ["batch 870 done", 125.899134886, 424856],
                     ["batch 871 done", 126.034245144, 424924], ["batch 872 done", 126.174643281, 424928],
                     ["batch 873 done", 126.332075946, 424928], ["batch 874 done", 126.469413365, 424928],
                     ["batch 875 done", 126.606653977, 425000], ["batch 876 done", 126.739738787, 425264],
                     ["batch 877 done", 126.860494437, 425400], ["batch 878 done", 126.988315674, 425404],
                     ["batch 879 done", 127.148555075, 425496], ["batch 880 done", 127.303575883, 425520],
                     ["batch 881 done", 127.455451294, 425528], ["batch 882 done", 127.597061012, 425528],
                     ["batch 883 done", 127.720668343, 425652], ["batch 884 done", 127.833697232, 425652],
                     ["batch 885 done", 127.956391579, 425772], ["batch 886 done", 128.103341098, 426036],
                     ["batch 887 done", 128.280306129, 426392], ["batch 888 done", 128.426858598, 426744],
                     ["batch 889 done", 128.557347131, 426892], ["batch 890 done", 128.692649494, 426960],
                     ["batch 891 done", 128.830359099, 427080], ["batch 892 done", 128.96487323, 427084],
                     ["batch 893 done", 129.10430331, 427084], ["batch 894 done", 129.257534047, 427144],
                     ["batch 895 done", 129.432477053, 427264], ["batch 896 done", 129.570018279, 427264],
                     ["batch 897 done", 129.706656067, 427324], ["batch 898 done", 129.843002561, 427388],
                     ["batch 899 done", 129.957002099, 427440], ["batch 900 done", 130.111680284, 427448],
                     ["batch 901 done", 130.254763855, 427564], ["batch 902 done", 130.418488533, 427572],
                     ["batch 903 done", 130.557085056, 427580], ["batch 904 done", 130.685120591, 427704],
                     ["batch 905 done", 130.812346639, 427828], ["batch 906 done", 130.954403798, 427956],
                     ["batch 907 done", 131.107370168, 427960], ["batch 908 done", 131.239986392, 427952],
                     ["batch 909 done", 131.386348839, 428044], ["batch 910 done", 131.512464375, 428248],
                     ["batch 911 done", 131.645015311, 428620], ["batch 912 done", 131.782718298, 428988],
                     ["batch 913 done", 131.913117299, 429224], ["batch 914 done", 132.042455319, 429284],
                     ["batch 915 done", 132.196279958, 429412], ["batch 916 done", 132.34784227, 429652],
                     ["batch 917 done", 132.519925141, 429780], ["batch 918 done", 132.656769541, 429784],
                     ["batch 919 done", 132.772814247, 429788], ["batch 920 done", 132.898396736, 429792],
                     ["batch 921 done", 133.034877072, 429792], ["batch 922 done", 133.208648744, 429792],
                     ["batch 923 done", 133.363842911, 429792], ["batch 924 done", 133.478423232, 429824],
                     ["batch 925 done", 133.608965501, 429880], ["batch 926 done", 133.75422766, 429940],
                     ["batch 927 done", 133.877112658, 430000], ["batch 928 done", 134.02700573, 430000],
                     ["batch 929 done", 134.17618166, 430048], ["batch 930 done", 134.32544292, 430056],
                     ["batch 931 done", 134.4644559, 430500], ["batch 932 done", 134.623885615, 430864],
                     ["batch 933 done", 134.773565154, 431320], ["batch 934 done", 134.896322152, 431444],
                     ["batch 935 done", 135.034860232, 431504], ["batch 936 done", 135.170828251, 431564],
                     ["batch 937 done", 135.363210281, 431640], ["batch 938 done", 135.51301288, 431700],
                     ["batch 939 done", 135.636004726, 431700], ["batch 940 done", 135.777331409, 431700],
                     ["batch 941 done", 135.938375512, 431824], ["batch 942 done", 136.076000109, 431824],
                     ["batch 943 done", 136.224824144, 431884], ["batch 944 done", 136.367152128, 431892],
                     ["batch 945 done", 136.493071339, 432008], ["batch 946 done", 136.651969415, 432076],
                     ["batch 947 done", 136.772681033, 432200], ["batch 948 done", 136.898663666, 432208],
                     ["batch 949 done", 137.032753601, 432208], ["batch 950 done", 137.202272633, 432232],
                     ["batch 951 done", 137.373535133, 432316], ["batch 952 done", 137.516348743, 432808],
                     ["batch 953 done", 137.661317206, 433164], ["batch 954 done", 137.804745052, 433600],
                     ["batch 955 done", 137.926975515, 433600], ["batch 956 done", 138.05124099, 433728],
                     ["batch 957 done", 138.208123168, 433976], ["batch 958 done", 138.361450245, 433984],
                     ["batch 959 done", 138.525806266, 433988], ["batch 960 done", 138.661937606, 433988],
                     ["batch 961 done", 138.79780846, 434084], ["batch 962 done", 138.934515769, 434084],
                     ["batch 963 done", 139.071526335, 434076], ["batch 964 done", 139.211160806, 434144],
                     ["batch 965 done", 139.367688349, 434204], ["batch 966 done", 139.495951552, 434264],
                     ["batch 967 done", 139.639724055, 434264], ["batch 968 done", 139.768245526, 434328],
                     ["batch 969 done", 139.897081933, 435360], ["batch 970 done", 140.035583328, 435528],
                     ["batch 971 done", 140.18894229, 435656], ["batch 972 done", 140.357316038, 435976],
                     ["batch 973 done", 140.47833678, 436432], ["batch 974 done", 140.608319857, 436912],
                     ["batch 975 done", 140.728348506, 437096], ["batch 976 done", 140.839160496, 437160],
                     ["batch 977 done", 140.967213938, 437200], ["batch 978 done", 141.100433911, 437256],
                     ["batch 979 done", 141.234112988, 437324], ["batch 980 done", 141.35820107, 437376],
                     ["batch 981 done", 141.481580505, 437500], ["batch 982 done", 141.599792821, 437492],
                     ["batch 983 done", 141.707577991, 437512], ["batch 984 done", 141.83414005, 437640],
                     ["batch 985 done", 141.961112424, 437644], ["batch 986 done", 142.091428925, 437708],
                     ["batch 987 done", 142.274767733, 437760], ["batch 988 done", 142.437914404, 437844],
                     ["batch 989 done", 142.551741761, 437984], ["batch 990 done", 142.696184123, 438364],
                     ["batch 991 done", 142.819111847, 438368], ["batch 992 done", 142.933728356, 438808],
                     ["batch 993 done", 143.068335338, 438816], ["batch 994 done", 143.197830499, 438852],
                     ["batch 995 done", 143.383237683, 438852], ["batch 996 done", 143.505240743, 439028],
                     ["batch 997 done", 143.62293317, 439396], ["batch 998 done", 143.723940902, 439772],
                     ["batch 999 done", 143.847203456, 439968], ["batch 1000 done", 143.972792001, 439968],
                     ["all batch done", 144.002883534, 439968]],

}


# Helper function for formatting the y-axis
def mb_formatter(x, pos):
    return '{:.1f} MB'.format(x)


# Set up the plot
fig, ax = plt.subplots(figsize=(10, 6))

# Define colors for different lines
colors = ['blue', 'green', 'red', 'purple']
# Define line styles for different lines
line_styles = ['-', '--', '-.', ':']

# Plot each configuration
for (label, data), color, line_style in zip(memory_log.items(), colors, line_styles):
    # Convert memory usage to MB
    timestamps = [x[1] for x in data]
    memory_usage = [x[2] / 1024 for x in data]  # Convert KB to MB

    # Plot monitoring points
    monitoring_timestamps = [x[1] for x in data]
    monitoring_memory_usage = [x[2] / 1024 for x in data]
    ax.plot(monitoring_timestamps, monitoring_memory_usage, label=label, color=color, linestyle=line_style, marker='o')

    # # Plot "After batch" points
    # batch_timestamps = [x[1] for x in data if x[0].startswith("After batch")]
    # batch_memory_usage = [x[2] / 1024 for x in data if x[0].startswith("After batch")]
    # ax.scatter(batch_timestamps, batch_memory_usage, color=color, s=100, edgecolors='black', zorder=5)

# Formatting the y-axis
ax.yaxis.set_major_formatter(FuncFormatter(mb_formatter))

# Adding labels and title
ax.set_xlabel('Time (s)', fontsize=14)
ax.set_ylabel('Memory Usage (MB)', fontsize=14)
ax.set_title('Memory Usage Over Time', fontsize=16)
ax.grid(True, linestyle='--', linewidth=0.5)

# Show legend
ax.legend()

# Display the plot
plt.tight_layout()
# plt.show()

# Save the plot
print(f"saving to ./internal/ml/model_slicing/exp_imgs/micro_memory.pdf")
fig.savefig(f"./internal/ml/model_slicing/exp_imgs/micro_memory.pdf", bbox_inches='tight')
