import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter

# Sample data, replace this with your actual data
# memory_log = {
#     "with all opt": [[0.012600245, 18748], [1.043574622, 181904], [2.880909715, 439356], [4.746978433, 450032],
#                      [6.580087388, 454812], [8.395959081, 461368], [10.229162885, 466332], [12.037321584, 470420],
#                      [13.867830914, 479540], [15.682375319, 481492], [17.114590375, 489424], [18.88665319, 487128],
#                      [20.715824796, 493432], [22.523327161, 498308], [24.340567323, 510192], [26.164078111, 509144],
#                      [27.992991493, 510196], [29.810057809, 516004], [31.624005968, 529172], [33.433013773, 531936],
#                      [35.25928479, 532344], [37.092092925, 538364], [38.102963907, 548744],
#                      [39.924327023000004, 545516], [41.729301603, 550884], [43.540291392, 557808],
#                      [45.347360579, 561724], [47.169496446, 556168], [49.011585526, 581232], [50.823214165, 574888],
#                      [52.64347461, 573316], [54.447590065, 571784], [56.276114357, 578064], [57.283435147, 570924],
#                      [59.12331606, 576356], [60.942781559, 577336], [62.764237568, 581372], [64.595277978, 575348],
#                      [66.403776621, 574876], [68.20959977, 578288], [70.019599508, 574892], [71.859492037, 567136],
#                      [73.663600443, 567480], [75.487515269, 576564], [77.133634976, 567664], [78.954270747, 578108],
#                      [80.79577953, 577728], [82.635105627, 575796], [84.447651732, 571864], [86.268515464, 578308],
#                      [88.083857798, 575500], [89.922615099, 567136], [91.729333261, 574744]],
#     "skip slice_model()": [[0.042694868, 18528], [1.054480046, 180976], [2.869932923, 303848], [4.683334884, 309164],
#                            [6.496423195, 317100], [8.303804408, 338020], [9.512667188, 339280], [11.334003168, 351248],
#                            [13.149602165, 359480], [14.967301195, 371392], [16.775008038, 375576],
#                            [18.609840614, 395792], [20.425202473, 403904], [22.232969018, 412080],
#                            [24.03805168, 416152], [25.84236809, 431664], [27.717021297, 428512], [29.498214122, 426732],
#                            [31.249602243, 438464], [33.063644976, 427312], [34.870353464, 428468],
#                            [36.673594206, 423136], [38.497763786, 429512], [40.30969706, 428276],
#                            [42.119186815, 422584], [43.96071582, 428696]],
#     "skip py_call()": [[0.037487731, 18596], [1.049279797, 183072], [2.874304285, 307504], [4.691098214, 310540],
#                        [6.506874205, 313776], [8.323560725, 317032], [10.141980121, 320264], [11.159410321, 322108],
#                        [12.975202068, 325320], [14.791966966, 328416], [16.605266190000002, 331584],
#                        [18.427664584, 334884], [20.245025925, 338292], [22.058351874, 341388], [23.890465751, 344692],
#                        [25.705545216, 347916], [27.522452603, 351332], [29.333310017, 354484], [30.352157345, 356332],
#                        [32.166749406, 360272], [33.982633515, 363588], [35.798760843, 366808], [37.614703567, 369848],
#                        [39.43130915, 373356], [41.247204044, 376604], [43.061635834, 379644], [44.878014548, 382916],
#                        [46.693206224, 385960], [48.511253715, 389324], [50.304198335, 392496], [52.118861656, 395536],
#                        [53.936806313, 398620], [55.75111513, 401740], [57.565047381, 405112], [59.38717689, 408284],
#                        [61.202498465, 411316], [63.022486377, 414684], [64.836342967, 417852], [66.646825683, 420692],
#                        [68.458628796, 423728], [70.271319163, 426908], [71.286288318, 428624], [73.101626735, 431592],
#                        [74.919554886, 434632], [76.740418829, 437672], [78.558534728, 438784], [80.373493686, 438784],
#                        [82.196832336, 438832], [84.009351503, 438832], [85.830947725, 438832], [87.646467389, 438832],
#                        [89.461031784, 438832], [90.479992122, 438832], [92.294620107, 438832], [94.111099799, 438832],
#                        [95.927230684, 438832], [97.746362444, 438832], [99.563158397, 438832], [101.383019042, 438832],
#                        [103.202695871, 438832], [105.017722804, 438832], [106.834484135, 438832],
#                        [108.647513243, 438832], [110.301242856, 438832], [112.118349192, 438832],
#                        [113.932724093, 438832], [115.74753262, 438832], [117.562538053, 438832],
#                        [119.379353309, 438832], [121.195222711, 438832], [123.010560053, 438832],
#                        [124.827020238, 438832], [126.642775797, 438832], [128.459480247, 438832],
#                        [130.281429911, 438832], [132.097044741, 438860], [133.912049601, 438864],
#                        [135.730862672, 438864], [137.54748466, 438864], [139.367069797, 438864],
#                        [141.180923526, 438864], [142.998003973, 438864], [144.813620774, 438864],
#                        [146.630798922, 438864], [148.451205105, 438864], [150.266960215, 438864],
#                        [151.284242509, 438868], [153.097853193, 438868]],
#     "del tensor input": [[0.054385368, 18624], [1.067849517, 185616], [2.901614011, 438320], [3.917688274, 436544],
#                          [5.736061766, 445896], [7.548737215, 378156], [9.366380075, 457636], [11.24744956, 463812],
#                          [13.052007021, 468808], [14.874246281, 385128], [16.732588026, 479272], [18.561360171, 485716],
#                          [20.398859579, 488532], [22.204423505, 404036], [23.793341643, 496076], [25.612309963, 446308],
#                          [27.444747921, 416448], [29.254008026, 513644], [31.088803812, 428000], [32.902038096, 521348],
#                          [34.717332123, 523908], [36.555603846, 470384], [38.365823787, 535356], [40.175110609, 538456],
#                          [42.027637158, 546492], [43.790587946, 551372], [45.556554618, 545584], [47.376132303, 559660],
#                          [49.202024759, 520548], [51.01185505, 568720], [52.823131681, 575540], [54.631675351, 566048],
#                          [56.442919021, 575484], [58.288686412, 572360], [60.100066386, 570704], [61.922948475, 567112],
#                          [63.734473112, 567968], [64.741727769, 566108], [66.578540643, 576664], [68.40184616, 574012],
#                          [70.227813142, 568888], [72.053873509, 566012], [73.872927372, 567696], [75.732145544, 565956],
#                          [77.55978126, 570304], [79.381456961, 563472], [81.195234408, 568084], [83.033166813, 563724],
#                          [84.041605986, 566292], [85.888401306, 565200], [87.735611201, 575888], [89.545348051, 572496],
#                          [91.380171848, 567764], [93.21085096, 567968], [95.031529793, 569912], [96.852397771, 564044]]
#
#     # "w/o state cache": [],
#     # "w/o memory sharing": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
#     # "w/o all opt": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
# }

memory_log = {
    "with all opt": [["Monitoring", 0.092374781, 18720], ["Monitoring", 1.107195427, 185012],
                     ["Monitoring", 2.684624923, 306216], ["After batch 0", 0.267830259, 306216],
                     ["After batch 1", 0.249020109, 306996], ["After batch 2", 0.24702044, 307352],
                     ["After batch 3", 0.247221169, 307616], ["Monitoring", 3.703356434, 307880],
                     ["After batch 4", 0.242246393, 308032], ["After batch 5", 0.243549572, 308296],
                     ["After batch 6", 0.235356102, 308748], ["Monitoring", 4.720858045, 309012],
                     ["After batch 7", 0.244271369, 309012], ["After batch 8", 0.242865706, 309276],
                     ["After batch 9", 0.242226349, 309736], ["After batch 10", 0.24180807, 310000],
                     ["Monitoring", 5.740121968, 310264], ["After batch 11", 0.245212371, 310444],
                     ["After batch 12", 0.247207161, 310708], ["After batch 13", 0.247707876, 310840],
                     ["Monitoring", 6.758931988, 311104], ["After batch 14", 0.242860577, 311104],
                     ["After batch 15", 0.244316527, 311368], ["After batch 16", 0.238878109, 311632],
                     ["After batch 17", 0.242888372, 311896], ["Monitoring", 7.773903847, 312160],
                     ["After batch 18", 0.247326431, 312348], ["After batch 19", 0.24029725, 312612],
                     ["After batch 20", 0.242057178, 312876], ["Monitoring", 8.793643871, 313140],
                     ["After batch 21", 0.245746882, 313140], ["After batch 22", 0.244673877, 313660],
                     ["After batch 23", 0.244977406, 313924], ["Monitoring", 9.820900482, 314188],
                     ["After batch 24", 0.244295619, 314188], ["After batch 25", 0.248531463, 314452],
                     ["After batch 26", 0.248654629, 314716], ["After batch 27", 0.24340989, 314980],
                     ["Monitoring", 10.839451697, 315244], ["After batch 28", 0.244213084, 315244],
                     ["After batch 29", 0.247970276, 315508], ["After batch 30", 0.235766545, 315640],
                     ["Monitoring", 11.859188914, 315904], ["After batch 31", 0.24141222, 315904],
                     ["After batch 32", 0.239062341, 316168], ["After batch 33", 0.246909781, 316640],
                     ["After batch 34", 0.24685375, 317092], ["Monitoring", 12.880821566, 319712],
                     ["After batch 35", 0.236272575, 320404], ["After batch 36", 0.242784376, 320772],
                     ["After batch 37", 0.23874647, 321032], ["Monitoring", 13.899061748, 321296],
                     ["After batch 38", 0.242976989, 321436], ["After batch 39", 0.250459166, 321700],
                     ["After batch 40", 0.238375726, 321964], ["After batch 41", 0.239393644, 322232],
                     ["Monitoring", 14.917528757, 322496], ["After batch 42", 0.245128851, 322496],
                     ["After batch 43", 0.245633681, 322760], ["After batch 44", 0.256757313, 323096],
                     ["Monitoring", 15.936310238, 323352], ["After batch 45", 0.246022685, 323352],
                     ["After batch 46", 0.239101027, 323696], ["After batch 47", 0.242843713, 323952],
                     ["Monitoring", 16.956630503, 324212], ["After batch 48", 0.239543408, 324212],
                     ["After batch 49", 0.242829151, 324508], ["After batch 50", 0.23944823, 324896],
                     ["After batch 51", 0.23548635, 325160], ["Monitoring", 17.975502862, 325420],
                     ["After batch 52", 0.250741847, 325420], ["After batch 53", 0.242933098, 325680],
                     ["After batch 54", 0.242833212, 326008], ["Monitoring", 18.994511381, 326272],
                     ["After batch 55", 0.241779237, 326272], ["After batch 56", 0.234865284, 326532],
                     ["After batch 57", 0.241532706, 326796], ["After batch 58", 0.24456097, 327064],
                     ["Monitoring", 20.013518417, 327464], ["After batch 59", 0.24147117, 328004],
                     ["After batch 60", 0.246417256, 328224], ["After batch 61", 0.245890098, 328496],
                     ["Monitoring", 21.028832162, 328760], ["After batch 62", 0.251428909, 328760],
                     ["After batch 63", 0.248139355, 329112], ["After batch 64", 0.247629297, 329452],
                     ["After batch 65", 0.248136137, 329716], ["Monitoring", 22.044559545, 329716],
                     ["After batch 66", 0.244880843, 330820], ["After batch 67", 0.246902663, 331044],
                     ["After batch 68", 0.242760459, 331296], ["Monitoring", 23.060832204, 331556],
                     ["After batch 69", 0.239670396, 331560], ["After batch 70", 0.246083821, 331908],
                     ["After batch 71", 0.244369331, 332168], ["Monitoring", 24.07998947, 332436],
                     ["After batch 72", 0.244467643, 332436], ["After batch 73", 0.24529733, 332700],
                     ["After batch 74", 0.246157911, 332960], ["After batch 75", 0.239041861, 333088],
                     ["Monitoring", 25.102164146, 333352], ["After batch 76", 0.242700112, 334148],
                     ["After batch 77", 0.245638165, 334316], ["After batch 78", 0.242193159, 334540],
                     ["Monitoring", 26.119677351, 334796], ["After batch 79", 0.245149359, 334796],
                     ["After batch 80", 0.245432665, 335056], ["After batch 81", 0.257099674, 335600],
                     ["Monitoring", 27.136125781, 335856], ["After batch 82", 0.243715276, 335856],
                     ["After batch 83", 0.241000593, 336112], ["After batch 84", 0.239347998, 336376],
                     ["After batch 85", 0.24610859, 336504], ["Monitoring", 28.154650794, 336764],
                     ["After batch 86", 0.243175534, 336764], ["After batch 87", 0.244457467, 337088],
                     ["After batch 88", 0.245722916, 337348], ["Monitoring", 29.169800163, 337612],
                     ["After batch 89", 0.24049274, 337612], ["After batch 90", 0.244150557, 337876],
                     ["After batch 91", 0.234828839, 338140], ["After batch 92", 0.24366862, 338404],
                     ["Monitoring", 30.188681983, 338668], ["After batch 93", 0.245208658, 338668],
                     ["After batch 94", 0.241463584, 338940], ["After batch 95", 0.246004479, 339200],
                     ["Monitoring", 31.206543374, 339464], ["After batch 96", 0.252034713, 339468],
                     ["After batch 97", 0.236691513, 339736], ["After batch 98", 0.24662353, 340016],
                     ["Monitoring", 32.223605896, 340280], ["After batch 99", 0.253766847, 340280],
                     ["After batch 100", 0.246122844, 340544], ["After batch 101", 0.24329402, 340808],
                     ["After batch 102", 0.24853971, 341080], ["Monitoring", 33.242452579, 341344],
                     ["After batch 103", 0.241928434, 341344], ["After batch 104", 0.247558707, 341476],
                     ["After batch 105", 0.241731436, 341740], ["Monitoring", 34.259792239, 342004],
                     ["After batch 106", 0.24916166, 342004], ["After batch 107", 0.241176043, 342268],
                     ["After batch 108", 0.242049323, 342532], ["After batch 109", 0.240831772, 342796],
                     ["Monitoring", 35.279297644, 343060], ["After batch 110", 0.245787168, 343060],
                     ["After batch 111", 0.25069688, 343480], ["After batch 112", 0.24919109, 343712],
                     ["Monitoring", 36.297679404, 344016], ["After batch 113", 0.249637463, 344016],
                     ["After batch 114", 0.250499775, 344396], ["After batch 115", 0.248355908, 344656],
                     ["Monitoring", 37.322263374, 344916], ["After batch 116", 0.246241532, 344920],
                     ["After batch 117", 0.245116596, 345192], ["After batch 118", 0.2486316, 345524],
                     ["After batch 119", 0.243129827, 345800], ["Monitoring", 38.338629143, 346064],
                     ["After batch 120", 0.2460921, 346076], ["After batch 121", 0.244059825, 346208],
                     ["After batch 122", 0.242072756, 346472], ["Monitoring", 39.358841533, 346736],
                     ["After batch 123", 0.247262116, 346740], ["After batch 124", 0.237111364, 347024],
                     ["After batch 125", 0.239052913, 347300], ["After batch 126", 0.24280115, 347592],
                     ["Monitoring", 40.374547405, 347856], ["After batch 127", 0.246261392, 347856],
                     ["After batch 128", 0.245708367, 348120], ["After batch 129", 0.245873871, 348380],
                     ["Monitoring", 41.392093524, 348644], ["After batch 130", 0.245183125, 348644],
                     ["After batch 131", 0.243534434, 348928], ["After batch 132", 0.248703669, 349192],
                     ["Monitoring", 42.408844874, 349456], ["After batch 133", 0.252819835, 349456],
                     ["After batch 134", 0.241543624, 349724], ["After batch 135", 0.240235944, 349988],
                     ["After batch 136", 0.247343507, 350260], ["Monitoring", 43.426118812, 350524],
                     ["After batch 137", 0.251561858, 350524], ["After batch 138", 0.245587698, 350788],
                     ["After batch 139", 0.245432765, 350920], ["Monitoring", 44.44286238, 351184],
                     ["After batch 140", 0.245893365, 351184], ["After batch 141", 0.249061962, 351448],
                     ["After batch 142", 0.244461576, 351712], ["After batch 143", 0.241087343, 351976],
                     ["Monitoring", 45.459602529, 352240], ["After batch 144", 0.243317233, 352240],
                     ["After batch 145", 0.244104745, 352512], ["After batch 146", 0.240877278, 352776],
                     ["Monitoring", 46.478130999, 353040], ["After batch 147", 0.248508832, 353040],
                     ["After batch 148", 0.25126833, 353368], ["After batch 149", 0.246675693, 353632],
                     ["Monitoring", 47.496485374, 353896], ["After batch 150", 0.240102401, 353896],
                     ["After batch 151", 0.239211026, 354160], ["After batch 152", 0.243314721, 354424],
                     ["After batch 153", 0.243312685, 354688], ["Monitoring", 48.514906251, 354952],
                     ["After batch 154", 0.244258805, 354952], ["After batch 155", 0.254671914, 355216],
                     ["After batch 156", 0.249757011, 355348], ["Monitoring", 49.528797566, 355632],
                     ["After batch 157", 0.245903046, 355632], ["After batch 158", 0.244448929, 355896],
                     ["After batch 159", 0.24314923, 356164], ["After batch 160", 0.239354775, 356428],
                     ["Monitoring", 50.5486131, 356692], ["After batch 161", 0.244841573, 356692],
                     ["After batch 162", 0.246129755, 356960], ["After batch 163", 0.245105115, 357224],
                     ["Monitoring", 51.567802369, 357488], ["After batch 164", 0.244576959, 357488],
                     ["After batch 165", 0.244958576, 357752], ["After batch 166", 0.249368857, 358016],
                     ["Monitoring", 52.581971621, 358280], ["After batch 167", 0.244084316, 358284],
                     ["After batch 168", 0.239310343, 358548], ["After batch 169", 0.244992136, 358812],
                     ["After batch 170", 0.250477444, 359168], ["Monitoring", 53.600589476, 359572],
                     ["After batch 171", 0.242721491, 359624], ["After batch 172", 0.242518175, 359844],
                     ["After batch 173", 0.252878137, 360096], ["Monitoring", 54.616174203, 360356],
                     ["After batch 174", 0.244862441, 360364], ["After batch 175", 0.242396624, 360624],
                     ["After batch 176", 0.248691119, 360888], ["After batch 177", 0.247223647, 361180],
                     ["Monitoring", 55.633027954, 361444], ["After batch 178", 0.251467222, 361448],
                     ["After batch 179", 0.24307, 361712], ["After batch 180", 0.246833544, 362172],
                     ["Monitoring", 56.652453267, 362436], ["After batch 181", 0.248868676, 362436],
                     ["After batch 182", 0.244471783, 362704], ["After batch 183", 0.246727901, 362968],
                     ["Monitoring", 57.666679935, 363100], ["After batch 184", 0.234387723, 363100],
                     ["After batch 185", 0.233134146, 363380], ["After batch 186", 0.241675484, 363644],
                     ["After batch 187", 0.24412274, 363908], ["Monitoring", 58.684668881, 364172],
                     ["After batch 188", 0.249970999, 364172], ["After batch 189", 0.249443175, 364436],
                     ["After batch 190", 0.246797766, 364712], ["Monitoring", 59.70059309, 364980],
                     ["After batch 191", 0.244135784, 364980], ["After batch 192", 0.243366787, 365260],
                     ["After batch 193", 0.241931014, 365524], ["After batch 194", 0.250697635, 365788],
                     ["Monitoring", 60.717377264, 366052], ["After batch 195", 0.250781773, 366336],
                     ["After batch 196", 0.244849271, 366648], ["After batch 197", 0.246301002, 366912],
                     ["Monitoring", 61.7332357, 367184], ["After batch 198", 0.248944223, 367184],
                     ["After batch 199", 0.246814413, 367448], ["After batch 200", 0.247572814, 367584],
                     ["Monitoring", 62.749447381, 367844], ["After batch 201", 0.239235986, 367844],
                     ["After batch 202", 0.249087241, 368108], ["After batch 203", 0.242403709, 368376],
                     ["After batch 204", 0.243831205, 368648], ["Monitoring", 63.769455169, 368912],
                     ["After batch 205", 0.247188004, 368920], ["After batch 206", 0.243913053, 369180],
                     ["After batch 207", 0.245328971, 369444], ["Monitoring", 64.784245499, 369708],
                     ["After batch 208", 0.241787997, 369708], ["After batch 209", 0.249567393, 369972],
                     ["After batch 210", 0.243410272, 370236], ["Monitoring", 65.802301474, 370500],
                     ["After batch 211", 0.252441481, 370500], ["After batch 212", 0.252639788, 370832],
                     ["After batch 213", 0.242724179, 371104], ["After batch 214", 0.243578947, 371372],
                     ["Monitoring", 66.821707851, 371636], ["After batch 215", 0.244019814, 371636],
                     ["After batch 216", 0.242764021, 371904], ["After batch 217", 0.238841264, 372168],
                     ["Monitoring", 67.841421091, 372432], ["After batch 218", 0.244650345, 372432],
                     ["After batch 219", 0.244622882, 372564], ["After batch 220", 0.239653593, 372828],
                     ["After batch 221", 0.243041499, 373088], ["Monitoring", 68.858793773, 373352],
                     ["After batch 222", 0.246279303, 373352], ["After batch 223", 0.246458289, 373620],
                     ["After batch 224", 0.24560992, 373884], ["Monitoring", 69.873694373, 374148],
                     ["After batch 225", 0.249182909, 374148], ["After batch 226", 0.244411925, 374412],
                     ["After batch 227", 0.246380633, 374676], ["After batch 228", 0.241998766, 374940],
                     ["Monitoring", 70.891402675, 374940], ["After batch 229", 0.24089882, 375204],
                     ["After batch 230", 0.245747896, 375480], ["After batch 231", 0.243991287, 375744],
                     ["Monitoring", 71.907527567, 376008], ["After batch 232", 0.248068061, 376008],
                     ["After batch 233", 0.250082465, 376272], ["After batch 234", 0.251820843, 376536],
                     ["Monitoring", 72.926743252, 376800], ["After batch 235", 0.240811895, 376800],
                     ["After batch 236", 0.24472812, 376932], ["After batch 237", 0.243690183, 377196],
                     ["After batch 238", 0.250063318, 377460], ["Monitoring", 73.943949882, 377728],
                     ["After batch 239", 0.243343493, 377728], ["After batch 240", 0.248915462, 377992],
                     ["After batch 241", 0.249200401, 378256], ["Monitoring", 74.962751398, 378520],
                     ["After batch 242", 0.246978802, 378520], ["After batch 243", 0.246827393, 378800],
                     ["After batch 244", 0.244815768, 379124], ["Monitoring", 75.981392813, 379388],
                     ["After batch 245", 0.242069053, 379388], ["After batch 246", 0.248635175, 379656],
                     ["After batch 247", 0.240989434, 379932], ["After batch 248", 0.242493587, 380196],
                     ["Monitoring", 76.998884276, 380460], ["After batch 249", 0.244718014, 380460],
                     ["After batch 250", 0.247791266, 380724], ["After batch 251", 0.247268273, 381012],
                     ["Monitoring", 78.015763358, 381276], ["After batch 252", 0.254348859, 381276],
                     ["After batch 253", 0.24438809, 381568], ["After batch 254", 0.246560647, 381700],
                     ["Monitoring", 79.031380843, 381964], ["After batch 255", 0.258577656, 381964],
                     ["After batch 256", 0.245947552, 382228], ["After batch 257", 0.240195577, 382492],
                     ["After batch 258", 0.244953657, 382756], ["Monitoring", 80.050163637, 383020],
                     ["After batch 259", 0.244741955, 383020], ["After batch 260", 0.248749083, 383284],
                     ["After batch 261", 0.243515363, 383548], ["Monitoring", 81.062853433, 383816],
                     ["After batch 262", 0.23908385, 383816], ["After batch 263", 0.240431504, 384080],
                     ["After batch 264", 0.238762931, 384344], ["After batch 265", 0.245655744, 384608],
                     ["Monitoring", 82.082593913, 384872], ["After batch 266", 0.248645536, 384872],
                     ["After batch 267", 0.236712554, 385136], ["After batch 268", 0.251158328, 385400],
                     ["Monitoring", 83.10166367, 385664], ["After batch 269", 0.246988013, 385664],
                     ["After batch 270", 0.241328514, 385928], ["After batch 271", 0.244742821, 386060],
                     ["Monitoring", 84.117414685, 386324], ["After batch 272", 0.246726046, 386324],
                     ["After batch 273", 0.243688323, 386588], ["After batch 274", 0.251863267, 386856],
                     ["After batch 275", 0.244595301, 387120], ["Monitoring", 85.134341858, 387448],
                     ["After batch 276", 0.25214739, 387448], ["After batch 277", 0.242991446, 387712],
                     ["After batch 278", 0.245898812, 387980], ["Monitoring", 86.151271102, 388244],
                     ["After batch 279", 0.242760313, 388244], ["After batch 280", 0.245700845, 388508],
                     ["After batch 281", 0.244894126, 388772], ["After batch 282", 0.241308785, 389036],
                     ["Monitoring", 87.167844096, 389300], ["After batch 283", 0.24342943, 389300],
                     ["After batch 284", 0.241364236, 389564], ["After batch 285", 0.248543468, 389828],
                     ["Monitoring", 88.186674506, 390096], ["After batch 286", 0.24728525, 390096],
                     ["After batch 287", 0.243045606, 390360], ["After batch 288", 0.249213576, 390624],
                     ["Monitoring", 89.203549073, 390756], ["After batch 289", 0.243380938, 390756],
                     ["After batch 290", 0.243670837, 391020], ["After batch 291", 0.244720094, 391284],
                     ["After batch 292", 0.246106153, 391548], ["Monitoring", 90.22243779, 391812],
                     ["After batch 293", 0.244287924, 391812], ["After batch 294", 0.244935931, 392076],
                     ["After batch 295", 0.248780723, 392340], ["Monitoring", 91.241356377, 392604],
                     ["After batch 296", 0.24182795, 392604], ["After batch 297", 0.241052362, 392868],
                     ["After batch 298", 0.245163747, 393132], ["After batch 299", 0.24192873, 393396],
                     ["Monitoring", 92.259963322, 393660], ["After batch 300", 0.243080957, 393660],
                     ["After batch 301", 0.24183315, 393924], ["After batch 302", 0.249199101, 394192],
                     ["Monitoring", 93.277340419, 394456], ["After batch 303", 0.249896946, 394456],
                     ["After batch 304", 0.244661087, 394840], ["After batch 305", 0.247491194, 395292],
                     ["Monitoring", 94.293964441, 395524], ["After batch 306", 0.245123123, 395584],
                     ["After batch 307", 0.248574045, 395860], ["After batch 308", 0.244794483, 396204],
                     ["After batch 309", 0.242166709, 396464], ["Monitoring", 95.31268052, 396768],
                     ["After batch 310", 0.252927012, 396768], ["After batch 311", 0.247025185, 397032],
                     ["After batch 312", 0.245793409, 397296], ["Monitoring", 96.330696115, 397556],
                     ["After batch 313", 0.24830913, 397716], ["After batch 314", 0.241723584, 397972],
                     ["After batch 315", 0.237741767, 398192], ["After batch 316", 0.251054554, 398448],
                     ["Monitoring", 97.345254441, 398712], ["After batch 317", 0.246191054, 398712],
                     ["After batch 318", 0.236433068, 398996], ["After batch 319", 0.246449197, 399292],
                     ["Monitoring", 98.360416488, 399556], ["After batch 320", 0.247369253, 399564],
                     ["After batch 321", 0.23942191, 399828], ["After batch 322", 0.249952844, 400092],
                     ["Monitoring", 99.379699176, 400224], ["After batch 323", 0.239008832, 400360],
                     ["After batch 324", 0.243646506, 400488], ["After batch 325", 0.250857893, 400752],
                     ["After batch 326", 0.242726496, 401016], ["Monitoring", 100.395651123, 401284],
                     ["After batch 327", 0.242272229, 401284], ["After batch 328", 0.241995959, 401548],
                     ["After batch 329", 0.24593307, 401812], ["Monitoring", 101.414165223, 402076],
                     ["After batch 330", 0.249687699, 402216], ["After batch 331", 0.243310865, 402500],
                     ["After batch 332", 0.244209734, 402684], ["After batch 333", 0.248144764, 402940],
                     ["Monitoring", 102.430925451, 402956], ["After batch 334", 0.244105123, 403220],
                     ["After batch 335", 0.242483192, 403520], ["After batch 336", 0.24772341, 403780],
                     ["Monitoring", 103.449832419, 404044], ["After batch 337", 0.249377687, 404072],
                     ["After batch 338", 0.252962792, 404408], ["After batch 339", 0.2376845, 404664],
                     ["Monitoring", 104.46807178, 404984], ["After batch 340", 0.251930478, 404984],
                     ["After batch 341", 0.241223452, 405120], ["After batch 342", 0.251516388, 405384],
                     ["After batch 343", 0.253103613, 405652], ["Monitoring", 105.487764809, 405908],
                     ["After batch 344", 0.247919604, 405908], ["After batch 345", 0.245794428, 406180],
                     ["After batch 346", 0.243660151, 406444], ["Monitoring", 106.507998492, 406708],
                     ["After batch 347", 0.250295456, 406708], ["After batch 348", 0.238844388, 406972],
                     ["After batch 349", 0.242639281, 407240], ["Monitoring", 107.522287185, 407504],
                     ["After batch 350", 0.242799208, 407504], ["After batch 351", 0.242013474, 407768],
                     ["After batch 352", 0.248238659, 408040], ["After batch 353", 0.24596538, 408304],
                     ["Monitoring", 108.541434337, 408568], ["After batch 354", 0.251924735, 408568],
                     ["After batch 355", 0.242451965, 408832], ["After batch 356", 0.244232368, 409096],
                     ["Monitoring", 109.560282298, 409360], ["After batch 357", 0.248535595, 409360],
                     ["After batch 358", 0.238504107, 409628], ["After batch 359", 0.24636586, 409892],
                     ["After batch 360", 0.245491069, 410024], ["Monitoring", 110.580329969, 410288],
                     ["After batch 361", 0.237282499, 410288], ["After batch 362", 0.242079694, 410552],
                     ["After batch 363", 0.244740891, 410816], ["Monitoring", 111.598892421, 411080],
                     ["After batch 364", 0.246427779, 411080], ["After batch 365", 0.243487947, 411348],
                     ["After batch 366", 0.249200068, 411612], ["Monitoring", 112.612954858, 411876],
                     ["After batch 367", 0.24510286, 411876], ["After batch 368", 0.245801549, 412140],
                     ["After batch 369", 0.252101538, 412404], ["After batch 370", 0.256746316, 412676],
                     ["Monitoring", 113.632268098, 412932], ["After batch 371", 0.245886456, 412932],
                     ["After batch 372", 0.244307864, 413260], ["After batch 373", 0.247364921, 413524],
                     ["Monitoring", 114.649226132, 413788], ["After batch 374", 0.242122649, 413788],
                     ["After batch 375", 0.243578802, 414052], ["After batch 376", 0.238248558, 414316],
                     ["After batch 377", 0.244687355, 414580], ["Monitoring", 115.667792534, 414712],
                     ["After batch 378", 0.240385495, 414712], ["After batch 379", 0.234919052, 414976],
                     ["After batch 380", 0.241591377, 415240], ["Monitoring", 116.685005178, 415504],
                     ["After batch 381", 0.249869588, 415504], ["After batch 382", 0.238845012, 415768],
                     ["After batch 383", 0.237645205, 416036], ["After batch 384", 0.245863728, 416300],
                     ["Monitoring", 117.704420104, 416300], ["After batch 385", 0.241026302, 416564],
                     ["After batch 386", 0.247293537, 416828], ["After batch 387", 0.243032776, 417092],
                     ["Monitoring", 118.723126609, 417356], ["After batch 388", 0.248697695, 417356],
                     ["After batch 389", 0.245233724, 417620], ["After batch 390", 0.244057956, 417884],
                     ["Monitoring", 119.740935598, 418148], ["After batch 391", 0.246581321, 418148],
                     ["After batch 392", 0.245743293, 418412], ["After batch 393", 0.24951426, 418676],
                     ["After batch 394", 0.244270624, 418940], ["Monitoring", 120.759657265, 419204],
                     ["After batch 395", 0.248857154, 419204], ["After batch 396", 0.246381139, 419336],
                     ["After batch 397", 0.237817394, 419600], ["Monitoring", 121.778410678, 419864],
                     ["After batch 398", 0.249618376, 419864], ["After batch 399", 0.240831206, 420128],
                     ["After batch 400", 0.241851274, 420392], ["After batch 401", 0.230253254, 420656],
                     ["Monitoring", 122.797935208, 420920], ["After batch 402", 0.243978144, 420920],
                     ["After batch 403", 0.2398334, 421184], ["After batch 404", 0.244837804, 421516],
                     ["Monitoring", 123.81395874, 421780], ["After batch 405", 0.246912869, 421780],
                     ["After batch 406", 0.243514026, 422044], ["After batch 407", 0.241439787, 422308],
                     ["Monitoring", 124.850113907, 422572], ["After batch 408", 0.244050274, 422572],
                     ["After batch 409", 0.248002127, 422836], ["After batch 410", 0.236994627, 423100],
                     ["After batch 411", 0.240607742, 423364], ["Monitoring", 125.869171085, 423628],
                     ["After batch 412", 0.246733936, 423628], ["After batch 413", 0.246484914, 423760],
                     ["After batch 414", 0.242561506, 424024], ["Monitoring", 126.888184518, 424292],
                     ["After batch 415", 0.246646522, 424292], ["After batch 416", 0.242471053, 424556],
                     ["After batch 417", 0.231116924, 424820], ["After batch 418", 0.244637869, 425084],
                     ["Monitoring", 127.899067082, 425348], ["After batch 419", 0.244688605, 425348],
                     ["After batch 420", 0.239220369, 425612], ["After batch 421", 0.241655254, 425876],
                     ["Monitoring", 128.913419777, 426140], ["After batch 422", 0.244501089, 426140],
                     ["After batch 423", 0.239710248, 426404], ["After batch 424", 0.24811514, 426668],
                     ["After batch 425", 0.245313241, 426932], ["Monitoring", 129.92750872, 427196],
                     ["After batch 426", 0.245138093, 427196], ["After batch 427", 0.243732487, 427460],
                     ["After batch 428", 0.238972764, 427724], ["Monitoring", 130.946745723, 427988],
                     ["After batch 429", 0.243859242, 427988], ["After batch 430", 0.242677499, 428120],
                     ["After batch 431", 0.24004924, 428388], ["Monitoring", 131.964879349, 428652],
                     ["After batch 432", 0.243676254, 428652], ["After batch 433", 0.248516107, 428916],
                     ["After batch 434", 0.248377819, 429440], ["After batch 435", 0.24471729, 429736],
                     ["Monitoring", 132.984632322, 430080], ["After batch 436", 0.246886708, 430080],
                     ["After batch 437", 0.250183653, 430240], ["After batch 438", 0.24325242, 430656],
                     ["Monitoring", 134.004425674, 430900], ["After batch 439", 0.246753895, 430900],
                     ["After batch 440", 0.234043003, 431164], ["After batch 441", 0.242697333, 431424],
                     ["After batch 442", 0.246653256, 431688], ["Monitoring", 135.023148245, 431952],
                     ["After batch 443", 0.244917848, 431972], ["After batch 444", 0.251674183, 432236],
                     ["After batch 445", 0.242174644, 432500], ["Monitoring", 136.041626911, 432764],
                     ["After batch 446", 0.24838267, 432764], ["After batch 447", 0.236373074, 433028],
                     ["After batch 448", 0.247611585, 433292], ["Monitoring", 137.062601573, 433556],
                     ["After batch 449", 0.24559036, 433568], ["After batch 450", 0.243166472, 433700],
                     ["After batch 451", 0.247722213, 433964], ["After batch 452", 0.241480181, 434232],
                     ["Monitoring", 138.078557019, 434496], ["After batch 453", 0.244961352, 434496],
                     ["After batch 454", 0.246142503, 434760], ["After batch 455", 0.239506206, 435024],
                     ["Monitoring", 139.09618368, 435288], ["After batch 456", 0.248351357, 435288],
                     ["After batch 457", 0.237741705, 435552], ["After batch 458", 0.248185943, 435816],
                     ["After batch 459", 0.246297862, 436080], ["Monitoring", 140.111074642, 436344],
                     ["After batch 460", 0.243410624, 436344], ["After batch 461", 0.233363149, 436612],
                     ["After batch 462", 0.242916376, 436880], ["Monitoring", 141.127767467, 437252],
                     ["After batch 463", 0.240995676, 437328], ["After batch 464", 0.244170299, 437580],
                     ["After batch 465", 0.246413609, 437828], ["Monitoring", 142.144500407, 438092],
                     ["After batch 466", 0.253776621, 438092], ["After batch 467", 0.244721693, 438372],
                     ["After batch 468", 0.247109267, 438720], ["After batch 469", 0.245064265, 438984],
                     ["Monitoring", 143.163576828, 439248], ["After batch 470", 0.253234254, 439248],
                     ["After batch 471", 0.24892007, 439516], ["After batch 472", 0.248646012, 439648],
                     ["Monitoring", 144.177935745, 439908], ["After batch 473", 0.249838048, 439932],
                     ["After batch 474", 0.234953288, 440200], ["After batch 475", 0.244648169, 440464],
                     ["After batch 476", 0.2355393, 440728], ["Monitoring", 145.197923595, 440992],
                     ["After batch 477", 0.247775006, 440992], ["After batch 478", 0.236199379, 441256],
                     ["After batch 479", 0.250027218, 441520], ["Monitoring", 146.212588895, 441784],
                     ["After batch 480", 0.240758784, 441784], ["After batch 481", 0.244040538, 442052],
                     ["After batch 482", 0.243928398, 442316], ["After batch 483", 0.244468433, 442580],
                     ["Monitoring", 147.233024907, 442580], ["After batch 484", 0.237722357, 442844],
                     ["After batch 485", 0.243151585, 443108], ["After batch 486", 0.247367232, 443376],
                     ["Monitoring", 148.25078488, 443640], ["After batch 487", 0.246539995, 443652],
                     ["After batch 488", 0.246791817, 443916], ["After batch 489", 0.249122777, 444180],
                     ["Monitoring", 149.26689306, 444444], ["After batch 490", 0.242131472, 444444],
                     ["After batch 491", 0.245673705, 444712], ["After batch 492", 0.24032767, 444844],
                     ["After batch 493", 0.239116739, 445108], ["Monitoring", 150.286874339, 445372],
                     ["After batch 494", 0.236790925, 445372], ["After batch 495", 0.243033938, 445636],
                     ["After batch 496", 0.235386171, 445900], ["Monitoring", 151.302781737, 446164],
                     ["After batch 497", 0.244904193, 446164], ["After batch 498", 0.241994819, 446428],
                     ["After batch 499", 0.249461858, 446692], ["After batch 500", 0.238942909, 446956],
                     ["Monitoring", 152.319164648, 447220], ["After batch 501", 0.241995945, 447220],
                     ["After batch 502", 0.240540634, 447352], ["After batch 503", 0.23837907, 447576],
                     ["Monitoring", 153.33288246, 447576], ["After batch 504", 0.246200898, 447576],
                     ["After batch 505", 0.24961851, 447576], ["After batch 506", 0.241811132, 447576],
                     ["Monitoring", 154.350009948, 447576], ["After batch 507", 0.251817571, 447576],
                     ["After batch 508", 0.244395499, 447580], ["After batch 509", 0.245094426, 447580],
                     ["After batch 510", 0.251164435, 447580], ["Monitoring", 155.368932815, 447580],
                     ["After batch 511", 0.251163641, 447580], ["After batch 512", 0.245116886, 447580],
                     ["After batch 513", 0.245049938, 447580], ["Monitoring", 156.387893536, 447580],
                     ["After batch 514", 0.251767288, 447580], ["After batch 515", 0.249715606, 447580],
                     ["After batch 516", 0.245015841, 447580], ["After batch 517", 0.240597421, 447580],
                     ["Monitoring", 157.407031606, 447580], ["After batch 518", 0.24641271, 447580],
                     ["After batch 519", 0.242494124, 447580], ["After batch 520", 0.243413252, 447580],
                     ["Monitoring", 158.424250365, 447580], ["After batch 521", 0.248128899, 447580],
                     ["After batch 522", 0.245975297, 447580], ["After batch 523", 0.246013848, 447580],
                     ["Monitoring", 159.44196036, 447580], ["After batch 524", 0.246425737, 447580],
                     ["After batch 525", 0.240536662, 447580], ["After batch 526", 0.246017774, 447580],
                     ["After batch 527", 0.247108904, 447580], ["Monitoring", 160.460656474, 447580],
                     ["After batch 528", 0.248671898, 447740], ["After batch 529", 0.248692214, 447776],
                     ["After batch 530", 0.249438855, 447808], ["Monitoring", 161.479483503, 447808],
                     ["After batch 531", 0.242882215, 447840], ["After batch 532", 0.246138368, 447852],
                     ["After batch 533", 0.246138733, 447852], ["After batch 534", 0.24855104, 447876],
                     ["Monitoring", 162.495792025, 447876], ["After batch 535", 0.241401052, 447876],
                     ["After batch 536", 0.242960145, 447876], ["After batch 537", 0.24187851, 447880],
                     ["Monitoring", 163.515134035, 447880], ["After batch 538", 0.246760854, 447880],
                     ["After batch 539", 0.242181298, 447880], ["After batch 540", 0.253038301, 447884],
                     ["Monitoring", 164.532180419, 447884], ["After batch 541", 0.242365858, 447884],
                     ["After batch 542", 0.23262791, 447884], ["After batch 543", 0.24857864, 447892],
                     ["After batch 544", 0.244784373, 447892], ["Monitoring", 165.550622925, 447892],
                     ["After batch 545", 0.250578884, 447892], ["After batch 546", 0.24068182, 447892],
                     ["After batch 547", 0.239823096, 447916], ["Monitoring", 166.569883428, 447916],
                     ["After batch 548", 0.243161233, 447916], ["After batch 549", 0.245581371, 447916],
                     ["After batch 550", 0.24421703, 447916], ["After batch 551", 0.243090607, 447924],
                     ["Monitoring", 167.588702207, 447924], ["After batch 552", 0.237830212, 447924],
                     ["After batch 553", 0.239423461, 447924], ["After batch 554", 0.246310185, 447924],
                     ["Monitoring", 168.609153733, 447924], ["After batch 555", 0.244122347, 447924],
                     ["After batch 556", 0.248174867, 447932], ["After batch 557", 0.251125946, 447932],
                     ["After batch 558", 0.240954928, 447940], ["Monitoring", 169.627885761, 447940],
                     ["After batch 559", 0.250430499, 447940], ["After batch 560", 0.245158836, 447940],
                     ["After batch 561", 0.245906309, 447948], ["Monitoring", 170.646301429, 447948],
                     ["After batch 562", 0.254388093, 447948], ["After batch 563", 0.240347196, 447952],
                     ["After batch 564", 0.248353986, 448108], ["Monitoring", 171.666678855, 448108],
                     ["After batch 565", 0.240864879, 448144], ["After batch 566", 0.246601845, 448144],
                     ["After batch 567", 0.250158235, 448144], ["After batch 568", 0.239633681, 448168],
                     ["Monitoring", 172.686759097, 448168], ["After batch 569", 0.240103899, 448172],
                     ["After batch 570", 0.240528076, 448172], ["After batch 571", 0.242205051, 448172],
                     ["Monitoring", 173.705751015, 448172], ["After batch 572", 0.237233126, 448172],
                     ["After batch 573", 0.247815078, 448172], ["After batch 574", 0.243292472, 448180],
                     ["After batch 575", 0.247736832, 448180], ["Monitoring", 174.725286493, 448180],
                     ["After batch 576", 0.244061798, 448180], ["After batch 577", 0.248176093, 448180],
                     ["After batch 578", 0.245601528, 448180], ["Monitoring", 175.740636201, 448180],
                     ["After batch 579", 0.247077536, 448184], ["After batch 580", 0.246155712, 448184],
                     ["After batch 581", 0.24704683, 448184], ["Monitoring", 176.756663829, 448184],
                     ["After batch 582", 0.239902092, 448256], ["After batch 583", 0.243535086, 448256],
                     ["After batch 584", 0.23762932, 448264], ["After batch 585", 0.248339, 448268],
                     ["Monitoring", 177.776796273, 448268], ["After batch 586", 0.24896657, 448268],
                     ["After batch 587", 0.251356924, 448268], ["After batch 588", 0.246603366, 448280],
                     ["Monitoring", 178.795847052, 448280], ["After batch 589", 0.240525326, 448280],
                     ["After batch 590", 0.240223517, 448288], ["After batch 591", 0.243223142, 448288],
                     ["After batch 592", 0.250290537, 448288], ["Monitoring", 179.814892502, 448288],
                     ["After batch 593", 0.246289958, 448288], ["After batch 594", 0.242580245, 448288],
                     ["After batch 595", 0.24514081, 448288], ["Monitoring", 180.831580905, 448288],
                     ["After batch 596", 0.24331212, 448288], ["After batch 597", 0.249412837, 448288],
                     ["After batch 598", 0.245712768, 448288], ["Monitoring", 181.850259956, 448288],
                     ["After batch 599", 0.242334707, 448296], ["After batch 600", 0.237944383, 448296],
                     ["After batch 601", 0.249068061, 448332], ["After batch 602", 0.246201921, 448352],
                     ["Monitoring", 182.868625899, 448352], ["After batch 603", 0.252826358, 448352],
                     ["After batch 604", 0.24751896, 448352], ["After batch 605", 0.243669832, 448352],
                     ["Monitoring", 183.884685175, 448352], ["After batch 606", 0.245206869, 448352],
                     ["After batch 607", 0.249602451, 448380], ["After batch 608", 0.248036748, 448396],
                     ["Monitoring", 184.902896823, 448396], ["After batch 609", 0.250601204, 448396],
                     ["After batch 610", 0.243813864, 448396], ["After batch 611", 0.243591992, 448396],
                     ["After batch 612", 0.24644045, 448396], ["Monitoring", 185.921893653, 448396],
                     ["After batch 613", 0.250904116, 448396], ["After batch 614", 0.242011978, 448400],
                     ["After batch 615", 0.243439752, 448400], ["Monitoring", 186.936850724, 448400],
                     ["After batch 616", 0.238779302, 448400], ["After batch 617", 0.24299652, 448400],
                     ["After batch 618", 0.243349022, 448400], ["After batch 619", 0.245225797, 448400],
                     ["Monitoring", 187.955521785, 448400], ["After batch 620", 0.246261745, 448404],
                     ["After batch 621", 0.249860622, 448496], ["After batch 622", 0.240146362, 448500],
                     ["Monitoring", 188.969841399, 448508], ["After batch 623", 0.249006922, 448508],
                     ["After batch 624", 0.246373926, 448508], ["After batch 625", 0.247905492, 448528],
                     ["Monitoring", 189.988721685, 448528], ["After batch 626", 0.237660925, 448528],
                     ["After batch 627", 0.239962335, 448528], ["After batch 628", 0.241956018, 448528],
                     ["After batch 629", 0.244881238, 448540], ["Monitoring", 191.003485716, 448540],
                     ["After batch 630", 0.238325205, 448540], ["After batch 631", 0.24708673, 448540],
                     ["After batch 632", 0.24438914, 448540], ["Monitoring", 192.022510702, 448540],
                     ["After batch 633", 0.245516511, 448540], ["After batch 634", 0.245211826, 448540],
                     ["After batch 635", 0.242522288, 448540], ["After batch 636", 0.243843665, 448540],
                     ["Monitoring", 193.035677555, 448540], ["After batch 637", 0.247349933, 448544],
                     ["After batch 638", 0.244945595, 448548], ["After batch 639", 0.243909878, 448548],
                     ["Monitoring", 194.053742141, 448548], ["After batch 640", 0.245780668, 448548],
                     ["After batch 641", 0.245640888, 448548], ["After batch 642", 0.247274814, 448548],
                     ["Monitoring", 195.073149106, 448548], ["After batch 643", 0.246120237, 448548],
                     ["After batch 644", 0.24484534, 448572], ["After batch 645", 0.243784439, 448572],
                     ["After batch 646", 0.247093431, 448572], ["Monitoring", 196.092454924, 448572],
                     ["After batch 647", 0.251902628, 448580], ["After batch 648", 0.249008249, 448580],
                     ["After batch 649", 0.245324206, 448580], ["Monitoring", 197.108649141, 448580],
                     ["After batch 650", 0.252108952, 448584], ["After batch 651", 0.245839041, 448584],
                     ["After batch 652", 0.24859743, 448584], ["After batch 653", 0.243850166, 448584],
                     ["Monitoring", 198.124585886, 448584], ["After batch 654", 0.245536765, 448584],
                     ["After batch 655", 0.239876766, 448584], ["After batch 656", 0.241973188, 448584],
                     ["Monitoring", 199.141870195, 448584], ["After batch 657", 0.24734522, 448584],
                     ["After batch 658", 0.245610443, 448584], ["After batch 659", 0.239518138, 448584],
                     ["Monitoring", 200.156122377, 448584], ["After batch 660", 0.241809223, 448584],
                     ["After batch 661", 0.247322089, 448584], ["After batch 662", 0.243322775, 448584],
                     ["After batch 663", 0.247406735, 448584], ["Monitoring", 201.175604417, 448584],
                     ["After batch 664", 0.239169661, 448588], ["After batch 665", 0.245065559, 448588],
                     ["After batch 666", 0.246108341, 448588], ["Monitoring", 202.194477945, 448588],
                     ["After batch 667", 0.236779327, 448588], ["After batch 668", 0.243438548, 448588],
                     ["After batch 669", 0.236590317, 448588], ["After batch 670", 0.242526215, 448588],
                     ["Monitoring", 203.213762878, 448588], ["After batch 671", 0.241765939, 448588],
                     ["After batch 672", 0.243981392, 448588], ["After batch 673", 0.246760565, 448588],
                     ["Monitoring", 204.23295205, 448588], ["After batch 674", 0.251675041, 448588],
                     ["After batch 675", 0.250145969, 448588], ["After batch 676", 0.244791431, 448588],
                     ["Monitoring", 205.250115002, 448588], ["After batch 677", 0.249848203, 448588],
                     ["After batch 678", 0.246123891, 448588], ["After batch 679", 0.246600211, 448588],
                     ["After batch 680", 0.243540885, 448612], ["Monitoring", 206.263671551, 448612],
                     ["After batch 681", 0.249313784, 448616], ["After batch 682", 0.246071587, 448616],
                     ["After batch 683", 0.237749123, 448616], ["Monitoring", 207.283398992, 448616],
                     ["After batch 684", 0.2482503, 448616], ["After batch 685", 0.243372273, 448616],
                     ["After batch 686", 0.247054749, 448616], ["After batch 687", 0.249114221, 448616],
                     ["Monitoring", 208.301775025, 448616], ["After batch 688", 0.240391282, 448616],
                     ["After batch 689", 0.246350772, 448616], ["After batch 690", 0.237205444, 448616],
                     ["Monitoring", 209.32159366, 448616], ["After batch 691", 0.244928251, 448616],
                     ["After batch 692", 0.245935111, 448616], ["After batch 693", 0.240880428, 448616],
                     ["After batch 694", 0.23984419, 448616], ["Monitoring", 210.334343912, 448616],
                     ["After batch 695", 0.237260037, 448616], ["After batch 696", 0.24563442, 448616],
                     ["After batch 697", 0.249433841, 448620], ["Monitoring", 211.353673924, 448620],
                     ["After batch 698", 0.244879352, 448620], ["After batch 699", 0.243162348, 448620],
                     ["After batch 700", 0.245778877, 448620], ["Monitoring", 212.369275262, 448620],
                     ["After batch 701", 0.245843235, 448620], ["After batch 702", 0.247470071, 448644],
                     ["After batch 703", 0.250403996, 448644], ["After batch 704", 0.239873993, 448644],
                     ["Monitoring", 213.385362426, 448644], ["After batch 705", 0.246785736, 448644],
                     ["After batch 706", 0.243480978, 448644], ["After batch 707", 0.250664604, 448644],
                     ["Monitoring", 214.400112838, 448696], ["After batch 708", 0.2358692, 448720],
                     ["After batch 709", 0.242145656, 448732], ["After batch 710", 0.244891165, 448736],
                     ["After batch 711", 0.24190691, 448764], ["Monitoring", 215.418953901, 448764],
                     ["After batch 712", 0.239866187, 448816], ["After batch 713", 0.236323236, 448816],
                     ["After batch 714", 0.237539369, 448816], ["Monitoring", 216.438861132, 448816],
                     ["After batch 715", 0.241136048, 448816], ["After batch 716", 0.247757568, 448816],
                     ["After batch 717", 0.24510373, 448816], ["Monitoring", 217.452841397, 448824],
                     ["After batch 718", 0.24375342, 448828], ["After batch 719", 0.244108132, 448828],
                     ["After batch 720", 0.242989507, 448828], ["After batch 721", 0.248302173, 448828],
                     ["Monitoring", 218.468127376, 448828], ["After batch 722", 0.237929267, 448840],
                     ["After batch 723", 0.251232023, 448840], ["After batch 724", 0.24136219, 448840],
                     ["Monitoring", 219.484628758, 448840], ["After batch 725", 0.242047175, 448840],
                     ["After batch 726", 0.254009985, 448972], ["After batch 727", 0.248595652, 448976],
                     ["After batch 728", 0.239076412, 448992], ["Monitoring", 220.504482564, 448992],
                     ["After batch 729", 0.242498268, 448992], ["After batch 730", 0.247456968, 448992],
                     ["After batch 731", 0.248836834, 448992], ["Monitoring", 221.523384172, 448992],
                     ["After batch 732", 0.251867317, 448996], ["After batch 733", 0.242101629, 448996],
                     ["After batch 734", 0.245515211, 449000], ["Monitoring", 222.542398785, 449000],
                     ["After batch 735", 0.246097788, 449000], ["After batch 736", 0.24103149, 449000],
                     ["After batch 737", 0.236413143, 449000], ["After batch 738", 0.242827761, 449000],
                     ["Monitoring", 223.560673513, 449000], ["After batch 739", 0.244660009, 449000],
                     ["After batch 740", 0.240226538, 449012], ["After batch 741", 0.244109267, 449012],
                     ["Monitoring", 224.5961344, 449012], ["After batch 742", 0.245370885, 449012],
                     ["After batch 743", 0.247532743, 449012], ["After batch 744", 0.246714655, 449012],
                     ["After batch 745", 0.2418568, 449012], ["Monitoring", 225.613691753, 449012],
                     ["After batch 746", 0.241016792, 449012], ["After batch 747", 0.245375749, 449012],
                     ["After batch 748", 0.246059741, 449012], ["Monitoring", 226.630497552, 449012],
                     ["After batch 749", 0.249627051, 449012], ["After batch 750", 0.24793818, 449012],
                     ["After batch 751", 0.237415993, 449012], ["After batch 752", 0.243158069, 449012],
                     ["Monitoring", 227.649386096, 449012], ["After batch 753", 0.246904508, 449012],
                     ["After batch 754", 0.24749524, 449012], ["After batch 755", 0.244365343, 449012],
                     ["Monitoring", 228.669178761, 449012], ["After batch 756", 0.251785018, 449012],
                     ["After batch 757", 0.241930963, 449012], ["After batch 758", 0.245981831, 449012],
                     ["Monitoring", 229.689213885, 449012], ["After batch 759", 0.245943285, 449012],
                     ["After batch 760", 0.245302597, 449012], ["After batch 761", 0.240122967, 449012],
                     ["After batch 762", 0.248483192, 449020], ["Monitoring", 230.707911677, 449020],
                     ["After batch 763", 0.251080688, 449020], ["After batch 764", 0.247324229, 449020],
                     ["After batch 765", 0.242950369, 449020], ["Monitoring", 231.726270619, 449020],
                     ["After batch 766", 0.251827463, 449020], ["After batch 767", 0.243048258, 449024],
                     ["After batch 768", 0.244382074, 449024], ["After batch 769", 0.242195041, 449024],
                     ["Monitoring", 232.74248948299999, 449024], ["After batch 770", 0.247968127, 449024],
                     ["After batch 771", 0.25405913, 449024], ["After batch 772", 0.238352217, 449024],
                     ["Monitoring", 233.761022862, 449024], ["After batch 773", 0.247274258, 449024],
                     ["After batch 774", 0.240081853, 449024], ["After batch 775", 0.244033677, 449024],
                     ["Monitoring", 234.782395344, 449024], ["After batch 776", 0.243843601, 449072],
                     ["After batch 777", 0.24003497, 449152], ["After batch 778", 0.246959524, 449164],
                     ["After batch 779", 0.240214511, 449164], ["Monitoring", 235.801771498, 449164],
                     ["After batch 780", 0.239543263, 449172], ["After batch 781", 0.24135776, 449172],
                     ["After batch 782", 0.246442919, 449192], ["Monitoring", 236.820842591, 449192],
                     ["After batch 783", 0.242426668, 449208], ["After batch 784", 0.249344438, 449224],
                     ["After batch 785", 0.245059672, 449224], ["After batch 786", 0.236007075, 449224],
                     ["Monitoring", 237.836275126, 449224], ["After batch 787", 0.245301974, 449224],
                     ["After batch 788", 0.240745142, 449224], ["After batch 789", 0.244032819, 449224],
                     ["Monitoring", 238.854651813, 449224], ["After batch 790", 0.242744045, 449224],
                     ["After batch 791", 0.24740022, 449224], ["After batch 792", 0.243513996, 449228],
                     ["After batch 793", 0.244412057, 449228], ["Monitoring", 239.873594857, 449228],
                     ["After batch 794", 0.240405881, 449228], ["After batch 795", 0.243865108, 449228],
                     ["After batch 796", 0.248105124, 449228], ["Monitoring", 240.890322095, 449228],
                     ["After batch 797", 0.243728843, 449228], ["After batch 798", 0.235701665, 449232],
                     ["After batch 799", 0.245097303, 449232], ["After batch 800", 0.242999699, 449232],
                     ["Monitoring", 241.908936403, 449232], ["After batch 801", 0.25252312, 449232],
                     ["After batch 802", 0.250488721, 449236], ["After batch 803", 0.245243832, 449236],
                     ["Monitoring", 242.928159529, 449236], ["After batch 804", 0.245904285, 449236],
                     ["After batch 805", 0.249814296, 449236], ["After batch 806", 0.245856983, 449236],
                     ["Monitoring", 243.942423377, 449236], ["After batch 807", 0.24472385, 449236],
                     ["After batch 808", 0.248775138, 449236], ["After batch 809", 0.242640302, 449236],
                     ["After batch 810", 0.246886028, 449240], ["Monitoring", 244.958586194, 449240],
                     ["After batch 811", 0.242602192, 449240], ["After batch 812", 0.250434153, 449240],
                     ["After batch 813", 0.242294966, 449240], ["Monitoring", 245.977496509, 449240],
                     ["After batch 814", 0.246019449, 449244], ["After batch 815", 0.235511067, 449244],
                     ["After batch 816", 0.24637534, 449244], ["Monitoring", 247.003653528, 449244],
                     ["After batch 817", 0.243197215, 449256], ["After batch 818", 0.242253233, 449256],
                     ["After batch 819", 0.248858642, 449256], ["After batch 820", 0.242512656, 449256],
                     ["Monitoring", 248.019032155, 449256], ["After batch 821", 0.241352024, 449256],
                     ["After batch 822", 0.241178417, 449268], ["After batch 823", 0.248949309, 449336],
                     ["Monitoring", 249.039248655, 449344], ["After batch 824", 0.24735154, 449352],
                     ["After batch 825", 0.243762024, 449376], ["After batch 826", 0.241399382, 449380],
                     ["After batch 827", 0.245234316, 449392], ["Monitoring", 250.058004232, 449392],
                     ["After batch 828", 0.241085907, 449392], ["After batch 829", 0.245979632, 449392],
                     ["After batch 830", 0.248173809, 449392], ["Monitoring", 251.076823531, 449392],
                     ["After batch 831", 0.242864627, 449392], ["After batch 832", 0.241507294, 449392],
                     ["After batch 833", 0.240285427, 449392], ["Monitoring", 252.095439928, 449392],
                     ["After batch 834", 0.245004301, 449392], ["After batch 835", 0.244842946, 449424],
                     ["After batch 836", 0.24739427, 449424], ["After batch 837", 0.243753885, 449424],
                     ["Monitoring", 253.114122916, 449424], ["After batch 838", 0.251588164, 449424],
                     ["After batch 839", 0.240728972, 449424], ["After batch 840", 0.247146648, 449424],
                     ["Monitoring", 254.132724513, 449424], ["After batch 841", 0.240708382, 449444],
                     ["After batch 842", 0.242769868, 449444], ["After batch 843", 0.236602953, 449452],
                     ["After batch 844", 0.239120831, 449452], ["Monitoring", 255.151894514, 449452],
                     ["After batch 845", 0.239991811, 449452], ["After batch 846", 0.243726547, 449456],
                     ["After batch 847", 0.242067237, 449456], ["Monitoring", 256.168370212, 449456],
                     ["After batch 848", 0.244635111, 449456], ["After batch 849", 0.245514977, 449456],
                     ["After batch 850", 0.244435822, 449456], ["After batch 851", 0.239328481, 449456],
                     ["Monitoring", 257.187972285, 449456], ["After batch 852", 0.246420609, 449456],
                     ["After batch 853", 0.245321276, 449456], ["After batch 854", 0.247959902, 449456],
                     ["Monitoring", 258.206698711, 449456], ["After batch 855", 0.248923535, 449456],
                     ["After batch 856", 0.241748209, 449456], ["After batch 857", 0.245706205, 449456],
                     ["Monitoring", 259.225546888, 449456], ["After batch 858", 0.256627402, 449456],
                     ["After batch 859", 0.24407144, 449456], ["After batch 860", 0.247702986, 449456],
                     ["After batch 861", 0.245727429, 449464], ["Monitoring", 260.244450839, 449464],
                     ["After batch 862", 0.246910144, 449464], ["After batch 863", 0.249852372, 449464],
                     ["After batch 864", 0.242668989, 449464], ["Monitoring", 261.261352908, 449464],
                     ["After batch 865", 0.249946319, 449464], ["After batch 866", 0.245867906, 449464],
                     ["After batch 867", 0.259584866, 449496], ["After batch 868", 0.245735513, 449532],
                     ["Monitoring", 262.279408853, 449588], ["After batch 869", 0.248310054, 449612],
                     ["After batch 870", 0.249521825, 449648], ["After batch 871", 0.240518372, 449648],
                     ["Monitoring", 263.296689459, 449648], ["After batch 872", 0.240956505, 449664],
                     ["After batch 873", 0.24557669, 449664], ["After batch 874", 0.240979188, 449664],
                     ["Monitoring", 264.313029545, 449664], ["After batch 875", 0.239731484, 449668],
                     ["After batch 876", 0.247106168, 449672], ["After batch 877", 0.2446059, 449672],
                     ["After batch 878", 0.243420933, 449672], ["Monitoring", 265.332083578, 449672],
                     ["After batch 879", 0.2540905, 449684], ["After batch 880", 0.242844507, 449684],
                     ["After batch 881", 0.245672574, 449684], ["Monitoring", 266.350403331, 449684],
                     ["After batch 882", 0.246089696, 449684], ["After batch 883", 0.243373179, 449684],
                     ["After batch 884", 0.247798187, 449684], ["After batch 885", 0.238840382, 449684],
                     ["Monitoring", 267.366234627, 449684], ["After batch 886", 0.24320734, 449692],
                     ["After batch 887", 0.248415309, 449692], ["After batch 888", 0.241989518, 449692],
                     ["Monitoring", 268.384757453, 449692], ["After batch 889", 0.246122484, 449692],
                     ["After batch 890", 0.249023051, 449692], ["After batch 891", 0.246530279, 449692],
                     ["Monitoring", 269.403792968, 449692], ["After batch 892", 0.24203084, 449692],
                     ["After batch 893", 0.239934594, 449692], ["After batch 894", 0.24402499, 449692],
                     ["After batch 895", 0.245331212, 449692], ["Monitoring", 270.421098316, 449692],
                     ["After batch 896", 0.2482635, 449692], ["After batch 897", 0.241161931, 449692],
                     ["After batch 898", 0.237251591, 449692], ["Monitoring", 271.435777159, 449692],
                     ["After batch 899", 0.242454897, 449692], ["After batch 900", 0.245816384, 449692],
                     ["After batch 901", 0.244788558, 449692], ["After batch 902", 0.245685827, 449692],
                     ["Monitoring", 272.454545452, 449692], ["After batch 903", 0.244778328, 449692],
                     ["After batch 904", 0.237918604, 449692], ["After batch 905", 0.252693854, 449692],
                     ["Monitoring", 273.473104771, 449692], ["After batch 906", 0.238554205, 449692],
                     ["After batch 907", 0.244415648, 449692], ["After batch 908", 0.248540124, 449692],
                     ["Monitoring", 274.490211911, 449692], ["After batch 909", 0.24962028, 449692],
                     ["After batch 910", 0.246688672, 449692], ["After batch 911", 0.242652931, 449828],
                     ["After batch 912", 0.239214735, 449828], ["Monitoring", 275.505708699, 449856],
                     ["After batch 913", 0.247120798, 449880], ["After batch 914", 0.239518973, 449880],
                     ["After batch 915", 0.240734471, 449880], ["Monitoring", 276.522347584, 449880],
                     ["After batch 916", 0.251245614, 449880], ["After batch 917", 0.247213832, 449880],
                     ["After batch 918", 0.237524777, 449888], ["After batch 919", 0.250872803, 449888],
                     ["Monitoring", 277.538353518, 449888], ["After batch 920", 0.255265558, 449888],
                     ["After batch 921", 0.246939566, 449888], ["After batch 922", 0.243464816, 449904],
                     ["Monitoring", 278.557176933, 449904], ["After batch 923", 0.248538928, 449904],
                     ["After batch 924", 0.250451262, 449904], ["After batch 925", 0.252203472, 449904],
                     ["Monitoring", 279.576855276, 449904], ["After batch 926", 0.247518699, 449904],
                     ["After batch 927", 0.24680239, 449908], ["After batch 928", 0.244094458, 449908],
                     ["After batch 929", 0.240501263, 449908], ["Monitoring", 280.593604815, 449908],
                     ["After batch 930", 0.240600019, 449916], ["After batch 931", 0.23572164, 449916],
                     ["After batch 932", 0.245772317, 449916], ["Monitoring", 281.612764698, 449916],
                     ["After batch 933", 0.246606347, 449916], ["After batch 934", 0.241770363, 449916],
                     ["After batch 935", 0.23851566, 449924], ["After batch 936", 0.23377022, 449924],
                     ["Monitoring", 282.632750267, 449924], ["After batch 937", 0.247409574, 449932],
                     ["After batch 938", 0.242113587, 449932], ["After batch 939", 0.24795466, 449932],
                     ["Monitoring", 283.648890746, 449932], ["After batch 940", 0.245398976, 449932],
                     ["After batch 941", 0.245056769, 449932], ["After batch 942", 0.242649937, 449932],
                     ["Monitoring", 284.664233485, 449932], ["After batch 943", 0.243919152, 449932],
                     ["After batch 944", 0.240047542, 449932], ["After batch 945", 0.243715478, 449932],
                     ["After batch 946", 0.243827545, 449932], ["Monitoring", 285.679976787, 449932],
                     ["After batch 947", 0.244833846, 449932], ["After batch 948", 0.242468895, 449936],
                     ["After batch 949", 0.246260555, 449936], ["Monitoring", 286.698586206, 449936],
                     ["After batch 950", 0.24260438, 449936], ["After batch 951", 0.239614112, 449936],
                     ["After batch 952", 0.246395393, 449936], ["After batch 953", 0.2380755, 449936],
                     ["Monitoring", 287.713328159, 449936], ["After batch 954", 0.24497535, 449936],
                     ["After batch 955", 0.238391681, 449936], ["After batch 956", 0.246389117, 449936],
                     ["Monitoring", 288.732404004, 449936], ["After batch 957", 0.240314007, 449936],
                     ["After batch 958", 0.245358456, 449948], ["After batch 959", 0.254486533, 449992],
                     ["After batch 960", 0.245154308, 449992], ["Monitoring", 289.750956125, 450004],
                     ["After batch 961", 0.23767312, 450012], ["After batch 962", 0.246672134, 450024],
                     ["After batch 963", 0.244644132, 450028], ["Monitoring", 290.771430963, 450028],
                     ["After batch 964", 0.24826897, 450028], ["After batch 965", 0.243976331, 450032],
                     ["After batch 966", 0.243425959, 450032], ["Monitoring", 291.791001769, 450032],
                     ["After batch 967", 0.233638313, 450032], ["After batch 968", 0.246305339, 450040],
                     ["After batch 969", 0.240235311, 450040], ["After batch 970", 0.245371346, 450040],
                     ["Monitoring", 292.810019208, 450040], ["After batch 971", 0.249563529, 450040],
                     ["After batch 972", 0.24373471, 450040], ["After batch 973", 0.249396191, 450048],
                     ["Monitoring", 293.829773913, 450048], ["After batch 974", 0.250932477, 450048],
                     ["After batch 975", 0.244195116, 450048], ["After batch 976", 0.247777484, 450048],
                     ["After batch 977", 0.23952106, 450048], ["Monitoring", 294.842646465, 450048],
                     ["After batch 978", 0.244258812, 450048], ["After batch 979", 0.25052499, 450048],
                     ["After batch 980", 0.251494842, 450048], ["Monitoring", 295.861483095, 450048],
                     ["After batch 981", 0.244480812, 450048], ["After batch 982", 0.243850201, 450048],
                     ["After batch 983", 0.249739395, 450048], ["Monitoring", 296.879215151, 450048],
                     ["After batch 984", 0.243039918, 450048], ["After batch 985", 0.250764304, 450048],
                     ["After batch 986", 0.242264733, 450048], ["After batch 987", 0.247939455, 450048],
                     ["Monitoring", 297.898399015, 450048], ["After batch 988", 0.241192024, 450048],
                     ["After batch 989", 0.241886782, 450048], ["After batch 990", 0.246904198, 450048],
                     ["Monitoring", 298.91239729, 450048], ["After batch 991", 0.251026314, 450048],
                     ["After batch 992", 0.241684385, 450048], ["After batch 993", 0.246503989, 450048],
                     ["After batch 994", 0.235019248, 450048], ["Monitoring", 299.930548541, 450048],
                     ["After batch 995", 0.250632391, 450048], ["After batch 996", 0.242327678, 450048],
                     ["After batch 997", 0.248019595, 450048], ["Monitoring", 300.943785509, 450048],
                     ["After batch 998", 0.239342359, 450048], ["After batch 999", 0.242451961, 450048]],
}


# Helper function for formatting the y-axis
def mb_formatter(x, pos):
    return '{:.1f} MB'.format(x)


# Set up the plot
fig, ax = plt.subplots(figsize=(10, 6))

# Define colors for different lines
colors = ['blue', 'green', 'red', 'purple']
# Define line styles for different lines
line_styles = ['-', '--', '-.', ':']

# Plot each configuration
for (label, data), color, line_style in zip(memory_log.items(), colors, line_styles):
    # Convert memory usage to MB
    timestamps = [x[1] for x in data]
    memory_usage = [x[2] / 1024 for x in data]  # Convert KB to MB

    # Plot monitoring points
    monitoring_timestamps = [x[1] for x in data if x[0] == "Monitoring"]
    monitoring_memory_usage = [x[2] / 1024 for x in data if x[0] == "Monitoring"]
    ax.plot(monitoring_timestamps, monitoring_memory_usage, label=label, color=color, linestyle=line_style, marker='o',
            linewidth=2)

    # Plot "After batch" points
    batch_timestamps = [x[1] for x in data if x[0].startswith("After batch")]
    batch_memory_usage = [x[2] / 1024 for x in data if x[0].startswith("After batch")]
    ax.scatter(batch_timestamps, batch_memory_usage, color=color, s=100, edgecolors='black', zorder=5)

# Formatting the y-axis
ax.yaxis.set_major_formatter(FuncFormatter(mb_formatter))

# Adding labels and title
ax.set_xlabel('Time (s)', fontsize=14)
ax.set_ylabel('Memory Usage (MB)', fontsize=14)
ax.set_title('Memory Usage Over Time', fontsize=16)
ax.grid(True, linestyle='--', linewidth=0.5)

# Show legend
ax.legend()

# Display the plot
plt.tight_layout()
# plt.show()

# Save the plot
print(f"saving to ./internal/ml/model_slicing/exp_imgs/micro_memory.pdf")
fig.savefig(f"./internal/ml/model_slicing/exp_imgs/micro_memory.pdf", bbox_inches='tight')
