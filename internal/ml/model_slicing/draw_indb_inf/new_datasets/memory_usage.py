import matplotlib.pyplot as plt
from matplotlib.ticker import FuncFormatter

# Sample data, replace this with your actual data
# memory_log = {
#     "with all opt": [[0.012600245, 18748], [1.043574622, 181904], [2.880909715, 439356], [4.746978433, 450032],
#                      [6.580087388, 454812], [8.395959081, 461368], [10.229162885, 466332], [12.037321584, 470420],
#                      [13.867830914, 479540], [15.682375319, 481492], [17.114590375, 489424], [18.88665319, 487128],
#                      [20.715824796, 493432], [22.523327161, 498308], [24.340567323, 510192], [26.164078111, 509144],
#                      [27.992991493, 510196], [29.810057809, 516004], [31.624005968, 529172], [33.433013773, 531936],
#                      [35.25928479, 532344], [37.092092925, 538364], [38.102963907, 548744],
#                      [39.924327023000004, 545516], [41.729301603, 550884], [43.540291392, 557808],
#                      [45.347360579, 561724], [47.169496446, 556168], [49.011585526, 581232], [50.823214165, 574888],
#                      [52.64347461, 573316], [54.447590065, 571784], [56.276114357, 578064], [57.283435147, 570924],
#                      [59.12331606, 576356], [60.942781559, 577336], [62.764237568, 581372], [64.595277978, 575348],
#                      [66.403776621, 574876], [68.20959977, 578288], [70.019599508, 574892], [71.859492037, 567136],
#                      [73.663600443, 567480], [75.487515269, 576564], [77.133634976, 567664], [78.954270747, 578108],
#                      [80.79577953, 577728], [82.635105627, 575796], [84.447651732, 571864], [86.268515464, 578308],
#                      [88.083857798, 575500], [89.922615099, 567136], [91.729333261, 574744]],
#     "skip slice_model()": [[0.042694868, 18528], [1.054480046, 180976], [2.869932923, 303848], [4.683334884, 309164],
#                            [6.496423195, 317100], [8.303804408, 338020], [9.512667188, 339280], [11.334003168, 351248],
#                            [13.149602165, 359480], [14.967301195, 371392], [16.775008038, 375576],
#                            [18.609840614, 395792], [20.425202473, 403904], [22.232969018, 412080],
#                            [24.03805168, 416152], [25.84236809, 431664], [27.717021297, 428512], [29.498214122, 426732],
#                            [31.249602243, 438464], [33.063644976, 427312], [34.870353464, 428468],
#                            [36.673594206, 423136], [38.497763786, 429512], [40.30969706, 428276],
#                            [42.119186815, 422584], [43.96071582, 428696]],
#     "skip py_call()": [[0.037487731, 18596], [1.049279797, 183072], [2.874304285, 307504], [4.691098214, 310540],
#                        [6.506874205, 313776], [8.323560725, 317032], [10.141980121, 320264], [11.159410321, 322108],
#                        [12.975202068, 325320], [14.791966966, 328416], [16.605266190000002, 331584],
#                        [18.427664584, 334884], [20.245025925, 338292], [22.058351874, 341388], [23.890465751, 344692],
#                        [25.705545216, 347916], [27.522452603, 351332], [29.333310017, 354484], [30.352157345, 356332],
#                        [32.166749406, 360272], [33.982633515, 363588], [35.798760843, 366808], [37.614703567, 369848],
#                        [39.43130915, 373356], [41.247204044, 376604], [43.061635834, 379644], [44.878014548, 382916],
#                        [46.693206224, 385960], [48.511253715, 389324], [50.304198335, 392496], [52.118861656, 395536],
#                        [53.936806313, 398620], [55.75111513, 401740], [57.565047381, 405112], [59.38717689, 408284],
#                        [61.202498465, 411316], [63.022486377, 414684], [64.836342967, 417852], [66.646825683, 420692],
#                        [68.458628796, 423728], [70.271319163, 426908], [71.286288318, 428624], [73.101626735, 431592],
#                        [74.919554886, 434632], [76.740418829, 437672], [78.558534728, 438784], [80.373493686, 438784],
#                        [82.196832336, 438832], [84.009351503, 438832], [85.830947725, 438832], [87.646467389, 438832],
#                        [89.461031784, 438832], [90.479992122, 438832], [92.294620107, 438832], [94.111099799, 438832],
#                        [95.927230684, 438832], [97.746362444, 438832], [99.563158397, 438832], [101.383019042, 438832],
#                        [103.202695871, 438832], [105.017722804, 438832], [106.834484135, 438832],
#                        [108.647513243, 438832], [110.301242856, 438832], [112.118349192, 438832],
#                        [113.932724093, 438832], [115.74753262, 438832], [117.562538053, 438832],
#                        [119.379353309, 438832], [121.195222711, 438832], [123.010560053, 438832],
#                        [124.827020238, 438832], [126.642775797, 438832], [128.459480247, 438832],
#                        [130.281429911, 438832], [132.097044741, 438860], [133.912049601, 438864],
#                        [135.730862672, 438864], [137.54748466, 438864], [139.367069797, 438864],
#                        [141.180923526, 438864], [142.998003973, 438864], [144.813620774, 438864],
#                        [146.630798922, 438864], [148.451205105, 438864], [150.266960215, 438864],
#                        [151.284242509, 438868], [153.097853193, 438868]],
#     "del tensor input": [[0.054385368, 18624], [1.067849517, 185616], [2.901614011, 438320], [3.917688274, 436544],
#                          [5.736061766, 445896], [7.548737215, 378156], [9.366380075, 457636], [11.24744956, 463812],
#                          [13.052007021, 468808], [14.874246281, 385128], [16.732588026, 479272], [18.561360171, 485716],
#                          [20.398859579, 488532], [22.204423505, 404036], [23.793341643, 496076], [25.612309963, 446308],
#                          [27.444747921, 416448], [29.254008026, 513644], [31.088803812, 428000], [32.902038096, 521348],
#                          [34.717332123, 523908], [36.555603846, 470384], [38.365823787, 535356], [40.175110609, 538456],
#                          [42.027637158, 546492], [43.790587946, 551372], [45.556554618, 545584], [47.376132303, 559660],
#                          [49.202024759, 520548], [51.01185505, 568720], [52.823131681, 575540], [54.631675351, 566048],
#                          [56.442919021, 575484], [58.288686412, 572360], [60.100066386, 570704], [61.922948475, 567112],
#                          [63.734473112, 567968], [64.741727769, 566108], [66.578540643, 576664], [68.40184616, 574012],
#                          [70.227813142, 568888], [72.053873509, 566012], [73.872927372, 567696], [75.732145544, 565956],
#                          [77.55978126, 570304], [79.381456961, 563472], [81.195234408, 568084], [83.033166813, 563724],
#                          [84.041605986, 566292], [85.888401306, 565200], [87.735611201, 575888], [89.545348051, 572496],
#                          [91.380171848, 567764], [93.21085096, 567968], [95.031529793, 569912], [96.852397771, 564044]]
#
#     # "w/o state cache": [],
#     # "w/o memory sharing": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
#     # "w/o all opt": [
#     #     [0.0144259, 20804], [1.030951876, 184876], [2.909390436, 314468], [4.738563242, 315680],
#     #     [6.553871011, 317364], [8.392857958, 319112], [9.408757094, 320844], [11.25468476, 323972],
#     #     [13.08372853, 326176], [14.921665195, 327536], [16.741873756, 329992], [18.577636054, 331960],
#     #     [20.396168183, 334424]
#     # ],
# }


memory_log = {
    "with all opt":
         [["before all batch", 0.125720111, 16108], ["load model done", 2.506328969, 301500],
         ["batch 1 done", 2.701608838, 318108], ["batch 2 done", 2.878247606, 318888],
         ["batch 3 done", 3.011394398, 319992], ["batch 4 done", 3.135351755, 320272],
         ["batch 5 done", 3.264759646, 319120], ["batch 6 done", 3.389011303, 319400],
         ["batch 7 done", 3.556167886, 319636], ["batch 8 done", 3.6835524, 320004],
         ["batch 9 done", 3.821865613, 320620], ["batch 10 done", 3.931002251, 320804],
         ["batch 11 done", 4.045642521, 320828], ["batch 12 done", 4.135768726, 320828],
         ["batch 13 done", 4.249324502, 320576], ["batch 14 done", 4.368329587, 323024],
         ["batch 15 done", 4.551209641, 323068], ["batch 16 done", 4.686247134, 324624],
         ["batch 17 done", 4.915200794, 324624], ["batch 18 done", 5.156871508, 324624],
         ["batch 19 done", 5.495306126, 324704], ["batch 20 done", 5.77989836, 324732],
         ["batch 21 done", 6.001279911, 324732], ["batch 22 done", 6.272534768, 323180],
         ["batch 23 done", 6.563358164, 323180], ["batch 24 done", 6.836378263, 324488],
         ["batch 25 done", 7.137236008, 324512], ["batch 26 done", 7.474680355, 324596],
         ["batch 27 done", 7.761903385, 324680], ["batch 28 done", 8.115338791, 324932],
         ["batch 29 done", 8.353897215, 324924], ["batch 30 done", 8.475313878, 324932],
         ["batch 31 done", 8.599554737, 325168], ["batch 32 done", 8.735251463, 325544],
         ["batch 33 done", 8.900433734, 325916], ["batch 34 done", 9.114714471, 326048],
         ["batch 35 done", 9.236600227, 326048], ["batch 36 done", 9.377655474, 326144],
         ["batch 37 done", 9.506003186000001, 326144], ["batch 38 done", 9.65451603, 326144],
         ["batch 39 done", 9.77686395, 326392], ["batch 40 done", 9.909294893, 326392],
         ["batch 41 done", 10.030069936, 326392], ["batch 42 done", 10.167487569, 326644],
         ["batch 43 done", 10.307639345, 326644], ["batch 44 done", 10.670883308, 326644],
         ["batch 45 done", 10.91962111, 326644], ["batch 46 done", 11.160330011, 326644],
         ["batch 47 done", 11.512619651, 326644], ["batch 48 done", 11.69664988, 326644],
         ["batch 49 done", 11.93769969, 326636], ["batch 50 done", 12.047278661, 326896],
         ["batch 51 done", 12.19812024, 326948], ["batch 52 done", 12.351797504, 327324],
         ["batch 53 done", 12.515785134, 327984], ["batch 54 done", 12.6799857, 328068],
         ["batch 55 done", 12.819923349, 328068], ["batch 56 done", 12.956226929, 328068],
         ["batch 57 done", 13.079708087, 328316], ["batch 58 done", 13.23214635, 328328],
         ["batch 59 done", 13.401584352, 328344], ["batch 60 done", 13.546117849, 328344],
         ["batch 61 done", 13.699269587, 328344], ["batch 62 done", 13.844939273, 328344],
         ["batch 63 done", 13.983150877, 328620], ["batch 64 done", 14.136383922, 328620],
         ["batch 65 done", 14.28301705, 328636], ["batch 66 done", 14.431414155, 328636],
         ["batch 67 done", 14.582819849, 328688], ["batch 68 done", 14.731568578, 328720],
         ["batch 69 done", 14.873925703, 328720], ["batch 70 done", 15.019065963, 328972],
         ["batch 71 done", 15.169924777, 328972], ["batch 72 done", 15.329038636, 327504],
         ["batch 73 done", 15.488254698, 327912], ["batch 74 done", 15.627291846, 328284],
         ["batch 75 done", 15.76934538, 328424], ["batch 76 done", 15.898865891, 328416],
         ["batch 77 done", 16.038422929, 328440], ["batch 78 done", 16.191882973, 328452],
         ["batch 79 done", 16.329625187, 328476], ["batch 80 done", 16.485974874, 328724],
         ["batch 81 done", 16.64480208, 328716], ["batch 82 done", 16.791603619, 328740],
         ["batch 83 done", 16.916142084, 328748], ["batch 84 done", 17.054338022, 332652],
         ["batch 85 done", 17.21632025, 332904], ["batch 86 done", 17.377777705, 332904],
         ["batch 87 done", 17.532593613, 332944], ["batch 88 done", 17.683053077, 333080],
         ["batch 89 done", 17.839812331, 333080], ["batch 90 done", 17.979281929, 333080],
         ["batch 91 done", 18.113277556, 333204], ["batch 92 done", 18.267274254, 333240],
         ["batch 93 done", 18.417115137, 333712], ["batch 94 done", 18.561220168, 334060],
         ["batch 95 done", 18.687611207, 334416], ["batch 96 done", 18.847652533, 334480],
         ["batch 97 done", 18.978608101, 334500], ["batch 98 done", 19.114775662, 334556],
         ["batch 99 done", 19.277689664, 334620], ["batch 100 done", 19.4390783, 334756],
         ["batch 101 done", 19.566965278, 334880], ["batch 102 done", 19.687433119, 334952],
         ["batch 103 done", 19.849573381, 335012], ["batch 104 done", 19.9915044, 335068],
         ["batch 105 done", 20.108595891, 335076], ["batch 106 done", 20.252063839, 335200],
         ["batch 107 done", 20.40166563, 335192], ["batch 108 done", 20.525989015, 335324],
         ["batch 109 done", 20.686646457, 335388], ["batch 110 done", 20.844354568, 335388],
         ["batch 111 done", 20.967710745, 335452], ["batch 112 done", 21.09019552, 335452],
         ["batch 113 done", 21.219822136, 335512], ["batch 114 done", 21.361105692, 335576],
         ["batch 115 done", 21.511582483, 335828], ["batch 116 done", 21.663807813, 335952],
         ["batch 117 done", 21.81161084, 336296], ["batch 118 done", 21.935857296000002, 336796],
         ["batch 119 done", 22.076947922, 337160], ["batch 120 done", 22.228324302, 337192],
         ["batch 121 done", 22.3832175, 337192], ["batch 122 done", 22.513531603, 337192],
         ["batch 123 done", 22.689886339, 337248], ["batch 124 done", 22.848787704, 337256],
         ["batch 125 done", 22.963098597, 337380], ["batch 126 done", 23.092460431, 337380],
         ["batch 127 done", 23.245708197, 337372], ["batch 128 done", 23.403796857, 337860],
         ["batch 129 done", 23.623748973, 338332], ["batch 130 done", 23.750861874, 338440],
         ["batch 131 done", 23.90866856, 338568], ["batch 132 done", 24.058292894, 338632],
         ["batch 133 done", 24.195245111, 339060], ["batch 134 done", 24.348494113, 339072],
         ["batch 135 done", 24.510988913, 339516], ["batch 136 done", 24.682473657, 339516],
         ["batch 137 done", 24.821319628, 339628], ["batch 138 done", 24.952562522, 340004],
         ["batch 139 done", 25.083091401, 340584], ["batch 140 done", 25.230082872, 340972],
         ["batch 141 done", 25.394237609, 341028], ["batch 142 done", 25.549244796, 341088],
         ["batch 143 done", 25.695758569, 341096], ["batch 144 done", 25.861476683, 341316],
         ["batch 145 done", 26.001294253, 341676], ["batch 146 done", 26.133738396, 341708],
         ["batch 147 done", 26.278080534, 341832], ["batch 148 done", 26.439139664, 341852],
         ["batch 149 done", 26.580792831, 341852], ["batch 150 done", 26.73777447, 341852],
         ["batch 151 done", 26.908002324999998, 341976], ["batch 152 done", 27.053111546, 341988],
         ["batch 153 done", 27.195638587, 341988], ["batch 154 done", 27.330713444, 341988],
         ["batch 155 done", 27.463478721, 342116], ["batch 156 done", 27.600544909, 342116],
         ["batch 157 done", 27.744994011, 342240], ["batch 158 done", 27.879222726, 342484],
         ["batch 159 done", 28.010309281, 342872], ["batch 160 done", 28.154271615, 343252],
         ["batch 161 done", 28.286284484, 343396], ["batch 162 done", 28.444004005, 343468],
         ["batch 163 done", 28.578146192, 343540], ["batch 164 done", 28.701514485, 341792],
         ["batch 165 done", 28.834815422, 341792], ["batch 166 done", 28.969672923, 341792],
         ["batch 167 done", 29.09799262, 341792], ["batch 168 done", 29.262065122, 341668],
         ["batch 169 done", 29.415997103, 341980], ["batch 170 done", 29.572751102, 342020],
         ["batch 171 done", 29.717152442, 342028], ["batch 172 done", 29.853457138, 344276],
         ["batch 173 done", 29.973862364, 344300], ["batch 174 done", 30.094636077, 344356],
         ["batch 175 done", 30.212780335, 344480], ["batch 176 done", 30.329906153, 344480],
         ["batch 177 done", 30.466786796, 344668], ["batch 178 done", 30.614808875, 344672],
         ["batch 179 done", 30.741776487, 344976], ["batch 180 done", 30.86926271, 345372],
         ["batch 181 done", 31.006776857, 345732], ["batch 182 done", 31.144517824, 346004],
         ["batch 183 done", 31.281332406, 346004], ["batch 184 done", 31.433284673, 346100],
         ["batch 185 done", 31.59301584, 346236], ["batch 186 done", 31.709541946999998, 346360],
         ["batch 187 done", 31.852148622, 346360], ["batch 188 done", 31.979858488, 346380],
         ["batch 189 done", 32.099639477, 346444], ["batch 190 done", 32.234468888, 346444],
         ["batch 191 done", 32.381256984, 346580], ["batch 192 done", 32.560832752, 346584],
         ["batch 193 done", 32.695036158, 346584], ["batch 194 done", 32.829973437, 346648],
         ["batch 195 done", 32.957833431, 346708], ["batch 196 done", 33.086962286, 346796],
         ["batch 197 done", 33.228590612, 346796], ["batch 198 done", 33.359769582, 346848],
         ["batch 199 done", 33.515530117, 346936], ["batch 200 done", 33.677077576, 347000],
         ["batch 201 done", 33.815309577, 347060], ["batch 202 done", 33.958958976, 347072],
         ["batch 203 done", 34.094357081, 347556], ["batch 204 done", 34.244858932, 347932],
         ["batch 205 done", 34.38423807, 348372], ["batch 206 done", 34.543811047, 348512],
         ["batch 207 done", 34.697546581, 348576], ["batch 208 done", 34.828368138, 348580],
         ["batch 209 done", 34.969137379, 348768], ["batch 210 done", 35.091610514, 349020],
         ["batch 211 done", 35.234418321, 349036], ["batch 212 done", 35.382655796, 349284],
         ["batch 213 done", 35.523423981, 349288], ["batch 214 done", 35.645758285, 349288],
         ["batch 215 done", 35.800286028, 349536], ["batch 216 done", 35.922841795, 349540],
         ["batch 217 done", 36.044612347, 349544], ["batch 218 done", 36.180846156, 349668],
         ["batch 219 done", 36.325306091, 349672], ["batch 220 done", 36.497561604, 349676],
         ["batch 221 done", 36.640547735, 349696], ["batch 222 done", 36.794549491, 349812],
         ["batch 223 done", 36.911215535, 349816], ["batch 224 done", 37.07336745, 350124],
         ["batch 225 done", 37.251520352, 350504], ["batch 226 done", 37.39159126, 351088],
         ["batch 227 done", 37.53015535, 351152], ["batch 228 done", 37.694952447, 351152],
         ["batch 229 done", 37.832149781, 351188], ["batch 230 done", 37.977793813, 351316],
         ["batch 231 done", 38.107092675, 351424], ["batch 232 done", 38.246897226, 351544],
         ["batch 233 done", 38.389776097, 351536], ["batch 234 done", 38.546206577, 351556],
         ["batch 235 done", 38.713871683, 351568], ["batch 236 done", 38.851477265, 351692],
         ["batch 237 done", 38.983806171, 351692], ["batch 238 done", 39.137106843, 351692],
         ["batch 239 done", 39.314229125, 351704], ["batch 240 done", 39.467279516, 351696],
         ["batch 241 done", 39.628990792, 351704], ["batch 242 done", 39.772825144, 351704],
         ["batch 243 done", 39.908795822, 351704], ["batch 244 done", 40.040287621, 351812],
         ["batch 245 done", 40.163799516, 352428], ["batch 246 done", 40.31797741, 352796],
         ["batch 247 done", 40.444034796, 353068], ["batch 248 done", 40.575433191, 353068],
         ["batch 249 done", 40.719979453, 353132], ["batch 250 done", 40.844242411, 353132],
         ["batch 251 done", 40.995001311, 353192], ["batch 252 done", 41.125106971, 353444],
         ["batch 253 done", 41.259962358, 353444], ["batch 254 done", 41.487842708, 351696],
         ["batch 255 done", 41.842101244, 351600], ["batch 256 done", 42.07027743, 351852],
         ["batch 257 done", 42.313440958, 351852], ["batch 258 done", 42.543771023, 351852],
         ["batch 259 done", 42.853204034, 351852], ["batch 260 done", 43.076243728, 351852],
         ["batch 261 done", 43.241080976, 351852], ["batch 262 done", 43.428945687, 352104],
         ["batch 263 done", 43.655643916, 352104], ["batch 264 done", 43.871796095, 352104],
         ["batch 265 done", 44.054471674, 352368], ["batch 266 done", 44.234941294, 352740],
         ["batch 267 done", 44.385149716, 353112], ["batch 268 done", 44.656817797, 353220],
         ["batch 269 done", 44.825570519, 355220], ["batch 270 done", 44.997243076, 355264],
         ["batch 271 done", 45.1705423, 355384], ["batch 272 done", 45.362527819, 355512],
         ["batch 273 done", 45.599359199, 355512], ["batch 274 done", 45.718492955, 355632],
         ["batch 275 done", 45.851169397, 355876], ["batch 276 done", 45.989950867, 355884],
         ["batch 277 done", 46.124112644, 355884], ["batch 278 done", 46.253779496, 355884],
         ["batch 279 done", 46.407568647, 356008], ["batch 280 done", 46.545589459, 356008],
         ["batch 281 done", 46.707752365, 356132], ["batch 282 done", 46.82660414, 356132],
         ["batch 283 done", 46.963265641, 356132], ["batch 284 done", 47.076344491, 356132],
         ["batch 285 done", 47.226524591, 356296], ["batch 286 done", 47.354449052, 356672],
         ["batch 287 done", 47.523536159, 357036], ["batch 288 done", 47.676285474, 357568],
         ["batch 289 done", 47.816764808, 358264], ["batch 290 done", 47.961575172, 358388],
         ["batch 291 done", 48.086276974, 358400], ["batch 292 done", 48.236805191, 358452],
         ["batch 293 done", 48.377077783, 358532], ["batch 294 done", 48.525594571, 358596],
         ["batch 295 done", 48.663631356, 358696], ["batch 296 done", 48.779753757, 358760],
         ["batch 297 done", 48.895485688, 358884], ["batch 298 done", 49.061878758, 359012],
         ["batch 299 done", 49.199732494, 359136], ["batch 300 done", 49.330579328, 359136],
         ["batch 301 done", 49.47093993, 359136], ["batch 302 done", 49.628023061, 359136],
         ["batch 303 done", 49.768779668, 359268], ["batch 304 done", 49.917957208, 359340],
         ["batch 305 done", 50.084814801, 359464], ["batch 306 done", 50.227123141, 359472],
         ["batch 307 done", 50.356801421, 359536], ["batch 308 done", 50.484109906, 359536],
         ["batch 309 done", 50.644334492, 359656], ["batch 310 done", 50.784381392, 360508],
         ["batch 311 done", 50.89935381, 360984], ["batch 312 done", 51.056129474, 361488],
         ["batch 313 done", 51.214833022, 361496], ["batch 314 done", 51.345347632, 361496],
         ["batch 315 done", 51.50091659, 361624], ["batch 316 done", 51.643596372, 361628],
         ["batch 317 done", 51.782343132, 361696], ["batch 318 done", 51.964392553, 361760],
         ["batch 319 done", 52.114813371, 361824], ["batch 320 done", 52.260959296, 361900],
         ["batch 321 done", 52.386350558, 361900], ["batch 322 done", 52.522270382, 361964],
         ["batch 323 done", 52.663927842, 361964], ["batch 324 done", 52.781255163, 362088],
         ["batch 325 done", 52.935798262, 362088], ["batch 326 done", 53.066982831, 362096],
         ["batch 327 done", 53.214754414, 362160], ["batch 328 done", 53.373474653, 362220],
         ["batch 329 done", 53.535199641, 362284], ["batch 330 done", 53.661558552, 360516],
         ["batch 331 done", 53.789029007, 360908], ["batch 332 done", 53.919217493, 361284],
         ["batch 333 done", 54.068509318, 361780], ["batch 334 done", 54.22339882, 363940],
         ["batch 335 done", 54.345837391, 361812], ["batch 336 done", 54.486673833, 364088],
         ["batch 337 done", 54.612548306, 364104], ["batch 338 done", 54.747315685, 364344],
         ["batch 339 done", 54.870923105, 364344], ["batch 340 done", 55.019507115, 364344],
         ["batch 341 done", 55.163244516, 364344], ["batch 342 done", 55.317876644, 364400],
         ["batch 343 done", 55.461126903, 364464], ["batch 344 done", 55.606391813, 364840],
         ["batch 345 done", 55.759698163, 364840], ["batch 346 done", 55.888013726, 364840],
         ["batch 347 done", 56.019256193, 364848], ["batch 348 done", 56.156952769, 365088],
         ["batch 349 done", 56.300142683, 365088], ["batch 350 done", 56.471487099, 365112],
         ["batch 351 done", 56.606564217, 365324], ["batch 352 done", 56.745983513, 365724],
         ["batch 353 done", 56.868975244, 366096], ["batch 354 done", 57.0067498, 366248],
         ["batch 355 done", 57.122501538, 366248], ["batch 356 done", 57.257723809, 366308],
         ["batch 357 done", 57.388426936, 366372], ["batch 358 done", 57.517839625, 366496],
         ["batch 359 done", 57.654798626, 366496], ["batch 360 done", 57.78480427, 366496],
         ["batch 361 done", 57.909827476, 366560], ["batch 362 done", 58.070980622, 366748],
         ["batch 363 done", 58.20402613, 366760], ["batch 364 done", 58.344698943, 366760],
         ["batch 365 done", 58.499644578, 366752], ["batch 366 done", 58.643399919, 366824],
         ["batch 367 done", 58.802855785, 366908], ["batch 368 done", 58.949802049, 366916],
         ["batch 369 done", 59.065459025, 367040], ["batch 370 done", 59.198059598, 367168],
         ["batch 371 done", 59.325538824, 367168], ["batch 372 done", 59.481422106, 367580],
         ["batch 373 done", 59.632455057, 367952], ["batch 374 done", 59.773623489, 368352],
         ["batch 375 done", 59.929897226, 368500], ["batch 376 done", 60.074172935, 368504],
         ["batch 377 done", 60.216031648, 368628], ["batch 378 done", 60.357818834, 368824],
         ["batch 379 done", 60.503861838, 368908], ["batch 380 done", 60.629784926, 368968],
         ["batch 381 done", 60.759101112, 369032], ["batch 382 done", 60.90483001, 369156],
         ["batch 383 done", 61.040859134, 369156], ["batch 384 done", 61.156873096, 369256],
         ["batch 385 done", 61.309593171, 369256], ["batch 386 done", 61.447061903, 369256],
         ["batch 387 done", 61.582574828, 369316], ["batch 388 done", 61.711492862, 369344],
         ["batch 389 done", 61.874453139, 369468], ["batch 390 done", 62.020515171, 369784],
         ["batch 391 done", 62.152285999, 369788], ["batch 392 done", 62.287452581, 369788],
         ["batch 393 done", 62.438044014, 369780], ["batch 394 done", 62.577503648, 369912],
         ["batch 395 done", 62.719963563, 370168], ["batch 396 done", 62.868564392, 370516],
         ["batch 397 done", 62.991306842, 370924], ["batch 398 done", 63.14173211, 371296],
         ["batch 399 done", 63.275451616, 371544], ["batch 400 done", 63.417486142, 371544],
         ["batch 401 done", 63.550202257, 371544], ["batch 402 done", 63.724029531, 371664],
         ["batch 403 done", 63.878950645, 371672], ["batch 404 done", 64.000220162, 371796],
         ["batch 405 done", 64.14134448, 371796], ["batch 406 done", 64.286647493, 371796],
         ["batch 407 done", 64.414364753, 371796], ["batch 408 done", 64.569157943, 371920],
         ["batch 409 done", 64.718743247, 371920], ["batch 410 done", 64.870799422, 371920],
         ["batch 411 done", 65.003941522, 371920], ["batch 412 done", 65.138081471, 371912],
         ["batch 413 done", 65.27964199, 371964], ["batch 414 done", 65.436479247, 371956],
         ["batch 415 done", 65.595247044, 372028], ["batch 416 done", 65.75306678, 372028],
         ["batch 417 done", 65.902843808, 372424], ["batch 418 done", 66.036229715, 372820],
         ["batch 419 done", 66.184097848, 373256], ["batch 420 done", 66.328501559, 373432],
         ["batch 421 done", 66.501882402, 373564], ["batch 422 done", 66.660214078, 373688],
         ["batch 423 done", 66.811085144, 373836], ["batch 424 done", 66.98232558, 373864],
         ["batch 425 done", 67.143987644, 373988], ["batch 426 done", 67.296506627, 373988],
         ["batch 427 done", 67.44832411, 373992], ["batch 428 done", 67.584726435, 373996],
         ["batch 429 done", 67.724148636, 374024], ["batch 430 done", 67.869569442, 374088],
         ["batch 431 done", 68.006006185, 374352], ["batch 432 done", 68.136128644, 374356],
         ["batch 433 done", 68.302453895, 374360], ["batch 434 done", 68.458512258, 374360],
         ["batch 435 done", 68.591951712, 374392], ["batch 436 done", 68.740113509, 374424],
         ["batch 437 done", 68.861922182, 375000], ["batch 438 done", 68.989931906, 375372],
         ["batch 439 done", 69.118955309, 375748], ["batch 440 done", 69.247114469, 376084],
         ["batch 441 done", 69.370308741, 376084], ["batch 442 done", 69.513476903, 376084],
         ["batch 443 done", 69.656218465, 376088], ["batch 444 done", 69.790695021, 376088],
         ["batch 445 done", 69.933900769, 376088], ["batch 446 done", 70.079475034, 376088],
         ["batch 447 done", 70.21522621, 376152], ["batch 448 done", 70.359323385, 376212],
         ["batch 449 done", 70.502250071, 376324], ["batch 450 done", 70.648383059, 376676],
         ["batch 451 done", 70.787915047, 376828], ["batch 452 done", 70.938306378, 376984],
         ["batch 453 done", 71.068458533, 377268], ["batch 454 done", 71.229819911, 377260],
         ["batch 455 done", 71.356880765, 377288], ["batch 456 done", 71.516506768, 377288],
         ["batch 457 done", 71.656582388, 377288], ["batch 458 done", 71.816506154, 377308],
         ["batch 459 done", 71.963101066, 377692], ["batch 460 done", 72.081672016, 378056],
         ["batch 461 done", 72.22275307, 378488], ["batch 462 done", 72.376550939, 378612],
         ["batch 463 done", 72.531602385, 378612], ["batch 464 done", 72.69537692, 378664],
         ["batch 465 done", 72.825050411, 378812], ["batch 466 done", 72.964950952, 378812],
         ["batch 467 done", 73.098462908, 378900], ["batch 468 done", 73.263052592, 379152],
         ["batch 469 done", 73.394020724, 379180], ["batch 470 done", 73.548905213, 379180],
         ["batch 471 done", 73.693274222, 379184], ["batch 472 done", 73.81088759, 379184],
         ["batch 473 done", 73.960647596, 379184], ["batch 474 done", 74.104830459, 379244],
         ["batch 475 done", 74.262057712, 379368], ["batch 476 done", 74.425189222, 379376],
         ["batch 477 done", 74.545292128, 379444], ["batch 478 done", 74.687580278, 379524],
         ["batch 479 done", 74.818504581, 379632], ["batch 480 done", 74.945976151, 379752],
         ["batch 481 done", 75.069597445, 379780], ["batch 482 done", 75.212679214, 379780],
         ["batch 483 done", 75.357695016, 380160], ["batch 484 done", 75.489952957, 380596],
         ["batch 485 done", 75.647717727, 381112], ["batch 486 done", 75.781566663, 381164],
         ["batch 487 done", 75.92812668, 381164], ["batch 488 done", 76.060835646, 381228],
         ["batch 489 done", 76.199184393, 381292], ["batch 490 done", 76.334194216, 381376],
         ["batch 491 done", 76.495427809, 381440], ["batch 492 done", 76.657947439, 381628],
         ["batch 493 done", 76.783670403, 381620], ["batch 494 done", 76.910913406, 381748],
         ["batch 495 done", 77.076301893, 381872], ["batch 496 done", 77.226271147, 381876],
         ["batch 497 done", 77.366568715, 382004], ["batch 498 done", 77.520607745, 382004],
         ["batch 499 done", 77.669544383, 382004], ["batch 500 done", 77.815836434, 382004],
         ["batch 501 done", 77.926571714, 382004], ["batch 502 done", 78.0690014, 382064],
         ["batch 503 done", 78.212213196, 382136], ["batch 504 done", 78.385445772, 382580],
         ["batch 505 done", 78.525334037, 382956], ["batch 506 done", 78.695550834, 383304],
         ["batch 507 done", 78.84226531, 383368], ["batch 508 done", 79.012882442, 383400],
         ["batch 509 done", 79.147991205, 383524], ["batch 510 done", 79.329304828, 383528],
         ["batch 511 done", 79.495501462, 383656], ["batch 512 done", 79.662522754, 383716],
         ["batch 513 done", 79.803272541, 383844], ["batch 514 done", 79.941292652, 383840],
         ["batch 515 done", 80.096857049, 383916], ["batch 516 done", 80.264320608, 383916],
         ["batch 517 done", 80.403694187, 384040], ["batch 518 done", 80.544150415, 384040],
         ["batch 519 done", 80.699919519, 384040], ["batch 520 done", 80.84420067, 384228],
         ["batch 521 done", 80.972765964, 384228], ["batch 522 done", 81.105822787, 384348],
         ["batch 523 done", 81.234768833, 384348], ["batch 524 done", 81.366051823, 384672],
         ["batch 525 done", 81.510175427, 385044], ["batch 526 done", 81.67013221, 385476],
         ["batch 527 done", 81.844124241, 385708], ["batch 528 done", 81.99129594, 385708],
         ["batch 529 done", 82.152101566, 385768], ["batch 530 done", 82.327901278, 385768],
         ["batch 531 done", 82.488643341, 385768], ["batch 532 done", 82.649269916, 385952],
         ["batch 533 done", 82.783623054, 385992], ["batch 534 done", 82.937459978, 386076],
         ["batch 535 done", 83.098660569, 386136], ["batch 536 done", 83.241136287, 386204],
         ["batch 537 done", 83.379225956, 386696], ["batch 538 done", 83.50211764, 386732],
         ["batch 539 done", 83.64400969, 386736], ["batch 540 done", 83.782895753, 386760],
         ["batch 541 done", 83.927091057, 386764], ["batch 542 done", 84.05899687, 386764],
         ["batch 543 done", 84.203337903, 386756], ["batch 544 done", 84.350593066, 386788],
         ["batch 545 done", 84.490884832, 387196], ["batch 546 done", 84.660373601, 387564],
         ["batch 547 done", 84.789397275, 388052], ["batch 548 done", 84.915489787, 388304],
         ["batch 549 done", 85.074679156, 388304], ["batch 550 done", 85.236061249, 388304],
         ["batch 551 done", 85.395241184, 388304], ["batch 552 done", 85.544155898, 388304],
         ["batch 553 done", 85.682112445, 388552], ["batch 554 done", 85.818110308, 388552],
         ["batch 555 done", 85.966177175, 388552], ["batch 556 done", 86.121481617, 388672],
         ["batch 557 done", 86.273038392, 388684], ["batch 558 done", 86.408406286, 388688],
         ["batch 559 done", 86.545235595, 388692], ["batch 560 done", 86.699936568, 388692],
         ["batch 561 done", 86.824159627, 388796], ["batch 562 done", 86.954090292, 388800],
         ["batch 563 done", 87.079279704, 388796], ["batch 564 done", 87.240821222, 388812],
         ["batch 565 done", 87.395648975, 388996], ["batch 566 done", 87.534876499, 389248],
         ["batch 567 done", 87.662468318, 389252], ["batch 568 done", 87.792976172, 389256],
         ["batch 569 done", 87.910069199, 389580], ["batch 570 done", 88.038377964, 389960],
         ["batch 571 done", 88.178679402, 390572], ["batch 572 done", 88.308976698, 390628],
         ["batch 573 done", 88.434920257, 390628], ["batch 574 done", 88.57063264, 390632],
         ["batch 575 done", 88.702873525, 390636], ["batch 576 done", 88.830269568, 390636],
         ["batch 577 done", 88.946666659, 391316], ["batch 578 done", 89.078408626, 391864],
         ["batch 579 done", 89.220924351, 391924], ["batch 580 done", 89.365486941, 392048],
         ["batch 581 done", 89.530283247, 392052], ["batch 582 done", 89.765682445, 392056],
         ["batch 583 done", 89.914845569, 392056], ["batch 584 done", 90.064314129, 392204],
         ["batch 585 done", 90.174057643, 392204], ["batch 586 done", 90.30809893, 392204],
         ["batch 587 done", 90.453695575, 392444], ["batch 588 done", 90.587710876, 392484],
         ["batch 589 done", 90.713135819, 392548], ["batch 590 done", 90.860644542, 392944],
         ["batch 591 done", 90.997929226, 393336], ["batch 592 done", 91.114447547, 393704],
         ["batch 593 done", 91.301574502, 393880], ["batch 594 done", 91.466407856, 393948],
         ["batch 595 done", 91.623461181, 393972], ["batch 596 done", 91.744440798, 394028],
         ["batch 597 done", 91.875301367, 394460], ["batch 598 done", 92.017024495, 394480],
         ["batch 599 done", 92.153934814, 394588], ["batch 600 done", 92.313033476, 394588],
         ["batch 601 done", 92.450509307, 394580], ["batch 602 done", 92.594948455, 394592],
         ["batch 603 done", 92.734319468, 394708], ["batch 604 done", 92.869551472, 394968],
         ["batch 605 done", 93.013252466, 394976], ["batch 606 done", 93.154139946, 394976],
         ["batch 607 done", 93.298146931, 394988], ["batch 608 done", 93.451760143, 394988],
         ["batch 609 done", 93.587241206, 394988], ["batch 610 done", 93.713253347, 395140],
         ["batch 611 done", 93.856806496, 395516], ["batch 612 done", 93.9962887, 395892],
         ["batch 613 done", 94.125271683, 396120], ["batch 614 done", 94.257558293, 396180],
         ["batch 615 done", 94.399017288, 396340], ["batch 616 done", 94.559597753, 396396],
         ["batch 617 done", 94.70280926, 396428], ["batch 618 done", 94.853710344, 396492],
         ["batch 619 done", 94.985094137, 396552], ["batch 620 done", 95.105862234, 396612],
         ["batch 621 done", 95.276906328, 396676], ["batch 622 done", 95.436042131, 396740],
         ["batch 623 done", 95.596406316, 396824], ["batch 624 done", 95.739611017, 396892],
         ["batch 625 done", 95.868452928, 396952], ["batch 626 done", 96.009148257, 396976],
         ["batch 627 done", 96.126076183, 396980], ["batch 628 done", 96.29951488, 397040],
         ["batch 629 done", 96.433823678, 397100], ["batch 630 done", 96.591290223, 397164],
         ["batch 631 done", 96.731006463, 397484], ["batch 632 done", 96.853281905, 397932],
         ["batch 633 done", 96.992119103, 398432], ["batch 634 done", 97.108391342, 398544],
         ["batch 635 done", 97.274177302, 398604], ["batch 636 done", 97.426868817, 398616],
         ["batch 637 done", 97.571576148, 398680], ["batch 638 done", 97.715586709, 398744],
         ["batch 639 done", 97.855233369, 398876], ["batch 640 done", 98.008346802, 398944],
         ["batch 641 done", 98.140577797, 399036], ["batch 642 done", 98.274513237, 399096],
         ["batch 643 done", 98.396474932, 399160], ["batch 644 done", 98.540499439, 399164],
         ["batch 645 done", 98.679840615, 399232], ["batch 646 done", 98.797914851, 399296],
         ["batch 647 done", 98.951703461, 399420], ["batch 648 done", 99.081759124, 399468],
         ["batch 649 done", 99.252307054, 399500], ["batch 650 done", 99.370648902, 399560],
         ["batch 651 done", 99.525459134, 399604], ["batch 652 done", 99.652753338, 399692],
         ["batch 653 done", 99.761800107, 399752], ["batch 654 done", 99.902180814, 399812],
         ["batch 655 done", 100.023596403, 399904], ["batch 656 done", 100.150612068, 400352],
         ["batch 657 done", 100.288644436, 400784], ["batch 658 done", 100.420305859, 401148],
         ["batch 659 done", 100.543809002, 401212], ["batch 660 done", 100.684484308, 401272],
         ["batch 661 done", 100.816662998, 401328], ["batch 662 done", 100.951135868, 401332],
         ["batch 663 done", 101.075556683, 401392], ["batch 664 done", 101.205231186, 401452],
         ["batch 665 done", 101.357018298, 401508], ["batch 666 done", 101.500662051, 401568],
         ["batch 667 done", 101.648393152, 401572], ["batch 668 done", 101.786401537, 401628],
         ["batch 669 done", 101.943960453, 401696], ["batch 670 done", 102.078695526, 401756],
         ["batch 671 done", 102.283136445, 401816], ["batch 672 done", 102.423332425, 401876],
         ["batch 673 done", 102.607393919, 402004], ["batch 674 done", 102.73336568, 402132],
         ["batch 675 done", 102.87303117, 402136], ["batch 676 done", 103.027183954, 402392],
         ["batch 677 done", 103.163578793, 402812], ["batch 678 done", 103.301067189, 403240],
         ["batch 679 done", 103.439979786, 403436], ["batch 680 done", 103.571776324, 403496],
         ["batch 681 done", 103.699328316, 403496], ["batch 682 done", 103.817329924, 403560],
         ["batch 683 done", 103.974064131, 403560], ["batch 684 done", 104.108953637, 403752],
         ["batch 685 done", 104.287643354, 403752], ["batch 686 done", 104.456669845, 403752],
         ["batch 687 done", 104.625169757, 403752], ["batch 688 done", 104.765942062, 404056],
         ["batch 689 done", 104.904334388, 404152], ["batch 690 done", 105.025761745, 404260],
         ["batch 691 done", 105.139680995, 404360], ["batch 692 done", 105.280783123, 404360],
         ["batch 693 done", 105.460096527, 404424], ["batch 694 done", 105.630027695, 404488],
         ["batch 695 done", 105.786837237, 404504], ["batch 696 done", 105.914050504, 404584],
         ["batch 697 done", 106.052667203, 404928], ["batch 698 done", 106.209877864, 405424],
         ["batch 699 done", 106.370597064, 405852], ["batch 700 done", 106.509296592, 406004],
         ["batch 701 done", 106.669690462, 406064], ["batch 702 done", 106.80394611, 406056],
         ["batch 703 done", 106.931012576, 406064], ["batch 704 done", 107.044256495, 406204],
         ["batch 705 done", 107.170927972, 406280], ["batch 706 done", 107.325052751, 406280],
         ["batch 707 done", 107.488418412, 406344], ["batch 708 done", 107.644868157, 406408],
         ["batch 709 done", 107.795825233, 406504], ["batch 710 done", 107.919535658, 406636],
         ["batch 711 done", 108.053495888, 406640], ["batch 712 done", 108.184409142, 406652],
         ["batch 713 done", 108.324757466, 406636], ["batch 714 done", 108.494535057, 406768],
         ["batch 715 done", 108.627399318, 406896], ["batch 716 done", 108.774228825, 406784],
         ["batch 717 done", 108.892468601, 406872], ["batch 718 done", 109.021429401, 407372],
         ["batch 719 done", 109.153447112, 407724], ["batch 720 done", 109.294935947, 408148],
         ["batch 721 done", 109.468944448, 408208], ["batch 722 done", 109.620252131, 408336],
         ["batch 723 done", 109.776959732, 408336], ["batch 724 done", 109.90128485, 408400],
         ["batch 725 done", 110.062823769, 408400], ["batch 726 done", 110.241146926, 408460],
         ["batch 727 done", 110.374306921, 408588], ["batch 728 done", 110.558921122, 408588],
         ["batch 729 done", 110.710552832, 408588], ["batch 730 done", 110.871847843, 408712],
         ["batch 731 done", 111.00713697, 408832], ["batch 732 done", 111.153753974, 408896],
         ["batch 733 done", 111.305656649, 408896], ["batch 734 done", 111.474188531, 408896],
         ["batch 735 done", 111.638817206, 408896], ["batch 736 done", 111.79397206, 408960],
         ["batch 737 done", 111.941941173, 409020], ["batch 738 done", 112.075809024, 409076],
         ["batch 739 done", 112.210995911, 407272], ["batch 740 done", 112.36304742, 407272],
         ["batch 741 done", 112.526786768, 407272], ["batch 742 done", 112.702087758, 407604],
         ["batch 743 done", 112.85123556, 410004], ["batch 744 done", 113.03726028, 410436],
         ["batch 745 done", 113.175294391, 410520], ["batch 746 done", 113.317748442, 410584],
         ["batch 747 done", 113.476565129, 410648], ["batch 748 done", 113.623174305, 410656],
         ["batch 749 done", 113.737301017, 410776], ["batch 750 done", 113.886451581, 410776],
         ["batch 751 done", 114.039412166, 410828], ["batch 752 done", 114.197620517, 410892],
         ["batch 753 done", 114.326271173, 410948], ["batch 754 done", 114.472147198, 411064],
         ["batch 755 done", 114.616537424, 411064], ["batch 756 done", 114.772590892, 411448],
         ["batch 757 done", 114.887128917, 411592], ["batch 758 done", 115.019258068, 411728],
         ["batch 759 done", 115.135253014, 411812], ["batch 760 done", 115.279270906, 411900],
         ["batch 761 done", 115.383184336, 411988], ["batch 762 done", 115.525316286, 412028],
         ["batch 763 done", 115.661237683, 412528], ["batch 764 done", 115.791163751, 412904],
         ["batch 765 done", 115.920280781, 413328], ["batch 766 done", 116.074851778, 413472],
         ["batch 767 done", 116.208004902, 413464], ["batch 768 done", 116.358714609, 413532],
         ["batch 769 done", 116.50893916, 413588], ["batch 770 done", 116.647000438, 413652],
         ["batch 771 done", 116.783946438, 413772], ["batch 772 done", 116.913454947, 413772],
         ["batch 773 done", 117.037179288, 413836], ["batch 774 done", 117.173935113, 413836],
         ["batch 775 done", 117.3258044, 413888], ["batch 776 done", 117.495969323, 413960],
         ["batch 777 done", 117.640521358, 413980], ["batch 778 done", 117.772144829, 414144],
         ["batch 779 done", 117.892526501, 414204], ["batch 780 done", 118.034935772, 414300],
         ["batch 781 done", 118.190078707, 414364], ["batch 782 done", 118.331738484, 414372],
         ["batch 783 done", 118.479950996, 414508], ["batch 784 done", 118.632240559, 414936],
         ["batch 785 done", 118.76176476, 415352], ["batch 786 done", 118.898630503, 415736],
         ["batch 787 done", 119.048319245, 415864], ["batch 788 done", 119.176656511, 415876],
         ["batch 789 done", 119.324594645, 415876], ["batch 790 done", 119.449671449, 415932],
         ["batch 791 done", 119.598616441, 415992], ["batch 792 done", 119.728913316, 416056],
         ["batch 793 done", 119.886060374, 416120], ["batch 794 done", 120.051397565, 416120],
         ["batch 795 done", 120.187131638, 416180], ["batch 796 done", 120.357693738, 416276],
         ["batch 797 done", 120.496014392, 416340], ["batch 798 done", 120.636874821, 416400],
         ["batch 799 done", 120.790326616, 416532], ["batch 800 done", 120.941399349, 416716],
         ["batch 801 done", 121.062197371, 416768], ["batch 802 done", 121.200834508, 416772],
         ["batch 803 done", 121.362735202, 416876], ["batch 804 done", 121.514142211, 417048],
         ["batch 805 done", 121.665600457, 417400], ["batch 806 done", 121.812965072, 417964],
         ["batch 807 done", 121.960383659, 418196], ["batch 808 done", 122.087564709, 418196],
         ["batch 809 done", 122.223431301, 418200], ["batch 810 done", 122.389185283, 418260],
         ["batch 811 done", 122.527203177, 418360], ["batch 812 done", 122.672873741, 418420],
         ["batch 813 done", 122.83524966, 418484], ["batch 814 done", 122.966410962, 418548],
         ["batch 815 done", 123.10311805, 418548], ["batch 816 done", 123.224552273, 418672],
         ["batch 817 done", 123.366944634, 418732], ["batch 818 done", 123.497841642, 418800],
         ["batch 819 done", 123.649918605, 418812], ["batch 820 done", 123.79697205, 418888],
         ["batch 821 done", 123.93871970000001, 419016], ["batch 822 done", 124.056399737, 419016],
         ["batch 823 done", 124.184707416, 417260], ["batch 824 done", 124.328414661, 417268],
         ["batch 825 done", 124.464050464, 417268], ["batch 826 done", 124.627063558, 417268],
         ["batch 827 done", 124.783244545, 417268], ["batch 828 done", 124.936823944, 417308],
         ["batch 829 done", 125.077185786, 419756], ["batch 830 done", 125.245075978, 420248],
         ["batch 831 done", 125.398193317, 420736], ["batch 832 done", 125.575455946, 420736],
         ["batch 833 done", 125.716141508, 420808], ["batch 834 done", 125.852039461, 420872],
         ["batch 835 done", 125.979503908, 420952], ["batch 836 done", 126.101713628, 421020],
         ["batch 837 done", 126.241460505, 421112], ["batch 838 done", 126.383744206, 421168],
         ["batch 839 done", 126.516833869, 421176], ["batch 840 done", 126.677363305, 421176],
         ["batch 841 done", 126.808460829, 421236], ["batch 842 done", 126.941435595, 421300],
         ["batch 843 done", 127.083690605, 421356], ["batch 844 done", 127.224900278, 421424],
         ["batch 845 done", 127.354915051, 421424], ["batch 846 done", 127.505945841, 421496],
         ["batch 847 done", 127.652766511, 421556], ["batch 848 done", 127.786470173, 421620],
         ["batch 849 done", 127.916760545, 421808], ["batch 850 done", 128.06154798, 422292],
         ["batch 851 done", 128.196767159, 422728], ["batch 852 done", 128.343892459, 422992],
         ["batch 853 done", 128.475526965, 423052], ["batch 854 done", 128.617163438, 423240],
         ["batch 855 done", 128.757244609, 423240], ["batch 856 done", 128.886153709, 423240],
         ["batch 857 done", 129.026809241, 423244], ["batch 858 done", 129.15792267, 423304],
         ["batch 859 done", 129.293422284, 423364], ["batch 860 done", 129.423768284, 423564],
         ["batch 861 done", 129.547640347, 423596], ["batch 862 done", 129.696191688, 423656],
         ["batch 863 done", 129.852690994, 423740], ["batch 864 done", 129.978900256, 423820],
         ["batch 865 done", 130.108771147, 423948], ["batch 866 done", 130.255296001, 423948],
         ["batch 867 done", 130.401525465, 423948], ["batch 868 done", 130.557995913, 424008],
         ["batch 869 done", 130.735945936, 424076], ["batch 870 done", 130.866093379, 424296],
         ["batch 871 done", 130.988209736, 424660], ["batch 872 done", 131.107697498, 425072],
         ["batch 873 done", 131.228147804, 425432], ["batch 874 done", 131.372495191, 425492],
         ["batch 875 done", 131.517662102, 423812], ["batch 876 done", 131.652142076, 423824],
         ["batch 877 done", 131.784242286, 423816], ["batch 878 done", 131.902212095, 423824],
         ["batch 879 done", 132.043199386, 423824], ["batch 880 done", 132.163324991, 423852],
         ["batch 881 done", 132.322256208, 425856], ["batch 882 done", 132.446569944, 424100],
         ["batch 883 done", 132.600182043, 424100], ["batch 884 done", 132.747792541, 424092],
         ["batch 885 done", 132.87259788, 424100], ["batch 886 done", 133.019125464, 426104],
         ["batch 887 done", 133.140727528, 426176], ["batch 888 done", 133.285727712, 426240],
         ["batch 889 done", 133.422443584, 426304], ["batch 890 done", 133.556378492, 426368],
         ["batch 891 done", 133.731959292, 426676], ["batch 892 done", 133.888828204, 427236],
         ["batch 893 done", 134.01791695, 427628], ["batch 894 done", 134.163372446, 427868],
         ["batch 895 done", 134.338785573, 427920], ["batch 896 done", 134.503166931, 428024],
         ["batch 897 done", 134.648683913, 428152], ["batch 898 done", 134.796538904, 428152],
         ["batch 899 done", 134.942355012, 428152], ["batch 900 done", 135.066701717, 428216],
         ["batch 901 done", 135.17674224, 428280], ["batch 902 done", 135.329834166, 428400],
         ["batch 903 done", 135.473530435, 428416], ["batch 904 done", 135.611173087, 428476],
         ["batch 905 done", 135.754940657, 428540], ["batch 906 done", 135.877188552, 428548],
         ["batch 907 done", 136.010468534, 428672], ["batch 908 done", 136.144748207, 428672],
         ["batch 909 done", 136.290162841, 428680], ["batch 910 done", 136.430614113, 428808],
         ["batch 911 done", 136.563760652, 428808], ["batch 912 done", 136.710581317, 428860],
         ["batch 913 done", 136.84813628, 428872], ["batch 914 done", 137.003849599, 428940],
         ["batch 915 done", 137.117109853, 429236], ["batch 916 done", 137.262137633, 429792],
         ["batch 917 done", 137.410474439, 430272], ["batch 918 done", 137.543497025, 430544],
         ["batch 919 done", 137.681757814, 430624], ["batch 920 done", 137.839233881, 430648],
         ["batch 921 done", 137.993033831, 430708], ["batch 922 done", 138.120407886, 430784],
         ["batch 923 done", 138.267954985, 430848], ["batch 924 done", 138.418690788, 430904],
         ["batch 925 done", 138.562445492, 430976], ["batch 926 done", 138.702906262, 431040],
         ["batch 927 done", 138.824089353, 431040], ["batch 928 done", 138.973554982, 431164],
         ["batch 929 done", 139.110583696, 431188], ["batch 930 done", 139.27195593, 431248],
         ["batch 931 done", 139.396142028, 431496], ["batch 932 done", 139.554134618, 431516],
         ["batch 933 done", 139.681194322, 431576], ["batch 934 done", 139.804624156, 431588],
         ["batch 935 done", 139.941594546, 431676], ["batch 936 done", 140.070397812, 431944],
         ["batch 937 done", 140.208795716, 432576], ["batch 938 done", 140.348633017, 432976],
         ["batch 939 done", 140.497625976, 433092], ["batch 940 done", 140.646921767, 433092],
         ["batch 941 done", 140.803880032, 433092], ["batch 942 done", 140.955378293, 433092],
         ["batch 943 done", 141.112926307, 433152], ["batch 944 done", 141.249898609, 433216],
         ["batch 945 done", 141.40851223, 433276], ["batch 946 done", 141.573186705, 433336],
         ["batch 947 done", 141.730673544, 433340], ["batch 948 done", 141.866399216, 433404],
         ["batch 949 done", 141.985015266, 433456], ["batch 950 done", 142.121941392, 433528],
         ["batch 951 done", 142.251914204, 433708], ["batch 952 done", 142.39989701, 433708],
         ["batch 953 done", 142.531337854, 433768], ["batch 954 done", 142.662789007, 433892],
         ["batch 955 done", 142.816555962, 433892], ["batch 956 done", 142.946854452, 433944],
         ["batch 957 done", 143.076610845, 434292], ["batch 958 done", 143.204497528, 434780],
         ["batch 959 done", 143.358658929, 435148], ["batch 960 done", 143.52949351, 435188],
         ["batch 961 done", 143.679746464, 435252], ["batch 962 done", 143.844267495, 435256],
         ["batch 963 done", 143.994289034, 435332], ["batch 964 done", 144.121198427, 435396],
         ["batch 965 done", 144.263590899, 435460], ["batch 966 done", 144.410616428, 435564],
         ["batch 967 done", 144.562282992, 435668], ["batch 968 done", 144.683984635, 435772],
         ["batch 969 done", 144.834566753, 435856], ["batch 970 done", 144.9688087, 435872],
         ["batch 971 done", 145.103238428, 435940], ["batch 972 done", 145.236480833, 436000],
         ["batch 973 done", 145.361850941, 436084], ["batch 974 done", 145.515359796, 436208],
         ["batch 975 done", 145.663665821, 436212], ["batch 976 done", 145.804980578, 436276],
         ["batch 977 done", 145.931585624, 436368], ["batch 978 done", 146.080004952, 436728],
         ["batch 979 done", 146.237405528, 437232], ["batch 980 done", 146.378018041, 437636],
         ["batch 981 done", 146.500559125, 437636], ["batch 982 done", 146.65256542, 437636],
         ["batch 983 done", 146.805237953, 437692], ["batch 984 done", 146.933866301, 437760],
         ["batch 985 done", 147.065132046, 437880], ["batch 986 done", 147.204194361, 438032],
         ["batch 987 done", 147.328288928, 438128], ["batch 988 done", 147.458292083, 438128],
         ["batch 989 done", 147.609097639, 438260], ["batch 990 done", 147.745432375, 438272],
         ["batch 991 done", 147.873344217, 436968], ["batch 992 done", 148.004700181, 438356],
         ["batch 993 done", 148.136385275, 438480], ["batch 994 done", 148.295060681, 438496],
         ["batch 995 done", 148.437075839, 438564], ["batch 996 done", 148.569268144, 438628],
         ["batch 997 done", 148.724389302, 438752], ["batch 998 done", 148.842329173, 438880],
         ["batch 999 done", 148.995201044, 438880], ["batch 1000 done", 149.119474282, 438880],
         ["all batch done", 149.14502382, 438880]],

}


# Helper function for formatting the y-axis
def mb_formatter(x, pos):
    return '{:.1f} MB'.format(x)


# Set up the plot
fig, ax = plt.subplots(figsize=(10, 6))

# Define colors for different lines
colors = ['blue', 'green', 'red', 'purple']
# Define line styles for different lines
line_styles = ['-', '--', '-.', ':']

# Plot each configuration
for (label, data), color, line_style in zip(memory_log.items(), colors, line_styles):
    # Convert memory usage to MB
    timestamps = [x[1] for x in data]
    memory_usage = [x[2] / 1024 for x in data]  # Convert KB to MB

    # Plot monitoring points
    monitoring_timestamps = [x[1] for x in data]
    monitoring_memory_usage = [x[2] / 1024 for x in data]
    ax.plot(monitoring_timestamps, monitoring_memory_usage, label=label, color=color, linestyle=line_style, marker='o')

    # # Plot "After batch" points
    # batch_timestamps = [x[1] for x in data if x[0].startswith("After batch")]
    # batch_memory_usage = [x[2] / 1024 for x in data if x[0].startswith("After batch")]
    # ax.scatter(batch_timestamps, batch_memory_usage, color=color, s=100, edgecolors='black', zorder=5)

# Formatting the y-axis
ax.yaxis.set_major_formatter(FuncFormatter(mb_formatter))

# Adding labels and title
ax.set_xlabel('Time (s)', fontsize=14)
ax.set_ylabel('Memory Usage (MB)', fontsize=14)
ax.set_title('Memory Usage Over Time', fontsize=16)
ax.grid(True, linestyle='--', linewidth=0.5)

# Show legend
ax.legend()

# Display the plot
plt.tight_layout()
# plt.show()

# Save the plot
print(f"saving to ./internal/ml/model_slicing/exp_imgs/micro_memory.pdf")
fig.savefig(f"./internal/ml/model_slicing/exp_imgs/micro_memory.pdf", bbox_inches='tight')
